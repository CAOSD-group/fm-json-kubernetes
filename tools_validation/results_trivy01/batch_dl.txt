
Report Summary

┌───────────────────────────┬────────────┬───────────────────┐
│          Target           │    Type    │ Misconfigurations │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components34_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_33.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_34.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components35_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components36_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components37_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components38_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components39_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_1.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_15.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_16.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_17.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_19.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_2.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_20.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_22.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_23.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_27.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_28.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_29.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_3.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_30.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_33.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_34.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_36.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_37.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_4.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_5.yaml   │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_6.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_7.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_8.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components3_9.yaml   │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4.yaml     │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components40_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_33.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_34.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components41_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components42_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components43_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_33.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_34.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components44_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_33.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_34.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components45_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_33.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_34.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components46_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components47_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components48_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components49_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_1.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_15.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_16.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_17.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_19.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_2.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_20.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_22.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_23.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_27.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_28.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_29.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_3.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_30.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_33.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_34.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_36.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_37.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_4.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_5.yaml   │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_6.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_7.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_8.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components4_9.yaml   │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5.yaml     │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components50_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components51_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components52_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_11.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_12.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_14.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_15.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_20.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_21.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_22.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_28.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components53_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components54_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_33.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_34.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components55_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_33.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_34.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components56_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components58_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components59_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_1.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_15.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_16.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_17.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_19.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_2.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_20.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_22.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_23.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_27.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_28.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_29.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_3.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_30.yaml  │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_4.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_5.yaml   │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_6.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_7.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_8.yaml   │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components5_9.yaml   │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components6.yaml     │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components60_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_32.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_33.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components61_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components62_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_33.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_34.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components63_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_33.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_34.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components64_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_33.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_34.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_36.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_37.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components65_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components66_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67.yaml    │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_1.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_15.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_16.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_17.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_19.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_2.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_20.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_22.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_23.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_27.yaml │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_28.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_29.yaml │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_3.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_30.yaml │ kubernetes │         4         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_4.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_5.yaml  │ kubernetes │         7         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_6.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_7.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_8.yaml  │ kubernetes │         1         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components67_9.yaml  │ kubernetes │         0         │
├───────────────────────────┼────────────┼───────────────────┤
│ gotk-components68.yaml    │ kubernetes │         0         │
└───────────────────────────┴────────────┴───────────────────┘
Legend:
- '-': Not scanned
- '0': Clean (no security findings detected)


gotk-components34_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components34_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components34_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components34_23.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components34_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components34_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components34_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components34_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components34_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components34_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components34_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components34_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components34_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components34_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components34_30.yaml:13-97
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components34_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components34_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components34_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components34_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components34_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components34_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components34_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components34_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components34_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components34_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components34_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components34_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components34_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components34_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components34_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components34_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components34_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.3.0
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components35_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components35_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components35_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components35_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components35_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components35_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components35_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components35_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components35_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components35_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components35_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components35_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components35_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components35_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components35_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components35_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components35_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components35_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components35_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components35_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components35_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components35_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components35_34.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components35_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components35_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_34.yaml:13-86
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components35_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components35_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components35_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components35_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_37.yaml:13-82
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components35_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components35_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components35_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components35_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components35_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components35_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components35_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components35_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components35_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components35_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components35_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components35_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components35_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components35_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components35_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components35_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components35_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components36_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components36_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components36_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components36_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components36_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_17.yaml:13-106
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components36_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components36_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components36_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components36_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components36_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_20.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components36_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components36_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components36_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components36_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_23.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components36_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components36_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components36_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components36_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components36_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components36_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components36_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_30.yaml:13-97
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components36_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components36_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components36_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components36_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components36_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components36_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components36_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components36_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components36_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components36_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components36_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components36_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components36_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components36_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components36_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components36_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components36_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.5.1
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components37_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components37_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components37_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components37_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components37_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components37_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components37_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components37_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components37_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components37_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components37_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components37_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components37_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components37_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components37_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components37_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components37_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components37_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components37_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components37_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components37_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components37_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components37_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components37_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components37_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components37_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components37_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components37_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components37_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components37_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components37_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components37_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components37_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components37_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components37_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components37_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components37_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components37_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.0.1
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components38_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components38_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components38_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components38_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components38_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components38_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components38_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components38_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components38_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components38_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components38_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components38_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components38_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components38_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components38_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components38_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components38_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components38_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components38_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components38_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components38_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components38_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components38_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components38_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components38_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components38_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components38_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components38_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components38_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components38_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components38_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components38_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components38_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components38_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components38_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components38_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components38_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components38_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components39_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components39_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components39_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components39_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components39_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components39_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components39_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components39_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components39_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components39_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components39_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components39_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components39_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components39_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components39_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components39_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components39_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components39_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components39_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components39_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components39_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components39_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components39_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components39_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components39_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components39_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components39_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components39_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components39_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components39_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components39_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components39_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components39_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components39_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components39_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components39_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components39_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components39_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.0.1
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components3_1.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components3_16.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components3_17.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components3_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components3_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components3_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components3_2.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components3_20.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components3_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components3_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components3_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components3_23.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components3_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components3_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components3_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components3_28.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components3_29.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components3_3.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components3_30.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components3_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components3_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components3_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components3_34.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components3_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components3_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_34.yaml:13-86
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components3_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components3_37.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components3_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components3_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_37.yaml:13-82
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components3_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components3_4.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components3_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components3_5.yaml (kubernetes)
====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components3_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components3_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components3_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components3_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components3_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components3_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components3_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components3_6.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components3_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components3_7.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components3_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components3_8.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components3_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.1.1
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components40_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components40_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components40_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components40_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components40_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components40_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components40_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components40_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components40_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components40_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components40_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components40_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components40_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components40_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components40_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components40_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components40_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components40_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components40_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components40_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components40_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components40_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components40_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components40_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components40_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components40_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components40_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components40_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components40_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components40_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components40_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components40_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components40_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components40_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components40_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components40_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components40_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components40_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.2
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components41_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components41_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components41_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components41_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components41_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_17.yaml:13-106
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components41_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components41_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components41_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components41_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components41_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_20.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components41_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components41_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components41_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components41_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_23.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components41_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components41_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components41_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components41_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components41_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components41_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components41_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_30.yaml:13-97
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components41_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components41_34.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components41_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components41_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_34.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components41_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components41_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components41_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components41_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_37.yaml:13-92
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components41_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components41_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components41_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components41_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components41_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components41_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components41_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components41_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components41_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components41_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components41_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components41_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components41_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components41_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components41_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components41_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components41_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.5.1
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components42_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components42_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components42_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components42_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components42_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_17.yaml:13-106
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components42_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components42_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components42_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components42_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components42_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_20.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components42_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components42_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components42_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components42_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_23.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components42_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components42_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components42_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components42_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components42_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components42_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components42_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_30.yaml:13-97
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components42_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components42_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components42_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components42_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components42_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components42_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components42_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components42_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components42_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components42_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components42_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components42_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components42_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components42_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components42_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components42_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components42_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.5.1
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components43_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components43_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components43_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components43_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components43_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components43_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components43_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components43_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components43_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components43_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components43_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components43_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components43_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components43_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components43_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components43_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components43_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components43_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components43_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components43_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components43_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components43_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components43_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components43_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components43_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components43_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components43_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components43_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components43_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components43_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components43_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components43_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components43_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components43_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components43_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components43_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components43_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components43_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.0.1
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components44_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components44_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components44_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components44_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components44_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_17.yaml:13-106
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components44_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components44_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components44_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components44_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components44_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_20.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components44_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components44_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components44_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components44_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_23.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components44_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components44_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components44_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components44_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components44_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components44_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components44_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_30.yaml:13-97
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components44_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components44_34.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components44_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components44_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_34.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components44_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components44_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components44_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components44_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_37.yaml:13-92
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components44_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components44_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components44_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components44_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components44_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components44_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components44_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components44_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components44_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components44_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components44_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components44_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components44_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components44_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components44_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components44_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components44_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.3.0
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components45_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components45_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components45_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components45_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components45_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_17.yaml:13-106
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components45_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components45_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components45_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components45_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components45_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_20.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components45_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components45_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components45_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components45_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_23.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components45_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components45_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components45_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components45_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components45_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components45_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components45_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_30.yaml:13-97
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components45_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components45_34.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components45_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components45_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_34.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components45_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components45_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components45_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components45_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_37.yaml:13-92
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components45_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components45_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components45_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components45_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components45_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components45_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components45_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components45_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components45_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components45_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components45_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components45_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components45_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components45_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components45_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components45_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components45_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.3.0
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components46_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components46_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components46_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components46_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components46_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_17.yaml:13-106
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components46_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components46_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components46_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components46_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components46_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_20.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components46_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components46_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components46_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components46_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_23.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components46_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components46_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components46_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components46_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components46_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components46_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components46_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_30.yaml:13-97
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components46_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components46_34.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components46_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components46_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_34.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components46_34.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components46_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components46_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components46_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_37.yaml:13-92
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components46_37.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components46_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components46_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components46_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components46_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components46_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components46_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components46_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components46_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components46_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components46_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components46_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components46_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components46_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components46_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components46_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components46_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.3.0
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components47_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components47_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components47_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components47_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components47_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components47_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components47_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components47_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components47_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components47_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components47_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components47_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components47_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components47_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components47_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components47_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components47_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components47_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components47_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components47_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components47_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components47_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components47_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components47_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components47_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components47_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components47_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components47_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components47_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components47_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components47_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components47_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components47_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components47_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components47_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components47_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components47_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components47_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components48_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components48_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components48_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components48_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components48_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components48_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components48_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components48_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components48_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components48_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components48_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components48_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components48_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components48_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components48_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components48_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components48_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components48_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components48_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components48_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components48_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components48_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components48_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components48_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components48_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components48_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components48_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components48_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components48_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components48_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components48_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components48_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components48_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components48_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components48_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components48_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components48_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components48_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.0.1
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components49_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components49_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components49_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components49_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components49_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components49_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components49_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components49_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components49_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components49_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components49_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components49_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components49_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components49_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components49_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components49_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components49_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components49_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components49_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components49_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components49_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components49_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components49_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components49_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components49_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components49_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components49_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components49_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components49_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components49_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components49_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components49_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components49_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components49_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components49_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components49_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components49_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components49_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components4_1.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components4_16.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components4_17.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components4_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components4_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components4_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components4_2.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components4_20.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components4_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components4_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components4_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components4_23.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components4_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components4_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components4_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components4_28.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components4_29.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components4_3.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components4_30.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components4_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components4_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components4_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components4_34.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components4_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components4_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_34.yaml:13-86
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components4_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components4_37.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components4_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components4_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_37.yaml:13-82
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components4_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components4_4.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components4_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components4_5.yaml (kubernetes)
====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components4_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components4_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components4_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components4_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components4_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components4_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components4_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components4_6.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components4_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components4_7.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components4_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components4_8.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components4_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.1.1
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components50_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components50_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components50_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components50_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components50_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components50_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components50_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components50_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components50_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components50_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components50_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components50_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components50_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components50_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components50_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components50_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components50_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components50_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components50_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components50_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components50_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components50_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components50_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components50_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components50_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components50_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components50_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components50_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components50_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components50_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components50_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components50_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components50_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components50_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components50_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components50_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components50_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components50_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components51_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components51_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components51_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components51_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components51_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components51_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components51_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components51_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components51_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components51_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components51_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components51_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components51_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components51_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components51_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components51_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components51_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components51_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components51_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components51_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components51_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components51_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components51_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components51_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components51_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components51_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components51_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components51_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components51_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components51_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components51_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components51_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components51_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components51_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components51_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components51_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components51_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components51_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.0.1
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components52_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components52_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components52_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components52_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components52_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components52_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components52_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components52_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components52_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components52_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components52_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components52_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components52_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components52_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components52_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components52_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components52_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components52_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components52_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components52_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components52_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components52_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components52_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components52_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components52_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components52_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components52_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components52_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components52_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components52_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components52_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components52_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components52_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components52_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components52_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components52_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components52_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components52_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components53_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components53_12.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components53_12.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components53_12.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_12.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components53_12.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components53_15.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components53_15.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components53_15.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_15.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components53_15.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components53_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components53_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_20.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components53_21.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_21.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components53_22.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components53_22.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components53_22.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_22.yaml:13-97
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components53_22.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components53_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components53_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components53_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components53_30.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components53_30.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_30.yaml:13-106
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components53_30.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components53_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components53_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components53_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components53_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components53_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components53_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components53_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components53_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components53_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components53_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components53_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components53_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components53_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components53_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components53_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components53_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.3.0
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components54_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components54_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components54_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components54_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components54_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components54_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components54_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components54_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components54_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components54_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components54_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components54_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components54_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components54_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components54_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components54_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components54_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components54_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components54_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components54_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components54_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components54_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components54_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components54_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components54_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components54_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components54_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components54_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components54_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components54_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components54_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components54_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components54_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components54_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components54_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components54_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components54_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components54_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components55_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components55_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components55_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components55_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components55_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components55_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components55_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components55_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components55_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components55_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components55_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components55_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components55_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components55_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components55_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components55_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components55_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components55_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components55_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components55_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components55_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components55_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components55_34.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components55_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components55_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_34.yaml:13-86
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components55_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components55_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components55_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components55_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_37.yaml:13-82
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components55_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components55_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components55_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components55_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components55_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components55_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components55_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components55_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components55_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components55_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components55_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components55_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components55_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components55_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components55_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components55_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components55_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.0.0-rc.5
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components56_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components56_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components56_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components56_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components56_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components56_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components56_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components56_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components56_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components56_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components56_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components56_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components56_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components56_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components56_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components56_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components56_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components56_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components56_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components56_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components56_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components56_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components56_34.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components56_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components56_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_34.yaml:13-86
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components56_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components56_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components56_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components56_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_37.yaml:13-82
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components56_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components56_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components56_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components56_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components56_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components56_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components56_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components56_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components56_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components56_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components56_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components56_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components56_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components56_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components56_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components56_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components56_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.0.0-rc.5
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components58_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components58_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components58_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components58_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components58_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components58_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components58_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components58_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components58_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components58_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components58_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components58_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components58_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components58_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components58_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components58_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components58_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components58_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components58_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components58_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components58_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components58_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components58_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components58_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components58_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components58_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components58_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components58_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components58_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components58_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components58_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components58_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components58_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components58_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components58_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components58_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components58_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components58_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components59_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components59_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components59_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components59_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components59_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components59_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components59_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components59_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components59_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components59_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components59_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components59_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components59_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components59_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components59_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components59_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components59_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components59_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components59_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components59_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components59_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components59_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components59_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components59_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components59_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components59_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components59_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components59_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components59_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components59_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components59_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components59_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components59_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components59_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components59_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components59_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components59_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components59_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components5_1.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components5_16.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components5_17.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components5_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components5_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components5_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components5_2.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components5_20.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components5_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components5_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components5_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components5_23.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components5_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components5_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components5_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components5_28.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components5_29.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components5_3.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components5_30.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components5_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components5_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components5_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components5_4.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components5_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components5_5.yaml (kubernetes)
====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components5_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components5_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components5_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components5_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components5_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components5_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components5_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components5_6.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components5_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components5_7.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components5_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components5_8.yaml (kubernetes)
====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components5_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.0
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components60_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components60_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components60_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components60_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components60_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components60_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components60_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components60_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components60_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components60_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components60_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components60_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components60_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components60_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components60_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components60_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components60_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components60_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components60_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components60_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components60_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components60_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components60_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components60_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components60_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components60_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components60_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components60_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components60_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components60_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components60_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components60_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components60_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components60_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components60_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components60_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components60_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components60_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components61_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components61_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components61_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components61_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components61_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_17.yaml:13-106
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components61_17.yaml:28-94
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components61_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components61_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components61_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components61_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_20.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components61_20.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components61_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components61_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components61_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_23.yaml:13-93
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components61_23.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components61_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components61_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components61_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components61_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components61_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components61_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_30.yaml:13-97
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components61_30.yaml:26-88
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components61_33.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components61_33.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components61_33.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_33.yaml:13-92
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components61_33.yaml:26-83
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components61_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components61_37.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components61_37.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_37.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components61_37.yaml:26-85
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components61_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components61_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components61_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components61_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components61_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components61_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components61_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components61_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components61_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components61_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components61_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components61_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components61_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components61_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components61_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components61_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.3.0
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components62_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components62_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components62_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components62_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components62_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components62_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components62_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components62_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components62_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components62_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components62_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components62_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components62_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components62_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components62_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components62_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components62_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components62_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components62_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components62_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components62_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components62_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components62_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components62_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components62_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components62_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components62_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components62_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components62_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components62_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components62_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components62_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components62_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components62_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components62_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components62_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components62_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components62_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components63_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components63_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components63_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components63_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components63_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components63_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components63_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components63_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components63_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components63_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components63_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components63_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components63_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components63_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components63_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components63_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components63_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components63_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components63_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components63_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components63_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components63_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components63_34.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components63_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components63_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_34.yaml:13-86
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components63_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components63_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components63_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components63_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_37.yaml:13-82
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components63_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components63_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components63_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components63_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components63_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components63_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components63_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components63_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components63_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components63_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components63_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components63_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components63_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components63_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components63_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components63_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components63_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components64_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components64_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components64_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components64_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components64_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components64_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components64_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components64_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components64_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components64_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components64_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components64_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components64_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components64_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components64_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components64_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components64_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components64_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components64_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components64_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components64_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components64_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components64_34.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components64_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components64_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_34.yaml:13-86
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components64_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components64_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components64_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components64_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_37.yaml:13-82
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components64_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components64_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components64_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components64_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components64_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components64_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components64_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components64_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components64_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components64_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components64_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components64_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components64_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components64_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components64_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components64_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components64_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components65_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components65_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components65_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components65_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components65_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components65_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components65_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components65_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components65_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components65_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components65_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components65_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components65_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components65_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components65_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components65_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components65_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components65_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components65_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components65_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components65_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components65_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components65_34.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components65_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-reflector-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components65_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_34.yaml:13-86
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-reflector-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-reflector-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components65_34.yaml:26-75
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components65_37.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components65_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'image-automation-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components65_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_37.yaml:13-82
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: image-automation-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment image-automation-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components65_37.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components65_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components65_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components65_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components65_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components65_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components65_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components65_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components65_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components65_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components65_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components65_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components65_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components65_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components65_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components65_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components65_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components66_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components66_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components66_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components66_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components66_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components66_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components66_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components66_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components66_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components66_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components66_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components66_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components66_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components66_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components66_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components66_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components66_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components66_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components66_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components66_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components66_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components66_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components66_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components66_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components66_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components66_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components66_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components66_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components66_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components66_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components66_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components66_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components66_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components66_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components66_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components66_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components66_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components66_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────



gotk-components67_1.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_1.yaml:11-19
────────────────────────────────────────
  11 ┌   egress:
  12 │   - {}
  13 │   ingress:
  14 │   - from:
  15 │     - podSelector: {}
  16 │   podSelector: {}
  17 │   policyTypes:
  18 │   - Ingress
  19 └   - Egress
────────────────────────────────────────



gotk-components67_16.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_16.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: source-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components67_17.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components67_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'source-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components67_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_17.yaml:13-96
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: source-controller
  17 │   strategy:
  18 │     type: Recreate
  19 │   template:
  20 │     metadata:
  21 └       annotations:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment source-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components67_17.yaml:28-84
────────────────────────────────────────
  28 ┌       - args:
  29 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  30 │         - --watch-all-namespaces=true
  31 │         - --log-level=info
  32 │         - --log-encoding=json
  33 │         - --enable-leader-election
  34 │         - --storage-path=/data
  35 │         - --storage-adv-addr=source-controller.$(RUNTIME_NAMESPACE).svc.cluster.local.
  36 └         env:
  ..   
────────────────────────────────────────



gotk-components67_2.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_2.yaml:11-19
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │     ports:
  15 │     - port: 8080
  16 │       protocol: TCP
  17 │   podSelector: {}
  18 │   policyTypes:
  19 └   - Ingress
────────────────────────────────────────



gotk-components67_20.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components67_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'kustomize-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components67_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_20.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: kustomize-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment kustomize-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components67_20.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components67_23.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components67_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'helm-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components67_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_23.yaml:13-83
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: helm-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment helm-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components67_23.yaml:26-73
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --events-addr=http://notification-controller.flux-system.svc.cluster.local./
  28 │         - --watch-all-namespaces=true
  29 │         - --log-level=info
  30 │         - --log-encoding=json
  31 │         - --enable-leader-election
  32 │         env:
  33 │         - name: RUNTIME_NAMESPACE
  34 └           valueFrom:
  ..   
────────────────────────────────────────



gotk-components67_28.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_28.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components67_29.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_29.yaml:13-20
────────────────────────────────────────
  13 ┌   ports:
  14 │   - name: http
  15 │     port: 80
  16 │     protocol: TCP
  17 │     targetPort: http-webhook
  18 │   selector:
  19 │     app: notification-controller
  20 └   type: ClusterIP
────────────────────────────────────────



gotk-components67_3.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_3.yaml:11-18
────────────────────────────────────────
  11 ┌   ingress:
  12 │   - from:
  13 │     - namespaceSelector: {}
  14 │   podSelector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   policyTypes:
  18 └   - Ingress
────────────────────────────────────────



gotk-components67_30.yaml (kubernetes)
======================================
Tests: 111 (SUCCESSES: 107, FAILURES: 4)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0020 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 gotk-components67_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'manager' of Deployment 'notification-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 gotk-components67_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────


AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_30.yaml:13-87
────────────────────────────────────────
  13 ┌   replicas: 1
  14 │   selector:
  15 │     matchLabels:
  16 │       app: notification-controller
  17 │   template:
  18 │     metadata:
  19 │       annotations:
  20 │         prometheus.io/port: '8080'
  21 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container manager in deployment notification-controller (namespace: flux-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 gotk-components67_30.yaml:26-78
────────────────────────────────────────
  26 ┌       - args:
  27 │         - --watch-all-namespaces=true
  28 │         - --log-level=info
  29 │         - --log-encoding=json
  30 │         - --enable-leader-election
  31 │         env:
  32 │         - name: RUNTIME_NAMESPACE
  33 │           valueFrom:
  34 └             fieldRef:
  ..   
────────────────────────────────────────



gotk-components67_4.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 0, CRITICAL: 0)

AVD-KSV-0040 (LOW): A resource quota policy with hard memory and CPU limits should be configured per namespace
════════════════════════════════════════
Ensure that a ResourceQuota policy is configured to limit aggregate resource usage within a namespace

See https://avd.aquasec.com/misconfig/ksv040
────────────────────────────────────────
 gotk-components67_4.yaml:12
────────────────────────────────────────
  12 [     pods: '1000'
────────────────────────────────────────



gotk-components67_5.yaml (kubernetes)
=====================================
Tests: 115 (SUCCESSES: 108, FAILURES: 7)
Failures: 7 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 6)

AVD-KSV-0041 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 gotk-components67_5.yaml:40-50
────────────────────────────────────────
  40 ┌ - apiGroups:
  41 │   - ''
  42 │   resources:
  43 │   - namespaces
  44 │   - secrets
  45 │   - configmaps
  46 │   - serviceaccounts
  47 │   verbs:
  48 └   - get
  ..   
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components67_5.yaml:10-15
────────────────────────────────────────
  10 ┌ - apiGroups:
  11 │   - source.toolkit.fluxcd.io
  12 │   resources:
  13 │   - '*'
  14 │   verbs:
  15 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components67_5.yaml:16-21
────────────────────────────────────────
  16 ┌ - apiGroups:
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 │   verbs:
  21 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components67_5.yaml:22-27
────────────────────────────────────────
  22 ┌ - apiGroups:
  23 │   - helm.toolkit.fluxcd.io
  24 │   resources:
  25 │   - '*'
  26 │   verbs:
  27 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components67_5.yaml:28-33
────────────────────────────────────────
  28 ┌ - apiGroups:
  29 │   - notification.toolkit.fluxcd.io
  30 │   resources:
  31 │   - '*'
  32 │   verbs:
  33 └   - '*'
────────────────────────────────────────


AVD-KSV-0046 (CRITICAL): ClusterRole 'crd-controller-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components67_5.yaml:34-39
────────────────────────────────────────
  34 ┌ - apiGroups:
  35 │   - image.toolkit.fluxcd.io
  36 │   resources:
  37 │   - '*'
  38 │   verbs:
  39 └   - '*'
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'crd-controller-flux-system' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 gotk-components67_5.yaml:58-69
────────────────────────────────────────
  58 ┌ - apiGroups:
  59 │   - ''
  60 │   resources:
  61 │   - configmaps
  62 │   verbs:
  63 │   - get
  64 │   - list
  65 │   - watch
  66 └   - create
  ..   
────────────────────────────────────────



gotk-components67_6.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-edit-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components67_6.yaml:12-25
────────────────────────────────────────
  12 ┌ - apiGroups:
  13 │   - notification.toolkit.fluxcd.io
  14 │   - source.toolkit.fluxcd.io
  15 │   - helm.toolkit.fluxcd.io
  16 │   - image.toolkit.fluxcd.io
  17 │   - kustomize.toolkit.fluxcd.io
  18 │   resources:
  19 │   - '*'
  20 └   verbs:
  ..   
────────────────────────────────────────



gotk-components67_7.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 0, CRITICAL: 1)

AVD-KSV-0046 (CRITICAL): ClusterRole 'flux-view-flux-system' shouldn't manage all resources
════════════════════════════════════════
Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.

See https://avd.aquasec.com/misconfig/ksv046
────────────────────────────────────────
 gotk-components67_7.yaml:13-24
────────────────────────────────────────
  13 ┌ - apiGroups:
  14 │   - notification.toolkit.fluxcd.io
  15 │   - source.toolkit.fluxcd.io
  16 │   - helm.toolkit.fluxcd.io
  17 │   - image.toolkit.fluxcd.io
  18 │   - kustomize.toolkit.fluxcd.io
  19 │   resources:
  20 │   - '*'
  21 └   verbs:
  ..   
────────────────────────────────────────



gotk-components67_8.yaml (kubernetes)
=====================================
Tests: 111 (SUCCESSES: 110, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-0111 (MEDIUM): ClusterRoleBinding 'cluster-reconciler-flux-system' should not bind to roles ["cluster-admin", "admin", "edit"]
════════════════════════════════════════
Either cluster-admin or those granted powerful permissions.

See https://avd.aquasec.com/misconfig/ksv111
────────────────────────────────────────
 gotk-components67_8.yaml:4-8
────────────────────────────────────────
   4 ┌   labels:
   5 │     app.kubernetes.io/instance: flux-system
   6 │     app.kubernetes.io/part-of: flux
   7 │     app.kubernetes.io/version: v2.2.3
   8 └   name: cluster-reconciler-flux-system
────────────────────────────────────────


