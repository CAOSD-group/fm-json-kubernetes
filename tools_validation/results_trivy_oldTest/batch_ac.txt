
Report Summary

┌───────────────────────────────────────────────────────────────┬────────────┬───────────────────┐
│                            Target                             │    Type    │ Misconfigurations │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment11.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment12.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment13.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment14.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment15.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment16.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment17.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment18.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment19.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment2.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment20.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment21.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment22.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment23.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment24.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment25.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment26.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment27.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment28.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment29.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment3.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment30.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment31.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment32.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment33.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment34.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment35.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment39.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment4.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment40.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment41.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment42.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment43.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment44.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment45.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment46.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment47.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment48.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment49.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment5.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment50.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment51.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment52.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment53.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment54.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment55.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment56.yaml               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment6.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment7.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment8.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1alpha1.VolumeAttachment9.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment.after_roundtrip.yaml  │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment.after_roundtrip1.yaml │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment.yaml                  │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment1.yaml                 │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment10.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment11.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment12.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment13.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment14.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment15.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment16.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment17.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment18.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment19.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment2.yaml                 │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment20.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment21.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment22.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment23.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment24.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment25.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment26.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment27.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment28.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment29.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment3.yaml                 │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment30.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment31.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment32.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment33.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment34.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment35.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment39.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment4.yaml                 │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment40.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment41.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment42.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment43.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment44.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment45.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment46.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment47.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment48.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment49.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment5.yaml                 │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment50.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment51.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment52.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment53.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment54.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment55.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment56.yaml                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment6.yaml                 │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment7.yaml                 │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment8.yaml                 │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ storage.k8s.io.v1beta1.VolumeAttachment9.yaml                 │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ streetlights-api.yaml                                         │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ sts-mysql.yaml                                                │ kubernetes │        57         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ sts-mysql1.yaml                                               │ kubernetes │        58         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ surrealdb-schema.sealed-secret.yaml                           │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ surrealdb-schema.sealed-secret1.yaml                          │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ sv-config.yaml                                                │ kubernetes │         2         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tasks32_1.yaml                                                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tekton-pipelines-controller-deploy.yaml                       │ kubernetes │         6         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tekton1_39.yaml                                               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tekton2_45.yaml                                               │ kubernetes │         6         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ template-1_6.yaml                                             │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ test-metadata.yaml                                            │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ test-metadata2.yaml                                           │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ test_clusterrole.yaml                                         │ kubernetes │        18         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ test_clusterrole1.yaml                                        │ kubernetes │        18         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ theodolite-benchmark-kstreams.yaml                            │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tls-secret51.yaml                                             │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tls-secret51_1.yaml                                           │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tls-secret51_2.yaml                                           │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tls-secret51_3.yaml                                           │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tls-wildcard-lan-stamx-nl.yaml                                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tls-wildcard-lan-stamx-nl1.yaml                               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tls-wildcard-stamx-nl.yaml                                    │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tls-wildcard-stamx-nl1.yaml                                   │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ today.apiresourceschemas1_2.yaml                              │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ today.apiresourceschemas_2.yaml                               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tour.sealed-secret.helm.yaml                                  │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tour.sealed-secret.helm1.yaml                                 │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ traefik17.yaml                                                │ kubernetes │         9         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ tretboot_1.yaml                                               │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ trigger-jenkins-job.yaml                                      │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ upgrade-example.yaml                                          │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ v0.13.10.metallb-frr1_23.yaml                                 │ kubernetes │        112        │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ v0.13.10.metallb-frr_23.yaml                                  │ kubernetes │        112        │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ v0.13.12.metallb-frr1_23.yaml                                 │ kubernetes │        112        │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ v0.13.12.metallb-frr_23.yaml                                  │ kubernetes │        112        │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ v0.13.4.metallb-frr_24.yaml                                   │ kubernetes │        112        │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ v0.13.7.metallb-frr_22.yaml                                   │ kubernetes │        112        │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ v0.13.9.metallb-frr_22.yaml                                   │ kubernetes │        112        │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ validatingwebhookconfiguration-02.yaml                        │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ vector-config.yaml                                            │ kubernetes │         1         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ vsphere-csi-driver_11.yaml                                    │ kubernetes │        105        │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ waypoint-no-network-label_2.yaml                              │ kubernetes │        11         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ webhook-configuration1.yaml                                   │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ windows-bios-installer-configmaps.yaml                        │ kubernetes │         1         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ windows-bios-installer-pipeline.yaml                          │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ windows-efi-installer-configmaps.yaml                         │ kubernetes │         1         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ windows-efi-installer-configmaps_1.yaml                       │ kubernetes │         1         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ windows-efi-installer-pipeline.yaml                           │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ worker-sts.yaml                                               │ kubernetes │        31         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ write_checks_1.yaml                                           │ kubernetes │         1         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ wso2am-conf.yaml                                              │ kubernetes │         2         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ xld.clusterserviceversion.yaml                                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ xlr.clusterserviceversion.yaml                                │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ xrd1.yaml                                                     │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ your-spotify.yaml                                             │ kubernetes │         0         │
├───────────────────────────────────────────────────────────────┼────────────┼───────────────────┤
│ your-spotify1.yaml                                            │ kubernetes │         0         │
└───────────────────────────────────────────────────────────────┴────────────┴───────────────────┘
Legend:
- '-': Not scanned
- '0': Clean (no security findings detected)


sts-mysql.yaml (kubernetes)
===========================
Tests: 149 (SUCCESSES: 92, FAILURES: 57)
Failures: 57 (UNKNOWN: 0, LOW: 36, MEDIUM: 12, HIGH: 9, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'clone-mysql' of StatefulSet 'mysql' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'init-mysql' of StatefulSet 'mysql' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'mysql' of StatefulSet 'mysql' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'xtrabackup' of StatefulSet 'mysql' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'mysql' of StatefulSet 'mysql' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'xtrabackup' of StatefulSet 'mysql' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'clone-mysql' of 'statefulset' 'mysql' in 'name2' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'init-mysql' of 'statefulset' 'mysql' in 'name2' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'mysql' of 'statefulset' 'mysql' in 'name2' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'xtrabackup' of 'statefulset' 'mysql' in 'name2' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'mysql' of StatefulSet 'mysql' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'xtrabackup' of StatefulSet 'mysql' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'clone-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'init-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'mysql' of StatefulSet 'mysql' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'xtrabackup' of StatefulSet 'mysql' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'clone-mysql' of StatefulSet 'mysql' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'init-mysql' of StatefulSet 'mysql' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'mysql' of StatefulSet 'mysql' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'xtrabackup' of StatefulSet 'mysql' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'mysql' of StatefulSet 'mysql' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'xtrabackup' of StatefulSet 'mysql' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'mysql' of StatefulSet 'mysql' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'xtrabackup' of StatefulSet 'mysql' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'mysql' of StatefulSet 'mysql' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'xtrabackup' of StatefulSet 'mysql' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "clone-mysql" of statefulset "mysql" in "name2" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "init-mysql" of statefulset "mysql" in "name2" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "mysql" of statefulset "mysql" in "name2" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "xtrabackup" of statefulset "mysql" in "name2" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container mysql in name2 namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 sts-mysql.yaml:21-44
────────────────────────────────────────
  21 ┌       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 │           # Generate mysql server-id from pod ordinal index.
  29 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container mysql in name2 namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 sts-mysql.yaml:45-67
────────────────────────────────────────
  45 ┌       - name: clone-mysql
  46 │         image: gcr.io/google-samples/xtrabackup:1.0
  47 │         command:
  48 │         - bash
  49 │         - "-c"
  50 │         - |
  51 │           set -ex
  52 │           # Skip the clone if data already exists.
  53 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container mysql in name2 namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 sts-mysql.yaml:69-98
────────────────────────────────────────
  69 ┌       - name: mysql
  70 │         image: mysql:5.7 # amd64
  71 │         env:
  72 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  73 │           value: "1"
  74 │         ports:
  75 │         - name: mysql
  76 │           containerPort: 3306
  77 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container mysql in name2 namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 sts-mysql.yaml:99-155
────────────────────────────────────────
  99 ┌       - name: xtrabackup
 100 │         image: gcr.io/google-samples/xtrabackup:1.0
 101 │         ports:
 102 │         - name: xtrabackup
 103 │           containerPort: 3307
 104 │         command:
 105 │         - bash
 106 │         - "-c"
 107 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): statefulset mysql in name2 namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 sts-mysql.yaml:20-161
────────────────────────────────────────
  20 ┌       initContainers:
  21 │       - name: init-mysql
  22 │         image: mysql:5.7
  23 │         command:
  24 │         - bash
  25 │         - "-c"
  26 │         - |
  27 │           set -ex
  28 └           # Generate mysql server-id from pod ordinal index.
  ..   
────────────────────────────────────────



sts-mysql1.yaml (kubernetes)
============================
Tests: 149 (SUCCESSES: 91, FAILURES: 58)
Failures: 58 (UNKNOWN: 0, LOW: 37, MEDIUM: 12, HIGH: 9, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'clone-mysql' of StatefulSet 'mysql' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'init-mysql' of StatefulSet 'mysql' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'mysql' of StatefulSet 'mysql' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'xtrabackup' of StatefulSet 'mysql' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'mysql' of StatefulSet 'mysql' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'xtrabackup' of StatefulSet 'mysql' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'clone-mysql' of 'statefulset' 'mysql' in 'default' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'init-mysql' of 'statefulset' 'mysql' in 'default' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'mysql' of 'statefulset' 'mysql' in 'default' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'xtrabackup' of 'statefulset' 'mysql' in 'default' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'mysql' of StatefulSet 'mysql' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'xtrabackup' of StatefulSet 'mysql' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'clone-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'init-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'mysql' of StatefulSet 'mysql' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'xtrabackup' of StatefulSet 'mysql' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'clone-mysql' of StatefulSet 'mysql' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'init-mysql' of StatefulSet 'mysql' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'mysql' of StatefulSet 'mysql' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'xtrabackup' of StatefulSet 'mysql' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'mysql' of StatefulSet 'mysql' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'xtrabackup' of StatefulSet 'mysql' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'mysql' of StatefulSet 'mysql' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'xtrabackup' of StatefulSet 'mysql' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'clone-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'init-mysql' of StatefulSet 'mysql' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'mysql' of StatefulSet 'mysql' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'xtrabackup' of StatefulSet 'mysql' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "clone-mysql" of statefulset "mysql" in "default" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "init-mysql" of statefulset "mysql" in "default" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "mysql" of statefulset "mysql" in "default" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "xtrabackup" of statefulset "mysql" in "default" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0110 (LOW): statefulset mysql in default namespace should set metadata.namespace to a non-default namespace
════════════════════════════════════════
Checks whether a workload is running in the default namespace.

See https://avd.aquasec.com/misconfig/ksv110
────────────────────────────────────────
 sts-mysql1.yaml:4
────────────────────────────────────────
   4 [   name: mysql
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container mysql in default namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 sts-mysql1.yaml:98-154
────────────────────────────────────────
  98 ┌       - name: xtrabackup
  99 │         image: gcr.io/google-samples/xtrabackup:1.0
 100 │         ports:
 101 │         - name: xtrabackup
 102 │           containerPort: 3307
 103 │         command:
 104 │         - bash
 105 │         - "-c"
 106 └         - |
 ...   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container mysql in default namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 sts-mysql1.yaml:19-42
────────────────────────────────────────
  19 ┌       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 │           # Generate mysql server-id from pod ordinal index.
  27 └           [[ $HOSTNAME =~ -([0-9]+)$ ]] || exit 1
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container mysql in default namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 sts-mysql1.yaml:43-65
────────────────────────────────────────
  43 ┌       - name: clone-mysql
  44 │         image: gcr.io/google-samples/xtrabackup:1.0
  45 │         command:
  46 │         - bash
  47 │         - "-c"
  48 │         - |
  49 │           set -ex
  50 │           # Skip the clone if data already exists.
  51 └           [[ -d /var/lib/mysql/mysql ]] && exit 0
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container mysql in default namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 sts-mysql1.yaml:67-97
────────────────────────────────────────
  67 ┌       - name: mysql
  68 │         image: mysql:5.7 # amd64
  69 │         env:
  70 │         - name: MYSQL_ALLOW_EMPTY_PASSWORD
  71 │           value: "1"
  72 │         ports:
  73 │         - name: mysql
  74 │           containerPort: 3306
  75 └         volumeMounts:
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): statefulset mysql in default namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 sts-mysql1.yaml:18-160
────────────────────────────────────────
  18 ┌       initContainers:
  19 │       - name: init-mysql
  20 │         image: mysql:5.7
  21 │         command:
  22 │         - bash
  23 │         - "-c"
  24 │         - |
  25 │           set -ex
  26 └           # Generate mysql server-id from pod ordinal index.
  ..   
────────────────────────────────────────



sv-config.yaml (kubernetes)
===========================
Tests: 107 (SUCCESSES: 105, FAILURES: 2)
Failures: 2 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 1, CRITICAL: 0)

AVD-KSV-01010 (MEDIUM): ConfigMap 'soavirt-config' in 'parasoft-ns' namespace stores sensitive contents in key(s) or value(s) '{"#env.manager.username"}'
════════════════════════════════════════
Storing sensitive content such as usernames and email addresses in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-01010
────────────────────────────────────────


AVD-KSV-0109 (HIGH): ConfigMap 'soavirt-config' in 'parasoft-ns' namespace stores secrets in key(s) or value(s) '{"#dtp.password", "#env.manager.password", "#soatest.license.local.password", "#virtualize.license.local.password", "license.network.password"}'
════════════════════════════════════════
Storing secrets in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-0109
────────────────────────────────────────



tekton-pipelines-controller-deploy.yaml (kubernetes)
====================================================
Tests: 107 (SUCCESSES: 101, FAILURES: 6)
Failures: 6 (UNKNOWN: 0, LOW: 4, MEDIUM: 0, HIGH: 2, CRITICAL: 0)

AVD-KSV-0011 (LOW): Container 'tekton-pipelines-controller' of Deployment 'tekton-pipelines-controller' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 tekton-pipelines-controller-deploy.yaml:53-147
────────────────────────────────────────
  53 ┌       - args:
  54 │         - -kubeconfig-writer-image
  55 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/kubeconfigwriter:v0.42.0@sha256:672df16c97c15d20102749c6e86195683d037bd6c8787560c9c07ade8b610071
  56 │         - -git-image
  57 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/git-init:v0.42.0@sha256:211b0822659b2030a9e12b1cdb47faab2187a63a24ed9d21044520f967674138
  58 │         - -entrypoint-image
  59 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint:v0.42.0@sha256:77e43d0fc9f7e7bdfa31dc16082b08dace05ce81c91a06c00dfa2f547212ce72
  60 │         - -nop-image
  61 └         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/nop:v0.42.0@sha256:bd1fcc45d40a8ef1621789856caa2f54d7a884f19af921105feafae0131648c5
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'tekton-pipelines-controller' of Deployment 'tekton-pipelines-controller' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 tekton-pipelines-controller-deploy.yaml:53-147
────────────────────────────────────────
  53 ┌       - args:
  54 │         - -kubeconfig-writer-image
  55 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/kubeconfigwriter:v0.42.0@sha256:672df16c97c15d20102749c6e86195683d037bd6c8787560c9c07ade8b610071
  56 │         - -git-image
  57 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/git-init:v0.42.0@sha256:211b0822659b2030a9e12b1cdb47faab2187a63a24ed9d21044520f967674138
  58 │         - -entrypoint-image
  59 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint:v0.42.0@sha256:77e43d0fc9f7e7bdfa31dc16082b08dace05ce81c91a06c00dfa2f547212ce72
  60 │         - -nop-image
  61 └         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/nop:v0.42.0@sha256:bd1fcc45d40a8ef1621789856caa2f54d7a884f19af921105feafae0131648c5
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'tekton-pipelines-controller' of Deployment 'tekton-pipelines-controller' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 tekton-pipelines-controller-deploy.yaml:53-147
────────────────────────────────────────
  53 ┌       - args:
  54 │         - -kubeconfig-writer-image
  55 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/kubeconfigwriter:v0.42.0@sha256:672df16c97c15d20102749c6e86195683d037bd6c8787560c9c07ade8b610071
  56 │         - -git-image
  57 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/git-init:v0.42.0@sha256:211b0822659b2030a9e12b1cdb47faab2187a63a24ed9d21044520f967674138
  58 │         - -entrypoint-image
  59 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint:v0.42.0@sha256:77e43d0fc9f7e7bdfa31dc16082b08dace05ce81c91a06c00dfa2f547212ce72
  60 │         - -nop-image
  61 └         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/nop:v0.42.0@sha256:bd1fcc45d40a8ef1621789856caa2f54d7a884f19af921105feafae0131648c5
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'tekton-pipelines-controller' of Deployment 'tekton-pipelines-controller' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 tekton-pipelines-controller-deploy.yaml:53-147
────────────────────────────────────────
  53 ┌       - args:
  54 │         - -kubeconfig-writer-image
  55 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/kubeconfigwriter:v0.42.0@sha256:672df16c97c15d20102749c6e86195683d037bd6c8787560c9c07ade8b610071
  56 │         - -git-image
  57 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/git-init:v0.42.0@sha256:211b0822659b2030a9e12b1cdb47faab2187a63a24ed9d21044520f967674138
  58 │         - -entrypoint-image
  59 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint:v0.42.0@sha256:77e43d0fc9f7e7bdfa31dc16082b08dace05ce81c91a06c00dfa2f547212ce72
  60 │         - -nop-image
  61 └         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/nop:v0.42.0@sha256:bd1fcc45d40a8ef1621789856caa2f54d7a884f19af921105feafae0131648c5
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'tekton-pipelines-controller' of Deployment 'tekton-pipelines-controller' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 tekton-pipelines-controller-deploy.yaml:53-147
────────────────────────────────────────
  53 ┌       - args:
  54 │         - -kubeconfig-writer-image
  55 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/kubeconfigwriter:v0.42.0@sha256:672df16c97c15d20102749c6e86195683d037bd6c8787560c9c07ade8b610071
  56 │         - -git-image
  57 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/git-init:v0.42.0@sha256:211b0822659b2030a9e12b1cdb47faab2187a63a24ed9d21044520f967674138
  58 │         - -entrypoint-image
  59 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint:v0.42.0@sha256:77e43d0fc9f7e7bdfa31dc16082b08dace05ce81c91a06c00dfa2f547212ce72
  60 │         - -nop-image
  61 └         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/nop:v0.42.0@sha256:bd1fcc45d40a8ef1621789856caa2f54d7a884f19af921105feafae0131648c5
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): deployment tekton-pipelines-controller in tekton-pipelines namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 tekton-pipelines-controller-deploy.yaml:43-161
────────────────────────────────────────
  43 ┌       affinity:
  44 │         nodeAffinity:
  45 │           requiredDuringSchedulingIgnoredDuringExecution:
  46 │             nodeSelectorTerms:
  47 │             - matchExpressions:
  48 │               - key: kubernetes.io/os
  49 │                 operator: NotIn
  50 │                 values:
  51 └                 - windows
  ..   
────────────────────────────────────────



tekton2_45.yaml (kubernetes)
============================
Tests: 107 (SUCCESSES: 101, FAILURES: 6)
Failures: 6 (UNKNOWN: 0, LOW: 4, MEDIUM: 0, HIGH: 2, CRITICAL: 0)

AVD-KSV-0011 (LOW): Container 'tekton-pipelines-controller' of Deployment 'tekton-pipelines-controller' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 tekton2_45.yaml:45-135
────────────────────────────────────────
  45 ┌       - name: tekton-pipelines-controller
  46 │         image: gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/controller:v0.45.0@sha256:8a302dab54484bbb83d46ff9455b077ea51c1c189641dcda12575f8301bfb257
  47 │         args:
  48 │         - -git-image
  49 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/git-init:v0.45.0@sha256:8ab0f58d8381b0b71f5b2bae1f63522989d739e3154d8cab1bacfa0ef5317214
  50 │         - -entrypoint-image
  51 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint:v0.45.0@sha256:9e1ed138383b2266a7916cd3a501fb50335da36d4fd72fd0a4de2aac142cf4b4
  52 │         - -nop-image
  53 └         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/nop:v0.45.0@sha256:3314b1f7222c41ab6e191bb4d4e13b519cc1c2f71f66e29ce86d9eaf611808f0
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'tekton-pipelines-controller' of Deployment 'tekton-pipelines-controller' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 tekton2_45.yaml:45-135
────────────────────────────────────────
  45 ┌       - name: tekton-pipelines-controller
  46 │         image: gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/controller:v0.45.0@sha256:8a302dab54484bbb83d46ff9455b077ea51c1c189641dcda12575f8301bfb257
  47 │         args:
  48 │         - -git-image
  49 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/git-init:v0.45.0@sha256:8ab0f58d8381b0b71f5b2bae1f63522989d739e3154d8cab1bacfa0ef5317214
  50 │         - -entrypoint-image
  51 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint:v0.45.0@sha256:9e1ed138383b2266a7916cd3a501fb50335da36d4fd72fd0a4de2aac142cf4b4
  52 │         - -nop-image
  53 └         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/nop:v0.45.0@sha256:3314b1f7222c41ab6e191bb4d4e13b519cc1c2f71f66e29ce86d9eaf611808f0
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'tekton-pipelines-controller' of Deployment 'tekton-pipelines-controller' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 tekton2_45.yaml:45-135
────────────────────────────────────────
  45 ┌       - name: tekton-pipelines-controller
  46 │         image: gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/controller:v0.45.0@sha256:8a302dab54484bbb83d46ff9455b077ea51c1c189641dcda12575f8301bfb257
  47 │         args:
  48 │         - -git-image
  49 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/git-init:v0.45.0@sha256:8ab0f58d8381b0b71f5b2bae1f63522989d739e3154d8cab1bacfa0ef5317214
  50 │         - -entrypoint-image
  51 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint:v0.45.0@sha256:9e1ed138383b2266a7916cd3a501fb50335da36d4fd72fd0a4de2aac142cf4b4
  52 │         - -nop-image
  53 └         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/nop:v0.45.0@sha256:3314b1f7222c41ab6e191bb4d4e13b519cc1c2f71f66e29ce86d9eaf611808f0
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'tekton-pipelines-controller' of Deployment 'tekton-pipelines-controller' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 tekton2_45.yaml:45-135
────────────────────────────────────────
  45 ┌       - name: tekton-pipelines-controller
  46 │         image: gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/controller:v0.45.0@sha256:8a302dab54484bbb83d46ff9455b077ea51c1c189641dcda12575f8301bfb257
  47 │         args:
  48 │         - -git-image
  49 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/git-init:v0.45.0@sha256:8ab0f58d8381b0b71f5b2bae1f63522989d739e3154d8cab1bacfa0ef5317214
  50 │         - -entrypoint-image
  51 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint:v0.45.0@sha256:9e1ed138383b2266a7916cd3a501fb50335da36d4fd72fd0a4de2aac142cf4b4
  52 │         - -nop-image
  53 └         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/nop:v0.45.0@sha256:3314b1f7222c41ab6e191bb4d4e13b519cc1c2f71f66e29ce86d9eaf611808f0
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'tekton-pipelines-controller' of Deployment 'tekton-pipelines-controller' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 tekton2_45.yaml:45-135
────────────────────────────────────────
  45 ┌       - name: tekton-pipelines-controller
  46 │         image: gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/controller:v0.45.0@sha256:8a302dab54484bbb83d46ff9455b077ea51c1c189641dcda12575f8301bfb257
  47 │         args:
  48 │         - -git-image
  49 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/git-init:v0.45.0@sha256:8ab0f58d8381b0b71f5b2bae1f63522989d739e3154d8cab1bacfa0ef5317214
  50 │         - -entrypoint-image
  51 │         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/entrypoint:v0.45.0@sha256:9e1ed138383b2266a7916cd3a501fb50335da36d4fd72fd0a4de2aac142cf4b4
  52 │         - -nop-image
  53 └         - gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/nop:v0.45.0@sha256:3314b1f7222c41ab6e191bb4d4e13b519cc1c2f71f66e29ce86d9eaf611808f0
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): deployment tekton-pipelines-controller in tekton-pipelines namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 tekton2_45.yaml:34-146
────────────────────────────────────────
  34 ┌       affinity:
  35 │         nodeAffinity:
  36 │           requiredDuringSchedulingIgnoredDuringExecution:
  37 │             nodeSelectorTerms:
  38 │             - matchExpressions:
  39 │               - key: kubernetes.io/os
  40 │                 operator: NotIn
  41 │                 values:
  42 └                 - windows
  ..   
────────────────────────────────────────



test_clusterrole.yaml (kubernetes)
==================================
Tests: 119 (SUCCESSES: 101, FAILURES: 18)
Failures: 18 (UNKNOWN: 0, LOW: 0, MEDIUM: 6, HIGH: 9, CRITICAL: 3)

AVD-KSV-0041 (CRITICAL): ClusterRole 'admin' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 test_clusterrole.yaml:119-136
────────────────────────────────────────
 119 ┌   - apiGroups:
 120 │       - ""
 121 │     resources:
 122 │       - configmaps
 123 │       - endpoints
 124 │       - persistentvolumeclaims
 125 │       - replicationcontrollers
 126 │       - replicationcontrollers/scale
 127 └       - secrets
 ...   
────────────────────────────────────────


AVD-KSV-0041 (CRITICAL): ClusterRole 'admin' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 test_clusterrole.yaml:86-98
────────────────────────────────────────
  86 ┌   - apiGroups:
  87 │       - ""
  88 │     resources:
  89 │       - pods/attach
  90 │       - pods/exec
  91 │       - pods/portforward
  92 │       - pods/proxy
  93 │       - secrets
  94 └       - services/proxy
  ..   
────────────────────────────────────────


AVD-KSV-0048 (MEDIUM): ClusterRole 'admin' should not have access to resources ["pods", "deployments", "jobs", "cronjobs", "statefulsets", "daemonsets", "replicasets", "replicationcontrollers"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv048
────────────────────────────────────────
 test_clusterrole.yaml:175-192
────────────────────────────────────────
 175 ┌   - apiGroups:
 176 │       - extensions
 177 │     resources:
 178 │       - daemonsets
 179 │       - deployments
 180 │       - deployments/rollback
 181 │       - deployments/scale
 182 │       - ingresses
 183 └       - networkpolicies
 ...   
────────────────────────────────────────


AVD-KSV-0048 (MEDIUM): ClusterRole 'admin' should not have access to resources ["pods", "deployments", "jobs", "cronjobs", "statefulsets", "daemonsets", "replicasets", "replicationcontrollers"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv048
────────────────────────────────────────
 test_clusterrole.yaml:164-174
────────────────────────────────────────
 164 ┌   - apiGroups:
 165 │       - batch
 166 │     resources:
 167 │       - cronjobs
 168 │       - jobs
 169 │     verbs:
 170 │       - create
 171 │       - delete
 172 └       - deletecollection
 ...   
────────────────────────────────────────


AVD-KSV-0048 (MEDIUM): ClusterRole 'admin' should not have access to resources ["pods", "deployments", "jobs", "cronjobs", "statefulsets", "daemonsets", "replicasets", "replicationcontrollers"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv048
────────────────────────────────────────
 test_clusterrole.yaml:137-153
────────────────────────────────────────
 137 ┌   - apiGroups:
 138 │       - apps
 139 │     resources:
 140 │       - daemonsets
 141 │       - deployments
 142 │       - deployments/rollback
 143 │       - deployments/scale
 144 │       - replicasets
 145 └       - replicasets/scale
 ...   
────────────────────────────────────────


AVD-KSV-0048 (MEDIUM): ClusterRole 'admin' should not have access to resources ["pods", "deployments", "jobs", "cronjobs", "statefulsets", "daemonsets", "replicasets", "replicationcontrollers"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv048
────────────────────────────────────────
 test_clusterrole.yaml:119-136
────────────────────────────────────────
 119 ┌   - apiGroups:
 120 │       - ""
 121 │     resources:
 122 │       - configmaps
 123 │       - endpoints
 124 │       - persistentvolumeclaims
 125 │       - replicationcontrollers
 126 │       - replicationcontrollers/scale
 127 └       - secrets
 ...   
────────────────────────────────────────


AVD-KSV-0048 (MEDIUM): ClusterRole 'admin' should not have access to resources ["pods", "deployments", "jobs", "cronjobs", "statefulsets", "daemonsets", "replicasets", "replicationcontrollers"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv048
────────────────────────────────────────
 test_clusterrole.yaml:105-118
────────────────────────────────────────
 105 ┌   - apiGroups:
 106 │       - ""
 107 │     resources:
 108 │       - pods
 109 │       - pods/attach
 110 │       - pods/exec
 111 │       - pods/portforward
 112 │       - pods/proxy
 113 └     verbs:
 ...   
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'admin' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 test_clusterrole.yaml:119-136
────────────────────────────────────────
 119 ┌   - apiGroups:
 120 │       - ""
 121 │     resources:
 122 │       - configmaps
 123 │       - endpoints
 124 │       - persistentvolumeclaims
 125 │       - replicationcontrollers
 126 │       - replicationcontrollers/scale
 127 └       - secrets
 ...   
────────────────────────────────────────


AVD-KSV-0050 (CRITICAL): ClusterRole 'admin' should not have access to resources ["roles", "rolebindings"] for verbs ["create", "update", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
An effective level of access equivalent to cluster-admin should not be provided.

See https://avd.aquasec.com/misconfig/ksv050
────────────────────────────────────────
 test_clusterrole.yaml:774-787
────────────────────────────────────────
 774 ┌   - apiGroups:
 775 │       - rbac.authorization.k8s.io
 776 │     resources:
 777 │       - rolebindings
 778 │       - roles
 779 │     verbs:
 780 │       - create
 781 │       - delete
 782 └       - deletecollection
 ...   
────────────────────────────────────────


AVD-KSV-0053 (HIGH): ClusterRole 'admin' should not have access to resource '["pods/exec"]' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to exec into a container with privileged access to the host or with an attached SA with higher RBAC permissions is a common escalation path to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv053
────────────────────────────────────────
 test_clusterrole.yaml:105-118
────────────────────────────────────────
 105 ┌   - apiGroups:
 106 │       - ""
 107 │     resources:
 108 │       - pods
 109 │       - pods/attach
 110 │       - pods/exec
 111 │       - pods/portforward
 112 │       - pods/proxy
 113 └     verbs:
 ...   
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole.yaml:237-242
────────────────────────────────────────
 237 ┌   - apiGroups:
 238 │       - networking.k8s.io
 239 │     resources:
 240 │       - ingresses
 241 │     verbs:
 242 └       - update
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole.yaml:231-236
────────────────────────────────────────
 231 ┌   - apiGroups:
 232 │       - networking.k8s.io
 233 │     resources:
 234 │       - ingresses
 235 │     verbs:
 236 └       - patch
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole.yaml:119-136
────────────────────────────────────────
 119 ┌   - apiGroups:
 120 │       - ""
 121 │     resources:
 122 │       - configmaps
 123 │       - endpoints
 124 │       - persistentvolumeclaims
 125 │       - replicationcontrollers
 126 │       - replicationcontrollers/scale
 127 └       - secrets
 ...   
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole.yaml:225-230
────────────────────────────────────────
 225 ┌   - apiGroups:
 226 │       - networking.k8s.io
 227 │     resources:
 228 │       - ingresses
 229 │     verbs:
 230 └       - deletecollection
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole.yaml:219-224
────────────────────────────────────────
 219 ┌   - apiGroups:
 220 │       - networking.k8s.io
 221 │     resources:
 222 │       - ingresses
 223 │     verbs:
 224 └       - delete
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole.yaml:213-218
────────────────────────────────────────
 213 ┌   - apiGroups:
 214 │       - networking.k8s.io
 215 │     resources:
 216 │       - ingresses
 217 │     verbs:
 218 └       - create
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole.yaml:203-212
────────────────────────────────────────
 203 ┌   - apiGroups:
 204 │       - networking.k8s.io
 205 │     resources:
 206 │       - networkpolicies
 207 │     verbs:
 208 │       - create
 209 │       - delete
 210 │       - deletecollection
 211 │       - patch
 212 └       - update
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole.yaml:175-192
────────────────────────────────────────
 175 ┌   - apiGroups:
 176 │       - extensions
 177 │     resources:
 178 │       - daemonsets
 179 │       - deployments
 180 │       - deployments/rollback
 181 │       - deployments/scale
 182 │       - ingresses
 183 └       - networkpolicies
 ...   
────────────────────────────────────────



test_clusterrole1.yaml (kubernetes)
===================================
Tests: 119 (SUCCESSES: 101, FAILURES: 18)
Failures: 18 (UNKNOWN: 0, LOW: 0, MEDIUM: 6, HIGH: 9, CRITICAL: 3)

AVD-KSV-0041 (CRITICAL): ClusterRole 'admin' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 test_clusterrole1.yaml:119-136
────────────────────────────────────────
 119 ┌   - apiGroups:
 120 │       - ""
 121 │     resources:
 122 │       - configmaps
 123 │       - endpoints
 124 │       - persistentvolumeclaims
 125 │       - replicationcontrollers
 126 │       - replicationcontrollers/scale
 127 └       - secrets
 ...   
────────────────────────────────────────


AVD-KSV-0041 (CRITICAL): ClusterRole 'admin' shouldn't have access to manage resource 'secrets'
════════════════════════════════════════
Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.

See https://avd.aquasec.com/misconfig/ksv041
────────────────────────────────────────
 test_clusterrole1.yaml:86-98
────────────────────────────────────────
  86 ┌   - apiGroups:
  87 │       - ""
  88 │     resources:
  89 │       - pods/attach
  90 │       - pods/exec
  91 │       - pods/portforward
  92 │       - pods/proxy
  93 │       - secrets
  94 └       - services/proxy
  ..   
────────────────────────────────────────


AVD-KSV-0048 (MEDIUM): ClusterRole 'admin' should not have access to resources ["pods", "deployments", "jobs", "cronjobs", "statefulsets", "daemonsets", "replicasets", "replicationcontrollers"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv048
────────────────────────────────────────
 test_clusterrole1.yaml:175-192
────────────────────────────────────────
 175 ┌   - apiGroups:
 176 │       - extensions
 177 │     resources:
 178 │       - daemonsets
 179 │       - deployments
 180 │       - deployments/rollback
 181 │       - deployments/scale
 182 │       - ingresses
 183 └       - networkpolicies
 ...   
────────────────────────────────────────


AVD-KSV-0048 (MEDIUM): ClusterRole 'admin' should not have access to resources ["pods", "deployments", "jobs", "cronjobs", "statefulsets", "daemonsets", "replicasets", "replicationcontrollers"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv048
────────────────────────────────────────
 test_clusterrole1.yaml:164-174
────────────────────────────────────────
 164 ┌   - apiGroups:
 165 │       - batch
 166 │     resources:
 167 │       - cronjobs
 168 │       - jobs
 169 │     verbs:
 170 │       - create
 171 │       - delete
 172 └       - deletecollection
 ...   
────────────────────────────────────────


AVD-KSV-0048 (MEDIUM): ClusterRole 'admin' should not have access to resources ["pods", "deployments", "jobs", "cronjobs", "statefulsets", "daemonsets", "replicasets", "replicationcontrollers"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv048
────────────────────────────────────────
 test_clusterrole1.yaml:137-153
────────────────────────────────────────
 137 ┌   - apiGroups:
 138 │       - apps
 139 │     resources:
 140 │       - daemonsets
 141 │       - deployments
 142 │       - deployments/rollback
 143 │       - deployments/scale
 144 │       - replicasets
 145 └       - replicasets/scale
 ...   
────────────────────────────────────────


AVD-KSV-0048 (MEDIUM): ClusterRole 'admin' should not have access to resources ["pods", "deployments", "jobs", "cronjobs", "statefulsets", "daemonsets", "replicasets", "replicationcontrollers"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv048
────────────────────────────────────────
 test_clusterrole1.yaml:119-136
────────────────────────────────────────
 119 ┌   - apiGroups:
 120 │       - ""
 121 │     resources:
 122 │       - configmaps
 123 │       - endpoints
 124 │       - persistentvolumeclaims
 125 │       - replicationcontrollers
 126 │       - replicationcontrollers/scale
 127 └       - secrets
 ...   
────────────────────────────────────────


AVD-KSV-0048 (MEDIUM): ClusterRole 'admin' should not have access to resources ["pods", "deployments", "jobs", "cronjobs", "statefulsets", "daemonsets", "replicasets", "replicationcontrollers"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv048
────────────────────────────────────────
 test_clusterrole1.yaml:105-118
────────────────────────────────────────
 105 ┌   - apiGroups:
 106 │       - ""
 107 │     resources:
 108 │       - pods
 109 │       - pods/attach
 110 │       - pods/exec
 111 │       - pods/portforward
 112 │       - pods/proxy
 113 └     verbs:
 ...   
────────────────────────────────────────


AVD-KSV-0049 (MEDIUM): ClusterRole 'admin' should not have access to resource 'configmaps' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.

See https://avd.aquasec.com/misconfig/ksv049
────────────────────────────────────────
 test_clusterrole1.yaml:119-136
────────────────────────────────────────
 119 ┌   - apiGroups:
 120 │       - ""
 121 │     resources:
 122 │       - configmaps
 123 │       - endpoints
 124 │       - persistentvolumeclaims
 125 │       - replicationcontrollers
 126 │       - replicationcontrollers/scale
 127 └       - secrets
 ...   
────────────────────────────────────────


AVD-KSV-0050 (CRITICAL): ClusterRole 'admin' should not have access to resources ["roles", "rolebindings"] for verbs ["create", "update", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
An effective level of access equivalent to cluster-admin should not be provided.

See https://avd.aquasec.com/misconfig/ksv050
────────────────────────────────────────
 test_clusterrole1.yaml:774-787
────────────────────────────────────────
 774 ┌   - apiGroups:
 775 │       - rbac.authorization.k8s.io
 776 │     resources:
 777 │       - rolebindings
 778 │       - roles
 779 │     verbs:
 780 │       - create
 781 │       - delete
 782 └       - deletecollection
 ...   
────────────────────────────────────────


AVD-KSV-0053 (HIGH): ClusterRole 'admin' should not have access to resource '["pods/exec"]' for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to exec into a container with privileged access to the host or with an attached SA with higher RBAC permissions is a common escalation path to cluster-admin.

See https://avd.aquasec.com/misconfig/ksv053
────────────────────────────────────────
 test_clusterrole1.yaml:105-118
────────────────────────────────────────
 105 ┌   - apiGroups:
 106 │       - ""
 107 │     resources:
 108 │       - pods
 109 │       - pods/attach
 110 │       - pods/exec
 111 │       - pods/portforward
 112 │       - pods/proxy
 113 └     verbs:
 ...   
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole1.yaml:237-242
────────────────────────────────────────
 237 ┌   - apiGroups:
 238 │       - networking.k8s.io
 239 │     resources:
 240 │       - ingresses
 241 │     verbs:
 242 └       - update
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole1.yaml:231-236
────────────────────────────────────────
 231 ┌   - apiGroups:
 232 │       - networking.k8s.io
 233 │     resources:
 234 │       - ingresses
 235 │     verbs:
 236 └       - patch
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole1.yaml:119-136
────────────────────────────────────────
 119 ┌   - apiGroups:
 120 │       - ""
 121 │     resources:
 122 │       - configmaps
 123 │       - endpoints
 124 │       - persistentvolumeclaims
 125 │       - replicationcontrollers
 126 │       - replicationcontrollers/scale
 127 └       - secrets
 ...   
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole1.yaml:225-230
────────────────────────────────────────
 225 ┌   - apiGroups:
 226 │       - networking.k8s.io
 227 │     resources:
 228 │       - ingresses
 229 │     verbs:
 230 └       - deletecollection
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole1.yaml:219-224
────────────────────────────────────────
 219 ┌   - apiGroups:
 220 │       - networking.k8s.io
 221 │     resources:
 222 │       - ingresses
 223 │     verbs:
 224 └       - delete
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole1.yaml:213-218
────────────────────────────────────────
 213 ┌   - apiGroups:
 214 │       - networking.k8s.io
 215 │     resources:
 216 │       - ingresses
 217 │     verbs:
 218 └       - create
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole1.yaml:203-212
────────────────────────────────────────
 203 ┌   - apiGroups:
 204 │       - networking.k8s.io
 205 │     resources:
 206 │       - networkpolicies
 207 │     verbs:
 208 │       - create
 209 │       - delete
 210 │       - deletecollection
 211 │       - patch
 212 └       - update
────────────────────────────────────────


AVD-KSV-0056 (HIGH): ClusterRole 'admin' should not have access to resources ["services", "endpoints", "endpointslices", "networkpolicies", "ingresses"] for verbs ["create", "update", "patch", "delete", "deletecollection", "impersonate", "*"]
════════════════════════════════════════
The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.

See https://avd.aquasec.com/misconfig/ksv056
────────────────────────────────────────
 test_clusterrole1.yaml:175-192
────────────────────────────────────────
 175 ┌   - apiGroups:
 176 │       - extensions
 177 │     resources:
 178 │       - daemonsets
 179 │       - deployments
 180 │       - deployments/rollback
 181 │       - deployments/scale
 182 │       - ingresses
 183 └       - networkpolicies
 ...   
────────────────────────────────────────



traefik17.yaml (kubernetes)
===========================
Tests: 107 (SUCCESSES: 98, FAILURES: 9)
Failures: 9 (UNKNOWN: 0, LOW: 5, MEDIUM: 4, HIGH: 0, CRITICAL: 0)

AVD-KSV-0011 (LOW): Container 'traefik' of Pod 'traefik-f4564c4f4-t99xl' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 traefik17.yaml:29-107
────────────────────────────────────────
  29 ┌   - args:
  30 │     - --global.checknewversion
  31 │     - --global.sendanonymoususage
  32 │     - --entrypoints.metrics.address=:9100/tcp
  33 │     - --entrypoints.traefik.address=:9000/tcp
  34 │     - --entrypoints.web.address=:8000/tcp
  35 │     - --entrypoints.websecure.address=:8443/tcp
  36 │     - --api.dashboard=true
  37 └     - --ping=true
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'traefik' of Pod 'traefik-f4564c4f4-t99xl' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 traefik17.yaml:29-107
────────────────────────────────────────
  29 ┌   - args:
  30 │     - --global.checknewversion
  31 │     - --global.sendanonymoususage
  32 │     - --entrypoints.metrics.address=:9100/tcp
  33 │     - --entrypoints.traefik.address=:9000/tcp
  34 │     - --entrypoints.web.address=:8000/tcp
  35 │     - --entrypoints.websecure.address=:8443/tcp
  36 │     - --api.dashboard=true
  37 └     - --ping=true
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'traefik' of Pod 'traefik-f4564c4f4-t99xl' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 traefik17.yaml:29-107
────────────────────────────────────────
  29 ┌   - args:
  30 │     - --global.checknewversion
  31 │     - --global.sendanonymoususage
  32 │     - --entrypoints.metrics.address=:9100/tcp
  33 │     - --entrypoints.traefik.address=:9000/tcp
  34 │     - --entrypoints.web.address=:8000/tcp
  35 │     - --entrypoints.websecure.address=:8443/tcp
  36 │     - --api.dashboard=true
  37 └     - --ping=true
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'traefik' of Pod 'traefik-f4564c4f4-t99xl' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 traefik17.yaml:29-107
────────────────────────────────────────
  29 ┌   - args:
  30 │     - --global.checknewversion
  31 │     - --global.sendanonymoususage
  32 │     - --entrypoints.metrics.address=:9100/tcp
  33 │     - --entrypoints.traefik.address=:9000/tcp
  34 │     - --entrypoints.web.address=:8000/tcp
  35 │     - --entrypoints.websecure.address=:8443/tcp
  36 │     - --api.dashboard=true
  37 └     - --ping=true
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 traefik17.yaml:29-107
────────────────────────────────────────
  29 ┌   - args:
  30 │     - --global.checknewversion
  31 │     - --global.sendanonymoususage
  32 │     - --entrypoints.metrics.address=:9100/tcp
  33 │     - --entrypoints.traefik.address=:9000/tcp
  34 │     - --entrypoints.web.address=:8000/tcp
  35 │     - --entrypoints.websecure.address=:8443/tcp
  36 │     - --api.dashboard=true
  37 └     - --ping=true
  ..   
────────────────────────────────────────


AVD-KSV-0036 (MEDIUM): Container of Pod 'traefik-f4564c4f4-t99xl' should set 'spec.automountServiceAccountToken' to false
════════════════════════════════════════
ensure that Pod specifications disable the secret token being mounted by setting automountServiceAccountToken: false

See https://avd.aquasec.com/misconfig/ksv036
────────────────────────────────────────
 traefik17.yaml:28-163
────────────────────────────────────────
  28 ┌   containers:
  29 │   - args:
  30 │     - --global.checknewversion
  31 │     - --global.sendanonymoususage
  32 │     - --entrypoints.metrics.address=:9100/tcp
  33 │     - --entrypoints.traefik.address=:9000/tcp
  34 │     - --entrypoints.web.address=:8000/tcp
  35 │     - --entrypoints.websecure.address=:8443/tcp
  36 └     - --api.dashboard=true
  ..   
────────────────────────────────────────


AVD-KSV-0037 (MEDIUM): Pod 'traefik-f4564c4f4-t99xl' should not be set with 'kube-system' namespace
════════════════════════════════════════
ensure that user resources are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/no-user-pods-in-system-namespace
────────────────────────────────────────
 traefik17.yaml:28-163
────────────────────────────────────────
  28 ┌   containers:
  29 │   - args:
  30 │     - --global.checknewversion
  31 │     - --global.sendanonymoususage
  32 │     - --entrypoints.metrics.address=:9100/tcp
  33 │     - --entrypoints.traefik.address=:9000/tcp
  34 │     - --entrypoints.web.address=:8000/tcp
  35 │     - --entrypoints.websecure.address=:8443/tcp
  36 └     - --api.dashboard=true
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "traefik" of pod "traefik-f4564c4f4-t99xl" in "kube-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 traefik17.yaml:29-107
────────────────────────────────────────
  29 ┌   - args:
  30 │     - --global.checknewversion
  31 │     - --global.sendanonymoususage
  32 │     - --entrypoints.metrics.address=:9100/tcp
  33 │     - --entrypoints.traefik.address=:9000/tcp
  34 │     - --entrypoints.web.address=:8000/tcp
  35 │     - --entrypoints.websecure.address=:8443/tcp
  36 │     - --api.dashboard=true
  37 └     - --ping=true
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container traefik in pod traefik-f4564c4f4-t99xl (namespace: kube-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 traefik17.yaml:29-107
────────────────────────────────────────
  29 ┌   - args:
  30 │     - --global.checknewversion
  31 │     - --global.sendanonymoususage
  32 │     - --entrypoints.metrics.address=:9100/tcp
  33 │     - --entrypoints.traefik.address=:9000/tcp
  34 │     - --entrypoints.web.address=:8000/tcp
  35 │     - --entrypoints.websecure.address=:8443/tcp
  36 │     - --api.dashboard=true
  37 └     - --ping=true
  ..   
────────────────────────────────────────



v0.13.10.metallb-frr1_23.yaml (kubernetes)
==========================================
Tests: 199 (SUCCESSES: 87, FAILURES: 112)
Failures: 112 (UNKNOWN: 0, LOW: 68, MEDIUM: 29, HIGH: 15, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-frr-files' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0005 (HIGH): Container 'frr' of DaemonSet 'speaker' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0009 (HIGH): DaemonSet 'speaker' should not set 'spec.template.spec.hostNetwork' to true
════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:10-222
────────────────────────────────────────
  10 ┌   selector:
  11 │     matchLabels:
  12 │       app: metallb
  13 │       component: speaker
  14 │   template:
  15 │     metadata:
  16 │       annotations:
  17 │         prometheus.io/port: '7472'
  18 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-frr-files" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "speaker" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should not add stuff
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:143-146
────────────────────────────────────────
 143 ┌             add:
 144 │             - NET_RAW
 145 │             drop:
 146 └             - ALL
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): daemonset speaker in metallb-system namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:23-222
────────────────────────────────────────
  23 ┌       containers:
  24 │       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 └         - name: TINI_SUBREAPER
  ..   
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container frr of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container speaker of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-frr-files in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container speaker in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────



v0.13.10.metallb-frr_23.yaml (kubernetes)
=========================================
Tests: 199 (SUCCESSES: 87, FAILURES: 112)
Failures: 112 (UNKNOWN: 0, LOW: 68, MEDIUM: 29, HIGH: 15, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-frr-files' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0005 (HIGH): Container 'frr' of DaemonSet 'speaker' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0009 (HIGH): DaemonSet 'speaker' should not set 'spec.template.spec.hostNetwork' to true
════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:10-222
────────────────────────────────────────
  10 ┌   selector:
  11 │     matchLabels:
  12 │       app: metallb
  13 │       component: speaker
  14 │   template:
  15 │     metadata:
  16 │       annotations:
  17 │         prometheus.io/port: '7472'
  18 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-frr-files" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "speaker" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should not add stuff
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:143-146
────────────────────────────────────────
 143 ┌             add:
 144 │             - NET_RAW
 145 │             drop:
 146 └             - ALL
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): daemonset speaker in metallb-system namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:23-222
────────────────────────────────────────
  23 ┌       containers:
  24 │       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 └         - name: TINI_SUBREAPER
  ..   
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container frr of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container speaker of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-frr-files in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:main
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.4.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container speaker in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.10.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────



v0.13.12.metallb-frr1_23.yaml (kubernetes)
==========================================
Tests: 199 (SUCCESSES: 87, FAILURES: 112)
Failures: 112 (UNKNOWN: 0, LOW: 68, MEDIUM: 29, HIGH: 15, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-frr-files' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0005 (HIGH): Container 'frr' of DaemonSet 'speaker' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0009 (HIGH): DaemonSet 'speaker' should not set 'spec.template.spec.hostNetwork' to true
════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:10-222
────────────────────────────────────────
  10 ┌   selector:
  11 │     matchLabels:
  12 │       app: metallb
  13 │       component: speaker
  14 │   template:
  15 │     metadata:
  16 │       annotations:
  17 │         prometheus.io/port: '7472'
  18 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-frr-files" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "speaker" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should not add stuff
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:143-146
────────────────────────────────────────
 143 ┌             add:
 144 │             - NET_RAW
 145 │             drop:
 146 └             - ALL
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): daemonset speaker in metallb-system namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:23-222
────────────────────────────────────────
  23 ┌       containers:
  24 │       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 └         - name: TINI_SUBREAPER
  ..   
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container frr of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container speaker of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-frr-files in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: quay.io/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: quay.io/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: quay.io/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container speaker in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr1_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────



v0.13.12.metallb-frr_23.yaml (kubernetes)
=========================================
Tests: 199 (SUCCESSES: 87, FAILURES: 112)
Failures: 112 (UNKNOWN: 0, LOW: 68, MEDIUM: 29, HIGH: 15, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-frr-files' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0005 (HIGH): Container 'frr' of DaemonSet 'speaker' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0009 (HIGH): DaemonSet 'speaker' should not set 'spec.template.spec.hostNetwork' to true
════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:10-222
────────────────────────────────────────
  10 ┌   selector:
  11 │     matchLabels:
  12 │       app: metallb
  13 │       component: speaker
  14 │   template:
  15 │     metadata:
  16 │       annotations:
  17 │         prometheus.io/port: '7472'
  18 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-frr-files" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "speaker" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should not add stuff
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:143-146
────────────────────────────────────────
 143 ┌             add:
 144 │             - NET_RAW
 145 │             drop:
 146 └             - ALL
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): daemonset speaker in metallb-system namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:23-222
────────────────────────────────────────
  23 ┌       containers:
  24 │       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 └         - name: TINI_SUBREAPER
  ..   
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container frr of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container speaker of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-frr-files in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:159-172
────────────────────────────────────────
 159 ┌       - command:
 160 │         - /bin/sh
 161 │         - -c
 162 │         - cp -rLf /tmp/frr/* /etc/frr/
 163 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
 164 │         name: cp-frr-files
 165 │         securityContext:
 166 │           runAsGroup: 101
 167 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:182-190
────────────────────────────────────────
 182 ┌       - command:
 183 │         - /bin/sh
 184 │         - -c
 185 │         - cp -f /frr-metrics /etc/frr_metrics/
 186 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 187 │         name: cp-metrics
 188 │         volumeMounts:
 189 │         - mountPath: /etc/frr_metrics
 190 └           name: metrics
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:173-181
────────────────────────────────────────
 173 ┌       - command:
 174 │         - /bin/sh
 175 │         - -c
 176 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 177 │         image: harbor.iblog.pro/quayio/metallb/speaker:v0.13.12
 178 │         name: cp-reloader
 179 │         volumeMounts:
 180 │         - mountPath: /etc/frr_reloader
 181 └           name: reloader
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: harbor.iblog.pro/quayio/frrouting/frr:8.5.2
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container speaker in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.12.metallb-frr_23.yaml:86-156
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────



v0.13.4.metallb-frr_24.yaml (kubernetes)
========================================
Tests: 199 (SUCCESSES: 87, FAILURES: 112)
Failures: 112 (UNKNOWN: 0, LOW: 68, MEDIUM: 29, HIGH: 15, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-frr-files' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0005 (HIGH): Container 'frr' of DaemonSet 'speaker' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0009 (HIGH): DaemonSet 'speaker' should not set 'spec.template.spec.hostNetwork' to true
════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:10-199
────────────────────────────────────────
  10 ┌   selector:
  11 │     matchLabels:
  12 │       app: metallb
  13 │       component: speaker
  14 │   template:
  15 │     metadata:
  16 │       annotations:
  17 │         prometheus.io/port: '7472'
  18 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-frr-files" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "speaker" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should not add stuff
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:134-137
────────────────────────────────────────
 134 ┌             add:
 135 │             - NET_RAW
 136 │             drop:
 137 └             - ALL
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): daemonset speaker in metallb-system namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:23-199
────────────────────────────────────────
  23 ┌       containers:
  24 │       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 └         - name: TINI_SUBREAPER
  ..   
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container frr of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container speaker of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-frr-files in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: harbor.iblog.pro/quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: harbor.iblog.pro/docker.io/frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container speaker in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.4.metallb-frr_24.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────



v0.13.7.metallb-frr_22.yaml (kubernetes)
========================================
Tests: 199 (SUCCESSES: 87, FAILURES: 112)
Failures: 112 (UNKNOWN: 0, LOW: 68, MEDIUM: 29, HIGH: 15, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-frr-files' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0005 (HIGH): Container 'frr' of DaemonSet 'speaker' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0009 (HIGH): DaemonSet 'speaker' should not set 'spec.template.spec.hostNetwork' to true
════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:10-199
────────────────────────────────────────
  10 ┌   selector:
  11 │     matchLabels:
  12 │       app: metallb
  13 │       component: speaker
  14 │   template:
  15 │     metadata:
  16 │       annotations:
  17 │         prometheus.io/port: '7472'
  18 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-frr-files" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "speaker" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should not add stuff
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:134-137
────────────────────────────────────────
 134 ┌             add:
 135 │             - NET_RAW
 136 │             drop:
 137 └             - ALL
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): daemonset speaker in metallb-system namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:23-199
────────────────────────────────────────
  23 ┌       containers:
  24 │       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 └         - name: TINI_SUBREAPER
  ..   
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container frr of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container speaker of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-frr-files in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:144-157
────────────────────────────────────────
 144 ┌       - command:
 145 │         - /bin/sh
 146 │         - -c
 147 │         - cp -rLf /tmp/frr/* /etc/frr/
 148 │         image: frrouting/frr:v7.5.1
 149 │         name: cp-frr-files
 150 │         securityContext:
 151 │           runAsGroup: 101
 152 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:167-175
────────────────────────────────────────
 167 ┌       - command:
 168 │         - /bin/sh
 169 │         - -c
 170 │         - cp -f /frr-metrics /etc/frr_metrics/
 171 │         image: quay.io/metallb/speaker:main
 172 │         name: cp-metrics
 173 │         volumeMounts:
 174 │         - mountPath: /etc/frr_metrics
 175 └           name: metrics
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:158-166
────────────────────────────────────────
 158 ┌       - command:
 159 │         - /bin/sh
 160 │         - -c
 161 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 162 │         image: quay.io/metallb/speaker:main
 163 │         name: cp-reloader
 164 │         volumeMounts:
 165 │         - mountPath: /etc/frr_reloader
 166 └           name: reloader
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:24-46
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:58-73
────────────────────────────────────────
  58 ┌       - args:
  59 │         - --metrics-port=7473
  60 │         command:
  61 │         - /etc/frr_metrics/frr-metrics
  62 │         image: frrouting/frr:v7.5.1
  63 │         name: frr-metrics
  64 │         ports:
  65 │         - containerPort: 7473
  66 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:47-57
────────────────────────────────────────
  47 ┌       - command:
  48 │         - /etc/frr_reloader/frr-reloader.sh
  49 │         image: frrouting/frr:v7.5.1
  50 │         name: reloader
  51 │         volumeMounts:
  52 │         - mountPath: /var/run/frr
  53 │           name: frr-sockets
  54 │         - mountPath: /etc/frr
  55 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container speaker in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.7.metallb-frr_22.yaml:74-141
────────────────────────────────────────
  74 ┌       - args:
  75 │         - --port=7472
  76 │         - --log-level=info
  77 │         env:
  78 │         - name: FRR_CONFIG_FILE
  79 │           value: /etc/frr_reloader/frr.conf
  80 │         - name: FRR_RELOADER_PID_FILE
  81 │           value: /etc/frr_reloader/reloader.pid
  82 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────



v0.13.9.metallb-frr_22.yaml (kubernetes)
========================================
Tests: 199 (SUCCESSES: 87, FAILURES: 112)
Failures: 112 (UNKNOWN: 0, LOW: 68, MEDIUM: 29, HIGH: 15, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'reloader' of DaemonSet 'speaker' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-frr-files' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'cp-reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'frr-metrics' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'reloader' of 'daemonset' 'speaker' in 'metallb-system' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0005 (HIGH): Container 'frr' of DaemonSet 'speaker' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0009 (HIGH): DaemonSet 'speaker' should not set 'spec.template.spec.hostNetwork' to true
════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:10-215
────────────────────────────────────────
  10 ┌   selector:
  11 │     matchLabels:
  12 │       app: metallb
  13 │       component: speaker
  14 │   template:
  15 │     metadata:
  16 │       annotations:
  17 │         prometheus.io/port: '7472'
  18 └         prometheus.io/scrape: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-frr-files' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'cp-reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'frr-metrics' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'reloader' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'speaker' of DaemonSet 'speaker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'frr' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0022 (MEDIUM): Container 'speaker' of DaemonSet 'speaker' should not set 'securityContext.capabilities.add'
════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-frr-files" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "cp-reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "frr-metrics" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "reloader" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "speaker" of daemonset "speaker" in "metallb-system" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should not add stuff
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:143-146
────────────────────────────────────────
 143 ┌             add:
 144 │             - NET_RAW
 145 │             drop:
 146 └             - ALL
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container speaker in metallb-system namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): daemonset speaker in metallb-system namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:23-215
────────────────────────────────────────
  23 ┌       containers:
  24 │       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 └         - name: TINI_SUBREAPER
  ..   
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container frr of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0119 (HIGH): container speaker of daemonset speaker in metallb-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-frr-files in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:156-169
────────────────────────────────────────
 156 ┌       - command:
 157 │         - /bin/sh
 158 │         - -c
 159 │         - cp -rLf /tmp/frr/* /etc/frr/
 160 │         image: quay.io/frrouting/frr:7.5.1
 161 │         name: cp-frr-files
 162 │         securityContext:
 163 │           runAsGroup: 101
 164 └           runAsUser: 100
 ...   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:179-187
────────────────────────────────────────
 179 ┌       - command:
 180 │         - /bin/sh
 181 │         - -c
 182 │         - cp -f /frr-metrics /etc/frr_metrics/
 183 │         image: quay.io/metallb/speaker:main
 184 │         name: cp-metrics
 185 │         volumeMounts:
 186 │         - mountPath: /etc/frr_metrics
 187 └           name: metrics
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container cp-reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:170-178
────────────────────────────────────────
 170 ┌       - command:
 171 │         - /bin/sh
 172 │         - -c
 173 │         - cp -f /frr-reloader.sh /etc/frr_reloader/
 174 │         image: quay.io/metallb/speaker:main
 175 │         name: cp-reloader
 176 │         volumeMounts:
 177 │         - mountPath: /etc/frr_reloader
 178 └           name: reloader
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:24-58
────────────────────────────────────────
  24 ┌       - command:
  25 │         - /bin/sh
  26 │         - -c
  27 │         - "/sbin/tini -- /usr/lib/frr/docker-start &\nattempts=0\nuntil [[ -f /etc/frr/frr.log\
  28 │           \ || $attempts -eq 60 ]]; do\n  sleep 1\n  attempts=$(( $attempts + 1 ))\n\
  29 │           done\ntail -f /etc/frr/frr.log\n"
  30 │         env:
  31 │         - name: TINI_SUBREAPER
  32 └           value: 'true'
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container frr-metrics in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:70-85
────────────────────────────────────────
  70 ┌       - args:
  71 │         - --metrics-port=7473
  72 │         command:
  73 │         - /etc/frr_metrics/frr-metrics
  74 │         image: quay.io/frrouting/frr:7.5.1
  75 │         name: frr-metrics
  76 │         ports:
  77 │         - containerPort: 7473
  78 └           name: monitoring
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container reloader in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:59-69
────────────────────────────────────────
  59 ┌       - command:
  60 │         - /etc/frr_reloader/frr-reloader.sh
  61 │         image: quay.io/frrouting/frr:7.5.1
  62 │         name: reloader
  63 │         volumeMounts:
  64 │         - mountPath: /var/run/frr
  65 │           name: frr-sockets
  66 │         - mountPath: /etc/frr
  67 └           name: frr-conf
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container speaker in daemonset speaker (namespace: metallb-system) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 v0.13.9.metallb-frr_22.yaml:86-153
────────────────────────────────────────
  86 ┌       - args:
  87 │         - --port=7472
  88 │         - --log-level=info
  89 │         env:
  90 │         - name: FRR_CONFIG_FILE
  91 │           value: /etc/frr_reloader/frr.conf
  92 │         - name: FRR_RELOADER_PID_FILE
  93 │           value: /etc/frr_reloader/reloader.pid
  94 └         - name: METALLB_BGP_TYPE
  ..   
────────────────────────────────────────



vector-config.yaml (kubernetes)
===============================
Tests: 107 (SUCCESSES: 106, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

AVD-KSV-01010 (MEDIUM): ConfigMap 'supabase-vector' in 'default' namespace stores sensitive contents in key(s) or value(s) '{"    uri", "vector.yml"}'
════════════════════════════════════════
Storing sensitive content such as usernames and email addresses in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-01010
────────────────────────────────────────



vsphere-csi-driver_11.yaml (kubernetes)
=======================================
Tests: 195 (SUCCESSES: 90, FAILURES: 105)
Failures: 105 (UNKNOWN: 0, LOW: 66, MEDIUM: 26, HIGH: 13, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'csi-attacher' of Deployment 'vsphere-csi-controller' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'csi-provisioner' of Deployment 'vsphere-csi-controller' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'csi-resizer' of Deployment 'vsphere-csi-controller' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'csi-snapshotter' of Deployment 'vsphere-csi-controller' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'liveness-probe' of Deployment 'vsphere-csi-controller' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'vsphere-csi-controller' of Deployment 'vsphere-csi-controller' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0001 (MEDIUM): Container 'vsphere-syncer' of Deployment 'vsphere-csi-controller' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'csi-attacher' of Deployment 'vsphere-csi-controller' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'csi-provisioner' of Deployment 'vsphere-csi-controller' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'csi-resizer' of Deployment 'vsphere-csi-controller' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'csi-snapshotter' of Deployment 'vsphere-csi-controller' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'liveness-probe' of Deployment 'vsphere-csi-controller' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'vsphere-csi-controller' of Deployment 'vsphere-csi-controller' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0003 (LOW): Container 'vsphere-syncer' of Deployment 'vsphere-csi-controller' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'csi-attacher' of 'deployment' 'vsphere-csi-controller' in 'vmware-system-csi' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'csi-provisioner' of 'deployment' 'vsphere-csi-controller' in 'vmware-system-csi' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'csi-resizer' of 'deployment' 'vsphere-csi-controller' in 'vmware-system-csi' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'csi-snapshotter' of 'deployment' 'vsphere-csi-controller' in 'vmware-system-csi' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'liveness-probe' of 'deployment' 'vsphere-csi-controller' in 'vmware-system-csi' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'vsphere-csi-controller' of 'deployment' 'vsphere-csi-controller' in 'vmware-system-csi' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0004 (LOW): Container 'vsphere-syncer' of 'deployment' 'vsphere-csi-controller' in 'vmware-system-csi' namespace should set securityContext.capabilities.drop
════════════════════════════════════════
Security best practices require containers to run with minimal required capabilities.

See https://avd.aquasec.com/misconfig/ksv004
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'csi-attacher' of Deployment 'vsphere-csi-controller' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'csi-provisioner' of Deployment 'vsphere-csi-controller' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'csi-resizer' of Deployment 'vsphere-csi-controller' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'csi-snapshotter' of Deployment 'vsphere-csi-controller' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'liveness-probe' of Deployment 'vsphere-csi-controller' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'vsphere-csi-controller' of Deployment 'vsphere-csi-controller' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'vsphere-syncer' of Deployment 'vsphere-csi-controller' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'csi-attacher' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'csi-provisioner' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'csi-resizer' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'csi-snapshotter' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'liveness-probe' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0013 (MEDIUM): Container 'vsphere-csi-controller' of Deployment 'vsphere-csi-controller' should specify an image tag
════════════════════════════════════════
It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.

See https://avd.aquasec.com/misconfig/ksv013
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0013 (MEDIUM): Container 'vsphere-syncer' of Deployment 'vsphere-csi-controller' should specify an image tag
════════════════════════════════════════
It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.

See https://avd.aquasec.com/misconfig/ksv013
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'csi-attacher' of Deployment 'vsphere-csi-controller' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'csi-provisioner' of Deployment 'vsphere-csi-controller' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'csi-resizer' of Deployment 'vsphere-csi-controller' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'csi-snapshotter' of Deployment 'vsphere-csi-controller' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'liveness-probe' of Deployment 'vsphere-csi-controller' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'vsphere-csi-controller' of Deployment 'vsphere-csi-controller' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'vsphere-syncer' of Deployment 'vsphere-csi-controller' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'csi-attacher' of Deployment 'vsphere-csi-controller' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'csi-provisioner' of Deployment 'vsphere-csi-controller' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'csi-resizer' of Deployment 'vsphere-csi-controller' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'csi-snapshotter' of Deployment 'vsphere-csi-controller' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'liveness-probe' of Deployment 'vsphere-csi-controller' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'vsphere-csi-controller' of Deployment 'vsphere-csi-controller' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'vsphere-syncer' of Deployment 'vsphere-csi-controller' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'csi-attacher' of Deployment 'vsphere-csi-controller' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'csi-provisioner' of Deployment 'vsphere-csi-controller' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'csi-resizer' of Deployment 'vsphere-csi-controller' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'csi-snapshotter' of Deployment 'vsphere-csi-controller' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'liveness-probe' of Deployment 'vsphere-csi-controller' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'vsphere-csi-controller' of Deployment 'vsphere-csi-controller' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'vsphere-syncer' of Deployment 'vsphere-csi-controller' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'csi-attacher' of Deployment 'vsphere-csi-controller' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'csi-provisioner' of Deployment 'vsphere-csi-controller' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'csi-resizer' of Deployment 'vsphere-csi-controller' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'csi-snapshotter' of Deployment 'vsphere-csi-controller' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'liveness-probe' of Deployment 'vsphere-csi-controller' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'vsphere-csi-controller' of Deployment 'vsphere-csi-controller' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'vsphere-syncer' of Deployment 'vsphere-csi-controller' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'csi-attacher' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'csi-provisioner' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'csi-resizer' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'csi-snapshotter' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'liveness-probe' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'csi-attacher' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'csi-provisioner' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'csi-resizer' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'csi-snapshotter' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'liveness-probe' of Deployment 'vsphere-csi-controller' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "csi-attacher" of deployment "vsphere-csi-controller" in "vmware-system-csi" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "csi-provisioner" of deployment "vsphere-csi-controller" in "vmware-system-csi" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "csi-resizer" of deployment "vsphere-csi-controller" in "vmware-system-csi" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "csi-snapshotter" of deployment "vsphere-csi-controller" in "vmware-system-csi" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "liveness-probe" of deployment "vsphere-csi-controller" in "vmware-system-csi" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "vsphere-csi-controller" of deployment "vsphere-csi-controller" in "vmware-system-csi" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "vsphere-syncer" of deployment "vsphere-csi-controller" in "vmware-system-csi" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:82-135
────────────────────────────────────────
  82 ┌       - name: vsphere-csi-controller
  83 │         image: gcr.io/cloud-provider-vsphere/csi/ci/driver:latest
  84 │         args:
  85 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
  86 │         - --fss-namespace=$(CSI_NAMESPACE)
  87 │         imagePullPolicy: Always
  88 │         env:
  89 │         - name: CSI_ENDPOINT
  90 └           value: unix:///csi/csi.sock
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:144-182
────────────────────────────────────────
 144 ┌       - name: vsphere-syncer
 145 │         image: gcr.io/cloud-provider-vsphere/csi/ci/syncer:latest
 146 │         args:
 147 │         - --leader-election
 148 │         - --leader-election-lease-duration=30s
 149 │         - --leader-election-renew-deadline=20s
 150 │         - --leader-election-retry-period=10s
 151 │         - --fss-name=internal-feature-states.csi.vsphere.vmware.com
 152 └         - --fss-namespace=$(CSI_NAMESPACE)
 ...   
────────────────────────────────────────


AVD-KSV-0106 (LOW): container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container vsphere-csi-controller in vmware-system-csi namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container vsphere-csi-controller in vmware-system-csi namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container vsphere-csi-controller in vmware-system-csi namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container vsphere-csi-controller in vmware-system-csi namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): container vsphere-csi-controller in vmware-system-csi namespace is using the default security context
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): deployment vsphere-csi-controller in vmware-system-csi namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:22-225
────────────────────────────────────────
  22 ┌       priorityClassName: system-cluster-critical
  23 │       affinity:
  24 │         podAntiAffinity:
  25 │           requiredDuringSchedulingIgnoredDuringExecution:
  26 │           - labelSelector:
  27 │               matchExpressions:
  28 │               - key: app
  29 │                 operator: In
  30 └                 values:
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container csi-attacher in deployment vsphere-csi-controller (namespace: vmware-system-csi) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:45-62
────────────────────────────────────────
  45 ┌       - name: csi-attacher
  46 │         image: registry.k8s.io/sig-storage/csi-attacher:v4.5.0
  47 │         args:
  48 │         - --v=4
  49 │         - --timeout=300s
  50 │         - --csi-address=$(ADDRESS)
  51 │         - --leader-election
  52 │         - --leader-election-lease-duration=120s
  53 └         - --leader-election-renew-deadline=60s
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container csi-provisioner in deployment vsphere-csi-controller (namespace: vmware-system-csi) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:183-201
────────────────────────────────────────
 183 ┌       - name: csi-provisioner
 184 │         image: registry.k8s.io/sig-storage/csi-provisioner:v4.0.0
 185 │         args:
 186 │         - --v=4
 187 │         - --timeout=300s
 188 │         - --csi-address=$(ADDRESS)
 189 │         - --kube-api-qps=100
 190 │         - --kube-api-burst=100
 191 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container csi-resizer in deployment vsphere-csi-controller (namespace: vmware-system-csi) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:63-81
────────────────────────────────────────
  63 ┌       - name: csi-resizer
  64 │         image: registry.k8s.io/sig-storage/csi-resizer:v1.9.3
  65 │         args:
  66 │         - --v=4
  67 │         - --timeout=300s
  68 │         - --handle-volume-inuse-error=false
  69 │         - --csi-address=$(ADDRESS)
  70 │         - --kube-api-qps=100
  71 └         - --kube-api-burst=100
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container csi-snapshotter in deployment vsphere-csi-controller (namespace: vmware-system-csi) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:202-219
────────────────────────────────────────
 202 ┌       - name: csi-snapshotter
 203 │         image: registry.k8s.io/sig-storage/csi-snapshotter:v6.3.3
 204 │         args:
 205 │         - --v=4
 206 │         - --kube-api-qps=100
 207 │         - --kube-api-burst=100
 208 │         - --timeout=300s
 209 │         - --csi-address=$(ADDRESS)
 210 └         - --leader-election
 ...   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container liveness-probe in deployment vsphere-csi-controller (namespace: vmware-system-csi) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 vsphere-csi-driver_11.yaml:136-143
────────────────────────────────────────
 136 ┌       - name: liveness-probe
 137 │         image: registry.k8s.io/sig-storage/livenessprobe:v2.12.0
 138 │         args:
 139 │         - --v=4
 140 │         - --csi-address=/csi/csi.sock
 141 │         volumeMounts:
 142 │         - name: socket-dir
 143 └           mountPath: /csi
────────────────────────────────────────



waypoint-no-network-label_2.yaml (kubernetes)
=============================================
Tests: 107 (SUCCESSES: 96, FAILURES: 11)
Failures: 11 (UNKNOWN: 0, LOW: 5, MEDIUM: 4, HIGH: 2, CRITICAL: 0)

AVD-KSV-0001 (MEDIUM): Container 'istio-proxy' of Deployment 'namespace-istio-waypoint' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:39-168
────────────────────────────────────────
  39 ┌       - args:
  40 │         - proxy
  41 │         - waypoint
  42 │         - --domain
  43 │         - $(POD_NAMESPACE).svc.<no value>
  44 │         - --serviceCluster
  45 │         - namespace-istio-waypoint.$(POD_NAMESPACE)
  46 │         - --proxyLogLevel
  47 └         - <nil>
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'istio-proxy' of Deployment 'namespace-istio-waypoint' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:39-168
────────────────────────────────────────
  39 ┌       - args:
  40 │         - proxy
  41 │         - waypoint
  42 │         - --domain
  43 │         - $(POD_NAMESPACE).svc.<no value>
  44 │         - --serviceCluster
  45 │         - namespace-istio-waypoint.$(POD_NAMESPACE)
  46 │         - --proxyLogLevel
  47 └         - <nil>
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'istio-proxy' of Deployment 'namespace-istio-waypoint' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:39-168
────────────────────────────────────────
  39 ┌       - args:
  40 │         - proxy
  41 │         - waypoint
  42 │         - --domain
  43 │         - $(POD_NAMESPACE).svc.<no value>
  44 │         - --serviceCluster
  45 │         - namespace-istio-waypoint.$(POD_NAMESPACE)
  46 │         - --proxyLogLevel
  47 └         - <nil>
  ..   
────────────────────────────────────────


AVD-KSV-0020 (LOW): Container 'istio-proxy' of Deployment 'namespace-istio-waypoint' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:39-168
────────────────────────────────────────
  39 ┌       - args:
  40 │         - proxy
  41 │         - waypoint
  42 │         - --domain
  43 │         - $(POD_NAMESPACE).svc.<no value>
  44 │         - --serviceCluster
  45 │         - namespace-istio-waypoint.$(POD_NAMESPACE)
  46 │         - --proxyLogLevel
  47 └         - <nil>
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'istio-proxy' of Deployment 'namespace-istio-waypoint' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:39-168
────────────────────────────────────────
  39 ┌       - args:
  40 │         - proxy
  41 │         - waypoint
  42 │         - --domain
  43 │         - $(POD_NAMESPACE).svc.<no value>
  44 │         - --serviceCluster
  45 │         - namespace-istio-waypoint.$(POD_NAMESPACE)
  46 │         - --proxyLogLevel
  47 └         - <nil>
  ..   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:39-168
────────────────────────────────────────
  39 ┌       - args:
  40 │         - proxy
  41 │         - waypoint
  42 │         - --domain
  43 │         - $(POD_NAMESPACE).svc.<no value>
  44 │         - --serviceCluster
  45 │         - namespace-istio-waypoint.$(POD_NAMESPACE)
  46 │         - --proxyLogLevel
  47 └         - <nil>
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "istio-proxy" of deployment "namespace-istio-waypoint" in "default" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:39-168
────────────────────────────────────────
  39 ┌       - args:
  40 │         - proxy
  41 │         - waypoint
  42 │         - --domain
  43 │         - $(POD_NAMESPACE).svc.<no value>
  44 │         - --serviceCluster
  45 │         - namespace-istio-waypoint.$(POD_NAMESPACE)
  46 │         - --proxyLogLevel
  47 └         - <nil>
  ..   
────────────────────────────────────────


AVD-KSV-0105 (LOW): securityContext.runAsUser should be set to a value greater than 0
════════════════════════════════════════
Containers should be forbidden from running with a root UID.

See https://avd.aquasec.com/misconfig/ksv105
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:140-145
────────────────────────────────────────
 140 ┌           capabilities:
 141 │             drop:
 142 │             - ALL
 143 │           privileged: false
 144 │           runAsGroup: 1337
 145 └           runAsUser: 0
────────────────────────────────────────


AVD-KSV-0110 (LOW): deployment namespace-istio-waypoint in default namespace should set metadata.namespace to a non-default namespace
════════════════════════════════════════
Checks whether a workload is running in the default namespace.

See https://avd.aquasec.com/misconfig/ksv110
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:4-16
────────────────────────────────────────
   4 ┌   annotations: {}
   5 │   labels:
   6 │     gateway.istio.io/managed: istio.io-mesh-controller
   7 │     gateway.networking.k8s.io/gateway-name: namespace
   8 │     istio.io/gateway-name: namespace
   9 │     topology.istio.io/network: network-1
  10 │   name: namespace-istio-waypoint
  11 │   namespace: default
  12 └   ownerReferences:
  ..   
────────────────────────────────────────


AVD-KSV-0118 (HIGH): deployment namespace-istio-waypoint in default namespace is using the default security context, which allows root privileges
════════════════════════════════════════
Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.

See https://avd.aquasec.com/misconfig/ksv118
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:38-202
────────────────────────────────────────
  38 ┌       containers:
  39 │       - args:
  40 │         - proxy
  41 │         - waypoint
  42 │         - --domain
  43 │         - $(POD_NAMESPACE).svc.<no value>
  44 │         - --serviceCluster
  45 │         - namespace-istio-waypoint.$(POD_NAMESPACE)
  46 └         - --proxyLogLevel
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container istio-proxy in deployment namespace-istio-waypoint (namespace: default) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 waypoint-no-network-label_2.yaml:39-168
────────────────────────────────────────
  39 ┌       - args:
  40 │         - proxy
  41 │         - waypoint
  42 │         - --domain
  43 │         - $(POD_NAMESPACE).svc.<no value>
  44 │         - --serviceCluster
  45 │         - namespace-istio-waypoint.$(POD_NAMESPACE)
  46 │         - --proxyLogLevel
  47 └         - <nil>
  ..   
────────────────────────────────────────



windows-bios-installer-configmaps.yaml (kubernetes)
===================================================
Tests: 107 (SUCCESSES: 106, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 1, CRITICAL: 0)

AVD-KSV-0109 (HIGH): ConfigMap 'windows10-bios-autounattend' in 'default' namespace stores secrets in key(s) or value(s) '{"    <component name", "  <settings pass"}'
════════════════════════════════════════
Storing secrets in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-0109
────────────────────────────────────────
 windows-bios-installer-configmaps.yaml:1
────────────────────────────────────────
   1 [ ---
────────────────────────────────────────



windows-efi-installer-configmaps.yaml (kubernetes)
==================================================
Tests: 107 (SUCCESSES: 106, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 1, CRITICAL: 0)

AVD-KSV-0109 (HIGH): ConfigMap 'windows11-autounattend' in 'default' namespace stores secrets in key(s) or value(s) '{"    <component name", "  <settings pass"}'
════════════════════════════════════════
Storing secrets in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-0109
────────────────────────────────────────



windows-efi-installer-configmaps_1.yaml (kubernetes)
====================================================
Tests: 107 (SUCCESSES: 106, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 1, CRITICAL: 0)

AVD-KSV-0109 (HIGH): ConfigMap 'windows2k22-autounattend' in 'default' namespace stores secrets in key(s) or value(s) '{"            <assemblyIdentity name", "        <component language=\"neutral\" name=\"Microsoft-Windows-International-Core-WinPE\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" versionScope=\"nonSxS\" xmlns", "        <component language=\"neutral\" name=\"Microsoft-Windows-PnpCustomizationsWinPE\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" versionScope=\"nonSxS\" xmlns", "        <component language=\"neutral\" name=\"Microsoft-Windows-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" versionScope=\"nonSxS\" xmlns", "        <component name", "    <settings pass"}'
════════════════════════════════════════
Storing secrets in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-0109
────────────────────────────────────────



worker-sts.yaml (kubernetes)
============================
Tests: 127 (SUCCESSES: 96, FAILURES: 31)
Failures: 31 (UNKNOWN: 0, LOW: 19, MEDIUM: 9, HIGH: 3, CRITICAL: 0)

AVD-KSV-0011 (LOW): Container 'wait-for-airflow-migrations' of StatefulSet 'airflow-worker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 worker-sts.yaml:151-208
────────────────────────────────────────
 151 ┌       - args:
 152 │         - airflow
 153 │         - db
 154 │         - check-migrations
 155 │         - --migration-wait-timeout=60
 156 │         env:
 157 │         - name: AIRFLOW__CORE__FERNET_KEY
 158 │           valueFrom:
 159 └             secretKeyRef:
 ...   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'worker' of StatefulSet 'airflow-worker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 worker-sts.yaml:43-126
────────────────────────────────────────
  43 ┌       - args:
  44 │         - bash
  45 │         - -c
  46 │         - |-
  47 │           exec \
  48 │           airflow celery worker
  49 │         env:
  50 │         - name: DUMB_INIT_SETSID
  51 └           value: "0"
  ..   
────────────────────────────────────────


AVD-KSV-0011 (LOW): Container 'worker-log-groomer' of StatefulSet 'airflow-worker' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 worker-sts.yaml:127-148
────────────────────────────────────────
 127 ┌       - args:
 128 │         - bash
 129 │         - /clean-logs
 130 │         env:
 131 │         - name: AIRFLOW__LOG_RETENTION_DAYS
 132 │           value: "15"
 133 │         - name: AIRFLOW_HOME
 134 │           value: /opt/airflow
 135 └         image: apache/airflow:2.8.3
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'wait-for-airflow-migrations' of StatefulSet 'airflow-worker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 worker-sts.yaml:151-208
────────────────────────────────────────
 151 ┌       - args:
 152 │         - airflow
 153 │         - db
 154 │         - check-migrations
 155 │         - --migration-wait-timeout=60
 156 │         env:
 157 │         - name: AIRFLOW__CORE__FERNET_KEY
 158 │           valueFrom:
 159 └             secretKeyRef:
 ...   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'worker' of StatefulSet 'airflow-worker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 worker-sts.yaml:43-126
────────────────────────────────────────
  43 ┌       - args:
  44 │         - bash
  45 │         - -c
  46 │         - |-
  47 │           exec \
  48 │           airflow celery worker
  49 │         env:
  50 │         - name: DUMB_INIT_SETSID
  51 └           value: "0"
  ..   
────────────────────────────────────────


AVD-KSV-0012 (MEDIUM): Container 'worker-log-groomer' of StatefulSet 'airflow-worker' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 worker-sts.yaml:127-148
────────────────────────────────────────
 127 ┌       - args:
 128 │         - bash
 129 │         - /clean-logs
 130 │         env:
 131 │         - name: AIRFLOW__LOG_RETENTION_DAYS
 132 │           value: "15"
 133 │         - name: AIRFLOW_HOME
 134 │           value: /opt/airflow
 135 └         image: apache/airflow:2.8.3
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'wait-for-airflow-migrations' of StatefulSet 'airflow-worker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 worker-sts.yaml:151-208
────────────────────────────────────────
 151 ┌       - args:
 152 │         - airflow
 153 │         - db
 154 │         - check-migrations
 155 │         - --migration-wait-timeout=60
 156 │         env:
 157 │         - name: AIRFLOW__CORE__FERNET_KEY
 158 │           valueFrom:
 159 └             secretKeyRef:
 ...   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'worker' of StatefulSet 'airflow-worker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 worker-sts.yaml:43-126
────────────────────────────────────────
  43 ┌       - args:
  44 │         - bash
  45 │         - -c
  46 │         - |-
  47 │           exec \
  48 │           airflow celery worker
  49 │         env:
  50 │         - name: DUMB_INIT_SETSID
  51 └           value: "0"
  ..   
────────────────────────────────────────


AVD-KSV-0014 (HIGH): Container 'worker-log-groomer' of StatefulSet 'airflow-worker' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 worker-sts.yaml:127-148
────────────────────────────────────────
 127 ┌       - args:
 128 │         - bash
 129 │         - /clean-logs
 130 │         env:
 131 │         - name: AIRFLOW__LOG_RETENTION_DAYS
 132 │           value: "15"
 133 │         - name: AIRFLOW_HOME
 134 │           value: /opt/airflow
 135 └         image: apache/airflow:2.8.3
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'wait-for-airflow-migrations' of StatefulSet 'airflow-worker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 worker-sts.yaml:151-208
────────────────────────────────────────
 151 ┌       - args:
 152 │         - airflow
 153 │         - db
 154 │         - check-migrations
 155 │         - --migration-wait-timeout=60
 156 │         env:
 157 │         - name: AIRFLOW__CORE__FERNET_KEY
 158 │           valueFrom:
 159 └             secretKeyRef:
 ...   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'worker' of StatefulSet 'airflow-worker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 worker-sts.yaml:43-126
────────────────────────────────────────
  43 ┌       - args:
  44 │         - bash
  45 │         - -c
  46 │         - |-
  47 │           exec \
  48 │           airflow celery worker
  49 │         env:
  50 │         - name: DUMB_INIT_SETSID
  51 └           value: "0"
  ..   
────────────────────────────────────────


AVD-KSV-0015 (LOW): Container 'worker-log-groomer' of StatefulSet 'airflow-worker' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 worker-sts.yaml:127-148
────────────────────────────────────────
 127 ┌       - args:
 128 │         - bash
 129 │         - /clean-logs
 130 │         env:
 131 │         - name: AIRFLOW__LOG_RETENTION_DAYS
 132 │           value: "15"
 133 │         - name: AIRFLOW_HOME
 134 │           value: /opt/airflow
 135 └         image: apache/airflow:2.8.3
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'wait-for-airflow-migrations' of StatefulSet 'airflow-worker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 worker-sts.yaml:151-208
────────────────────────────────────────
 151 ┌       - args:
 152 │         - airflow
 153 │         - db
 154 │         - check-migrations
 155 │         - --migration-wait-timeout=60
 156 │         env:
 157 │         - name: AIRFLOW__CORE__FERNET_KEY
 158 │           valueFrom:
 159 └             secretKeyRef:
 ...   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'worker' of StatefulSet 'airflow-worker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 worker-sts.yaml:43-126
────────────────────────────────────────
  43 ┌       - args:
  44 │         - bash
  45 │         - -c
  46 │         - |-
  47 │           exec \
  48 │           airflow celery worker
  49 │         env:
  50 │         - name: DUMB_INIT_SETSID
  51 └           value: "0"
  ..   
────────────────────────────────────────


AVD-KSV-0016 (LOW): Container 'worker-log-groomer' of StatefulSet 'airflow-worker' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 worker-sts.yaml:127-148
────────────────────────────────────────
 127 ┌       - args:
 128 │         - bash
 129 │         - /clean-logs
 130 │         env:
 131 │         - name: AIRFLOW__LOG_RETENTION_DAYS
 132 │           value: "15"
 133 │         - name: AIRFLOW_HOME
 134 │           value: /opt/airflow
 135 └         image: apache/airflow:2.8.3
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'wait-for-airflow-migrations' of StatefulSet 'airflow-worker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 worker-sts.yaml:151-208
────────────────────────────────────────
 151 ┌       - args:
 152 │         - airflow
 153 │         - db
 154 │         - check-migrations
 155 │         - --migration-wait-timeout=60
 156 │         env:
 157 │         - name: AIRFLOW__CORE__FERNET_KEY
 158 │           valueFrom:
 159 └             secretKeyRef:
 ...   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'worker' of StatefulSet 'airflow-worker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 worker-sts.yaml:43-126
────────────────────────────────────────
  43 ┌       - args:
  44 │         - bash
  45 │         - -c
  46 │         - |-
  47 │           exec \
  48 │           airflow celery worker
  49 │         env:
  50 │         - name: DUMB_INIT_SETSID
  51 └           value: "0"
  ..   
────────────────────────────────────────


AVD-KSV-0018 (LOW): Container 'worker-log-groomer' of StatefulSet 'airflow-worker' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 worker-sts.yaml:127-148
────────────────────────────────────────
 127 ┌       - args:
 128 │         - bash
 129 │         - /clean-logs
 130 │         env:
 131 │         - name: AIRFLOW__LOG_RETENTION_DAYS
 132 │           value: "15"
 133 │         - name: AIRFLOW_HOME
 134 │           value: /opt/airflow
 135 └         image: apache/airflow:2.8.3
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'wait-for-airflow-migrations' of StatefulSet 'airflow-worker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 worker-sts.yaml:151-208
────────────────────────────────────────
 151 ┌       - args:
 152 │         - airflow
 153 │         - db
 154 │         - check-migrations
 155 │         - --migration-wait-timeout=60
 156 │         env:
 157 │         - name: AIRFLOW__CORE__FERNET_KEY
 158 │           valueFrom:
 159 └             secretKeyRef:
 ...   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'worker' of StatefulSet 'airflow-worker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 worker-sts.yaml:43-126
────────────────────────────────────────
  43 ┌       - args:
  44 │         - bash
  45 │         - -c
  46 │         - |-
  47 │           exec \
  48 │           airflow celery worker
  49 │         env:
  50 │         - name: DUMB_INIT_SETSID
  51 └           value: "0"
  ..   
────────────────────────────────────────


AVD-KSV-0021 (LOW): Container 'worker-log-groomer' of StatefulSet 'airflow-worker' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 worker-sts.yaml:127-148
────────────────────────────────────────
 127 ┌       - args:
 128 │         - bash
 129 │         - /clean-logs
 130 │         env:
 131 │         - name: AIRFLOW__LOG_RETENTION_DAYS
 132 │           value: "15"
 133 │         - name: AIRFLOW_HOME
 134 │           value: /opt/airflow
 135 └         image: apache/airflow:2.8.3
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 worker-sts.yaml:151-208
────────────────────────────────────────
 151 ┌       - args:
 152 │         - airflow
 153 │         - db
 154 │         - check-migrations
 155 │         - --migration-wait-timeout=60
 156 │         env:
 157 │         - name: AIRFLOW__CORE__FERNET_KEY
 158 │           valueFrom:
 159 └             secretKeyRef:
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 worker-sts.yaml:127-148
────────────────────────────────────────
 127 ┌       - args:
 128 │         - bash
 129 │         - /clean-logs
 130 │         env:
 131 │         - name: AIRFLOW__LOG_RETENTION_DAYS
 132 │           value: "15"
 133 │         - name: AIRFLOW_HOME
 134 │           value: /opt/airflow
 135 └         image: apache/airflow:2.8.3
 ...   
────────────────────────────────────────


AVD-KSV-0030 (LOW): Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 worker-sts.yaml:43-126
────────────────────────────────────────
  43 ┌       - args:
  44 │         - bash
  45 │         - -c
  46 │         - |-
  47 │           exec \
  48 │           airflow celery worker
  49 │         env:
  50 │         - name: DUMB_INIT_SETSID
  51 └           value: "0"
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "wait-for-airflow-migrations" of statefulset "airflow-worker" in "airflow" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 worker-sts.yaml:151-208
────────────────────────────────────────
 151 ┌       - args:
 152 │         - airflow
 153 │         - db
 154 │         - check-migrations
 155 │         - --migration-wait-timeout=60
 156 │         env:
 157 │         - name: AIRFLOW__CORE__FERNET_KEY
 158 │           valueFrom:
 159 └             secretKeyRef:
 ...   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "worker" of statefulset "airflow-worker" in "airflow" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 worker-sts.yaml:43-126
────────────────────────────────────────
  43 ┌       - args:
  44 │         - bash
  45 │         - -c
  46 │         - |-
  47 │           exec \
  48 │           airflow celery worker
  49 │         env:
  50 │         - name: DUMB_INIT_SETSID
  51 └           value: "0"
  ..   
────────────────────────────────────────


AVD-KSV-0104 (MEDIUM): container "worker-log-groomer" of statefulset "airflow-worker" in "airflow" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────
 worker-sts.yaml:127-148
────────────────────────────────────────
 127 ┌       - args:
 128 │         - bash
 129 │         - /clean-logs
 130 │         env:
 131 │         - name: AIRFLOW__LOG_RETENTION_DAYS
 132 │           value: "15"
 133 │         - name: AIRFLOW_HOME
 134 │           value: /opt/airflow
 135 └         image: apache/airflow:2.8.3
 ...   
────────────────────────────────────────


AVD-KSV-0116 (LOW): statefulset airflow-worker in airflow namespace should set spec.securityContext.runAsGroup, spec.securityContext.supplementalGroups[*] and spec.securityContext.fsGroup to integer greater than 0
════════════════════════════════════════
According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.

See https://avd.aquasec.com/misconfig/ksv116
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container wait-for-airflow-migrations in statefulset airflow-worker (namespace: airflow) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 worker-sts.yaml:151-208
────────────────────────────────────────
 151 ┌       - args:
 152 │         - airflow
 153 │         - db
 154 │         - check-migrations
 155 │         - --migration-wait-timeout=60
 156 │         env:
 157 │         - name: AIRFLOW__CORE__FERNET_KEY
 158 │           valueFrom:
 159 └             secretKeyRef:
 ...   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container worker in statefulset airflow-worker (namespace: airflow) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 worker-sts.yaml:43-126
────────────────────────────────────────
  43 ┌       - args:
  44 │         - bash
  45 │         - -c
  46 │         - |-
  47 │           exec \
  48 │           airflow celery worker
  49 │         env:
  50 │         - name: DUMB_INIT_SETSID
  51 └           value: "0"
  ..   
────────────────────────────────────────


AVD-KSV-0125 (MEDIUM): Container worker-log-groomer in statefulset airflow-worker (namespace: airflow) uses an image from an untrusted registry.
════════════════════════════════════════
Ensure that all containers use images only from trusted registry domains.

See https://avd.aquasec.com/misconfig/ksv0125
────────────────────────────────────────
 worker-sts.yaml:127-148
────────────────────────────────────────
 127 ┌       - args:
 128 │         - bash
 129 │         - /clean-logs
 130 │         env:
 131 │         - name: AIRFLOW__LOG_RETENTION_DAYS
 132 │           value: "15"
 133 │         - name: AIRFLOW_HOME
 134 │           value: /opt/airflow
 135 └         image: apache/airflow:2.8.3
 ...   
────────────────────────────────────────



write_checks_1.yaml (kubernetes)
================================
Tests: 107 (SUCCESSES: 106, FAILURES: 1)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 1, CRITICAL: 0)

AVD-KSV-0109 (HIGH): ConfigMap 'service-source' in 'write-checks' namespace stores secrets in key(s) or value(s) '{"    actor_token ", "    delegation_token ", "    impersonated_id_token "}'
════════════════════════════════════════
Storing secrets in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-0109
────────────────────────────────────────



wso2am-conf.yaml (kubernetes)
=============================
Tests: 107 (SUCCESSES: 105, FAILURES: 2)
Failures: 2 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 1, CRITICAL: 0)

AVD-KSV-01010 (MEDIUM): ConfigMap 'wso2am-single-node-am-conf' in 'apimdev' namespace stores sensitive contents in key(s) or value(s) '{"#ciphers ", "#client_registration_username ", "#default_reserved_username ", "#persistent_notifier.username ", "#username ", "username", "username "}'
════════════════════════════════════════
Storing sensitive content such as usernames and email addresses in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-01010
────────────────────────────────────────


AVD-KSV-0109 (HIGH): ConfigMap 'wso2am-single-node-am-conf' in 'apimdev' namespace stores secrets in key(s) or value(s) '{"#client_registration_password ", "#key_password ", "#keystore.password ", "#password ", "#persistent_notifier.password ", "auth_token ", "key_password ", "password", "password "}'
════════════════════════════════════════
Storing secrets in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-0109
────────────────────────────────────────


