##### FILE: conf_mysql.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to wp-projeto/ConfigMap/mysql-config:
apiVersion: v1
data:
  MYSQL_DATABASE: wordpress_db
  MYSQL_USER: user_wp
kind: ConfigMap
metadata:
  name: mysql-config
  namespace: wp-projeto

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conf_mysql1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to wp-projeto/ConfigMap/mysql-config:
apiVersion: v1
data:
  MYSQL_DATABASE: wordpress_db
  MYSQL_USER: user_wp
kind: ConfigMap
metadata:
  name: mysql-config
  namespace: wp-projeto

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: Config_2048.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/game-2048:
apiVersion: v1
kind: Namespace
metadata:
  name: game-2048
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/game-2048:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: game-2048
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/game-2048:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: game-2048
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/game-2048:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: game-2048
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/game-2048:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: game-2048
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: Config_2048_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to game-2048/Deployment/deployment-2048:
apiVersion: apps/v1
kind: Deployment
metadata:
  name: deployment-2048
  namespace: game-2048
spec:
  replicas: 5
  selector:
    matchLabels:
      app.kubernetes.io/name: app-2048
  template:
    metadata:
      labels:
        app.kubernetes.io/name: app-2048
    spec:
      containers:
      - image: public.ecr.aws/l6m2t8p7/docker-2048:latest
        imagePullPolicy: Always
        name: app-2048
        ports:
        - containerPort: 80

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource game-2048/Deployment/deployment-2048

skipped mutate policy add-safe-to-evict -> resource game-2048/Deployment/deployment-2048
policy disallow-latest-tag -> resource game-2048/Deployment/deployment-2048 failed:
1 - autogen-validate-image-tag validation failure: validation error: Using a mutable image tag e.g. 'latest' is not allowed. rule autogen-validate-image-tag failed at path /image/

policy drop-all-capabilities -> resource game-2048/Deployment/deployment-2048 failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource game-2048/Deployment/deployment-2048 failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-requests-limits -> resource game-2048/Deployment/deployment-2048 failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-pod-probes -> resource game-2048/Deployment/deployment-2048 failed:
1 - autogen-validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource game-2048/Deployment/deployment-2048 failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource game-2048/Deployment/deployment-2048 failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: Config_2048_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to game-2048/Service/service-2048:
apiVersion: v1
kind: Service
metadata:
  name: service-2048
  namespace: game-2048
spec:
  ports:
  - port: 80
    protocol: TCP
    targetPort: 80
  selector:
    app.kubernetes.io/name: app-2048
  type: NodePort

---


Mutation:
Mutation has been applied successfully.policy restrict-nodeport -> resource game-2048/Service/service-2048 failed:
1 - validate-nodeport validation error: Services of type NodePort are not allowed. rule validate-nodeport failed at path /spec/type/


pass: 1, fail: 1, warn: 0, error: 0, skip: 0 

##### FILE: Config_2048_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to game-2048/Ingress/ingress-2048:
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
  name: ingress-2048
  namespace: game-2048
spec:
  ingressClassName: alb
  rules:
  - http:
      paths:
      - backend:
          service:
            name: service-2048
            port:
              number: 80
        path: /
        pathType: Prefix

---


Mutation:
Mutation has been applied successfully.policy disallow-empty-ingress-host -> resource game-2048/Ingress/ingress-2048 failed:
1 - disallow-empty-ingress-host The Ingress host name must be defined, not empty.


pass: 0, fail: 1, warn: 0, error: 0, skip: 0 

##### FILE: config_allow_secret_types.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/admission-policies-secrets-store-sync-controller-allow-config:
apiVersion: v1
data:
  controllerName: secrets-store-sync-controller
  controllerNamespace: secrets-store-sync-controller
  secretTypeBasicAuth: kubernetes.io/basic-auth
  secretTypeBootstrapToken: bootstrap.kubernetes.io/token
  secretTypeDockerCfg: kubernetes.io/dockercfg
  secretTypeDockerConfigJson: kubernetes.io/dockerconfigjson
  secretTypeOpaque: Opaque
  secretTypeSSHAuth: kubernetes.io/ssh-auth
  secretTypeTLS: kubernetes.io/tls
kind: ConfigMap
metadata:
  name: admission-policies-secrets-store-sync-controller-allow-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_deny_secret_types.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/admission-policies-secrets-store-sync-controller-deny-config:
apiVersion: v1
data:
  controllerName: secrets-store-sync-controller
  controllerNamespace: secrets-store-sync-controller
  secretTypeServiceAccountToken: kubernetes.io/service-account-token
kind: ConfigMap
metadata:
  name: admission-policies-secrets-store-sync-controller-deny-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_example.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/config:
apiVersion: v1
data:
  chat_id: channel id
  token: bot token
kind: ConfigMap
metadata:
  name: config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_manager_deployment.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/config-manager-server:
apiVersion: apps/v1
kind: Deployment
metadata:
  name: config-manager-server
  namespace: default
spec:
  selector:
    matchLabels:
      name: config-manager-server
  template:
    metadata:
      labels:
        name: config-manager-server
    spec:
      containers:
      - env:
        - name: PL_JWT_SIGNING_KEY
          valueFrom:
            secretKeyRef:
              key: jwt-signing-key
              name: cloud-auth-secrets
        - name: PL_ARTIFACT_TRACKER_SERVICE
          valueFrom:
            configMapKeyRef:
              key: PL_ARTIFACT_TRACKER_SERVICE
              name: pl-service-config
        - name: PL_VZMGR_SERVICE
          valueFrom:
            configMapKeyRef:
              key: PL_VZMGR_SERVICE
              name: pl-service-config
        - name: PL_PROD_SENTRY
          valueFrom:
            configMapKeyRef:
              key: PL_PROD_SENTRY
              name: pl-sentry-dsn-config
        - name: PL_DEV_SENTRY
          valueFrom:
            configMapKeyRef:
              key: PL_DEV_SENTRY
              name: pl-sentry-dsn-config
        - name: PL_OPERATOR_SENTRY
          valueFrom:
            configMapKeyRef:
              key: PL_OPERATOR_SENTRY
              name: pl-sentry-dsn-config
              optional: true
        - name: PL_LD_SDK_KEY
          valueFrom:
            configMapKeyRef:
              key: PL_LD_SDK_KEY
              name: pl-ld-config
              optional: true
        envFrom:
        - configMapRef:
            name: pl-tls-config
        - configMapRef:
            name: pl-domain-config
        image: cloud-config_manager_server_image
        imagePullPolicy: IfNotPresent
        livenessProbe:
          httpGet:
            path: /healthz
            port: 50500
            scheme: HTTPS
        name: config-manager-server
        ports:
        - containerPort: 50500
          name: http2
        - containerPort: 50501
          name: metrics-http
        readinessProbe:
          httpGet:
            path: /healthz
            port: 50500
            scheme: HTTPS
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          runAsNonRoot: true
          runAsUser: 10100
          seccompProfile:
            type: RuntimeDefault
        volumeMounts:
        - mountPath: /certs
          name: certs
      securityContext:
        runAsNonRoot: true
        runAsUser: 10100
        seccompProfile:
          type: RuntimeDefault
      volumes:
      - name: certs
        secret:
          secretName: service-tls-certs

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/config-manager-server

skipped mutate policy add-safe-to-evict -> resource default/Deployment/config-manager-server
policy disallow-default-namespace -> resource default/Deployment/config-manager-server failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Deployment/config-manager-server failed:
1 - autogen-require-image-tag validation failure: validation error: An image tag is required. rule autogen-require-image-tag failed at path /image/

policy drop-cap-net-raw -> resource default/Deployment/config-manager-server failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/config-manager-server failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/config-manager-server failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/config-manager-server failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/readOnlyRootFilesystem/

policy restrict-image-registries -> resource default/Deployment/config-manager-server failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: config_manager_deployment1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/config-manager-server:
apiVersion: apps/v1
kind: Deployment
metadata:
  name: config-manager-server
  namespace: default
spec:
  selector:
    matchLabels:
      name: config-manager-server
  template:
    metadata:
      labels:
        name: config-manager-server
    spec:
      containers:
      - env:
        - name: PL_JWT_SIGNING_KEY
          valueFrom:
            secretKeyRef:
              key: jwt-signing-key
              name: cloud-auth-secrets
        - name: PL_ARTIFACT_TRACKER_SERVICE
          valueFrom:
            configMapKeyRef:
              key: PL_ARTIFACT_TRACKER_SERVICE
              name: pl-service-config
        - name: PL_VZMGR_SERVICE
          valueFrom:
            configMapKeyRef:
              key: PL_VZMGR_SERVICE
              name: pl-service-config
        - name: PL_PROD_SENTRY
          valueFrom:
            configMapKeyRef:
              key: PL_PROD_SENTRY
              name: pl-sentry-dsn-config
        - name: PL_DEV_SENTRY
          valueFrom:
            configMapKeyRef:
              key: PL_DEV_SENTRY
              name: pl-sentry-dsn-config
        - name: PL_OPERATOR_SENTRY
          valueFrom:
            configMapKeyRef:
              key: PL_OPERATOR_SENTRY
              name: pl-sentry-dsn-config
              optional: true
        - name: PL_LD_SDK_KEY
          valueFrom:
            configMapKeyRef:
              key: PL_LD_SDK_KEY
              name: pl-ld-config
              optional: true
        envFrom:
        - configMapRef:
            name: pl-tls-config
        - configMapRef:
            name: pl-domain-config
        image: cloud-config_manager_server_image
        imagePullPolicy: IfNotPresent
        livenessProbe:
          httpGet:
            path: /healthz
            port: 50500
            scheme: HTTPS
        name: config-manager-server
        ports:
        - containerPort: 50500
          name: http2
        - containerPort: 50501
          name: metrics-http
        readinessProbe:
          httpGet:
            path: /healthz
            port: 50500
            scheme: HTTPS
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          runAsNonRoot: true
          runAsUser: 10100
          seccompProfile:
            type: RuntimeDefault
        volumeMounts:
        - mountPath: /certs
          name: certs
      securityContext:
        runAsNonRoot: true
        runAsUser: 10100
        seccompProfile:
          type: RuntimeDefault
      volumes:
      - name: certs
        secret:
          secretName: service-tls-certs

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/config-manager-server

skipped mutate policy add-safe-to-evict -> resource default/Deployment/config-manager-server
policy disallow-default-namespace -> resource default/Deployment/config-manager-server failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Deployment/config-manager-server failed:
1 - autogen-require-image-tag validation failure: validation error: An image tag is required. rule autogen-require-image-tag failed at path /image/

policy drop-cap-net-raw -> resource default/Deployment/config-manager-server failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/config-manager-server failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/config-manager-server failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/config-manager-server failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/readOnlyRootFilesystem/

policy restrict-image-registries -> resource default/Deployment/config-manager-server failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: config_manager_service.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/config-manager-service:
apiVersion: v1
kind: Service
metadata:
  name: config-manager-service
  namespace: default
spec:
  clusterIP: None
  ports:
  - name: tcp-http2
    port: 50500
    protocol: TCP
    targetPort: 50500
  selector:
    name: config-manager-server
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_manager_service1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/config-manager-service:
apiVersion: v1
kind: Service
metadata:
  name: config-manager-service
  namespace: default
spec:
  clusterIP: None
  ports:
  - name: tcp-http2
    port: 50500
    protocol: TCP
    targetPort: 50500
  selector:
    name: config-manager-server
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongodb-configmap:
apiVersion: v1
data:
  database_url: mongodb-service
kind: ConfigMap
metadata:
  name: mongodb-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map_aws.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/aws-config:
apiVersion: v1
data:
  config: |
    [default]
    region = us-east-1
  syncs3.sh: "export AWS_CONFIG_FILE=\"/root/.aws/config\" #change it as per user\nexport
    AWS_ACCESS_KEY_ID=***** #please provide access id \nexport AWS_SECRET_ACCESS_KEY=*****
    #please provide secret key\naws s3 sync /var/log/nginx s3://your_bucket_name\n"
kind: ConfigMap
metadata:
  name: aws-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map_aws1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/aws-config:
apiVersion: v1
data:
  config: |
    [default]
    region = us-east-1
  syncs3.sh: "export AWS_CONFIG_FILE=\"/root/.aws/config\" #change it as per user\nexport
    AWS_ACCESS_KEY_ID=***** #please provide access id \nexport AWS_SECRET_ACCESS_KEY=*****
    #please provide secret key\naws s3 sync /var/log/nginx s3://your_bucket_name\n"
kind: ConfigMap
metadata:
  name: aws-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map_aws2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/aws-config:
apiVersion: v1
data:
  config: |
    [default]
    region = us-east-1
  syncs3.sh: "export AWS_CONFIG_FILE=\"/root/.aws/config\" #change it as per user\nexport
    AWS_ACCESS_KEY_ID=***** #please provide access id \nexport AWS_SECRET_ACCESS_KEY=*****
    #please provide secret key\naws s3 sync /var/log/nginx s3://your_bucket_name\n"
kind: ConfigMap
metadata:
  name: aws-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map_aws3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/aws-config:
apiVersion: v1
data:
  config: |
    [default]
    region = us-east-1
  syncs3.sh: "export AWS_CONFIG_FILE=\"/root/.aws/config\" #change it as per user\nexport
    AWS_ACCESS_KEY_ID=***** #please provide access id \nexport AWS_SECRET_ACCESS_KEY=*****
    #please provide secret key\naws s3 sync /var/log/nginx s3://your_bucket_name\n"
kind: ConfigMap
metadata:
  name: aws-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map_nginx.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  default.conf: "server {\n    listen 80 default_server;\n    listen [::]:80 default_server
    ipv6only=on;\n    listen 443 ssl;\n\n    root /usr/share/nginx/html;\n    index
    index.html;\n\nserver_name localhost;\nssl_certificate /etc/nginx/ssl/nginx.crt;\nssl_certificate_key
    /etc/nginx/ssl/nginx.key; \nssl_session_timeout 1d;\nssl_session_cache shared:SSL:50m;\nssl_session_tickets
    off;\n# modern configuration. tweak to your needs.\nssl_protocols TLSv1.2;\nssl_ciphers
    'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';\nssl_prefer_server_ciphers
    on; \n# HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)\nadd_header
    Strict-Transport-Security max-age=15768000;\n# OCSP Stapling ---\n# fetch OCSP
    records from URL in ssl_certificate and cache them\nssl_stapling on;\nssl_stapling_verify
    on;\nlocation / {\n        try_files $uri $uri/ =404;\n    }\n}\n"
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map_nginx1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  default.conf: "server {\n    listen 80 default_server;\n    listen [::]:80 default_server
    ipv6only=on;\n    listen 443 ssl;\n\n    root /usr/share/nginx/html;\n    index
    index.html;\n\nserver_name localhost;\nssl_certificate /etc/nginx/ssl/nginx.crt;\nssl_certificate_key
    /etc/nginx/ssl/nginx.key; \nssl_session_timeout 1d;\nssl_session_cache shared:SSL:50m;\nssl_session_tickets
    off;\n# modern configuration. tweak to your needs.\nssl_protocols TLSv1.2;\nssl_ciphers
    'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';\nssl_prefer_server_ciphers
    on; \n# HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)\nadd_header
    Strict-Transport-Security max-age=15768000;\n# OCSP Stapling ---\n# fetch OCSP
    records from URL in ssl_certificate and cache them\nssl_stapling on;\nssl_stapling_verify
    on;\nlocation / {\n        try_files $uri $uri/ =404;\n    }\n}\n"
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map_nginx2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  default.conf: "server {\n    listen 80 default_server;\n    listen [::]:80 default_server
    ipv6only=on;\n    listen 443 ssl;\n\n    root /usr/share/nginx/html;\n    index
    index.html;\n\nserver_name localhost;\nssl_certificate /etc/nginx/ssl/nginx.crt;\nssl_certificate_key
    /etc/nginx/ssl/nginx.key; \nssl_session_timeout 1d;\nssl_session_cache shared:SSL:50m;\nssl_session_tickets
    off;\n# modern configuration. tweak to your needs.\nssl_protocols TLSv1.2;\nssl_ciphers
    'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';\nssl_prefer_server_ciphers
    on; \n# HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)\nadd_header
    Strict-Transport-Security max-age=15768000;\n# OCSP Stapling ---\n# fetch OCSP
    records from URL in ssl_certificate and cache them\nssl_stapling on;\nssl_stapling_verify
    on;\nlocation / {\n        try_files $uri $uri/ =404;\n    }\n}\n"
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map_nginx3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  default.conf: "server {\n    listen 80 default_server;\n    listen [::]:80 default_server
    ipv6only=on;\n    listen 443 ssl;\n\n    root /usr/share/nginx/html;\n    index
    index.html;\n\nserver_name localhost;\nssl_certificate /etc/nginx/ssl/nginx.crt;\nssl_certificate_key
    /etc/nginx/ssl/nginx.key; \nssl_session_timeout 1d;\nssl_session_cache shared:SSL:50m;\nssl_session_tickets
    off;\n# modern configuration. tweak to your needs.\nssl_protocols TLSv1.2;\nssl_ciphers
    'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';\nssl_prefer_server_ciphers
    on; \n# HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)\nadd_header
    Strict-Transport-Security max-age=15768000;\n# OCSP Stapling ---\n# fetch OCSP
    records from URL in ssl_certificate and cache them\nssl_stapling on;\nssl_stapling_verify
    on;\nlocation / {\n        try_files $uri $uri/ =404;\n    }\n}\n"
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map_pod.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/simple:
apiVersion: v1
kind: Pod
metadata:
  labels:
    name: simple
  name: simple
  namespace: default
spec:
  containers:
  - envFrom:
    - configMapRef:
        name: app-config
    image: simple-webapp-color
    name: simple
    ports":
    - containerPort: 8080

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/simple

skipped mutate policy add-safe-to-evict -> resource default/Pod/simple
policy disallow-default-namespace -> resource default/Pod/simple failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/simple failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/simple failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/simple failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/simple failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/simple failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/simple failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/simple failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/simple failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: config_map_pod_manifest.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/sassational-configmap-pod:
apiVersion: v1
kind: Pod
metadata:
  labels:
    app: nginx
  name: sassational-configmap-pod
  namespace: default
spec:
  containers:
  - image: nginx
    name: sassational-container
    ports:
    - containerPort: 80
    - containerPort: 443
    volumeMounts:
    - mountPath: /etc/nginx/nginx.conf
      name: nginx-config-volume
      subPath: nginx.conf
    - mountPath: /etc/nginx/tls
      name: nginx-tls
  volumes:
  - configMap:
      name: nginx-config
    name: nginx-config-volume
  - name: nginx-tls
    secret:
      items:
      - key: tls.crt
        path: certificado.crt
      - key: tls.key
        path: chave-privada.key
      secretName: sassational-web-tls-secret

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/sassational-configmap-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/sassational-configmap-pod
policy disallow-default-namespace -> resource default/Pod/sassational-configmap-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/sassational-configmap-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/sassational-configmap-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/sassational-configmap-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/sassational-configmap-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/sassational-configmap-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/sassational-configmap-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/sassational-configmap-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/sassational-configmap-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: config_map_pod1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/simple:
apiVersion: v1
kind: Pod
metadata:
  labels:
    name: simple
  name: simple
  namespace: default
spec:
  containers:
  - envFrom:
    - configMapRef:
        name: app-config
    image: simple-webapp-color
    name: simple
    ports":
    - containerPort: 8080

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/simple

skipped mutate policy add-safe-to-evict -> resource default/Pod/simple
policy disallow-default-namespace -> resource default/Pod/simple failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/simple failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/simple failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/simple failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/simple failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/simple failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/simple failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/simple failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/simple failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: config_map1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/udemy-k8s-cm:
apiVersion: v1
data:
  SPRING_PROFILES_ACTIVE: production-microservice
  spring.profiles.active: production-microservice
kind: ConfigMap
metadata:
  name: udemy-k8s-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map10.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/config-map:
apiVersion: v1
data:
  PASSWORD: root
  POSTGRES_DB: trello
  POSTGRES_PASSWORD: root
  POSTGRES_USER: postgres
  REACT_APP_FRONTEND_URL: http://127.0.0.1:52860
  SPRING_URL: jdbc:postgresql://postgres-service:5432/trello
  USER_NAME: postgres
kind: ConfigMap
metadata:
  name: config-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map11.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-configmap:
apiVersion: v1
data:
  mysql_binlog_format.cnf: |
    [mysqld]
    binlog-format=mixed
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map13.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nbgrader-config-global:
apiVersion: v1
data:
  nbgrader_config.py: |
    import os
    from nbgrader.server_extensions.assignment_list.handlers import AssignmentList
    from nbgrader.auth import Authenticator, JupyterHubAuthPlugin

    c = get_config()
    c.Exchange.path_includes_course = True
    c.Exchange.root = "/mnt/exchange"
    c.Authenticator.plugin_class = JupyterHubAuthPlugin

    # Use the custom k8s exchange
    c.ExchangeFactory.collect = 'nbgrader_k8s_exchange.plugin.ExchangeCollect'
    c.ExchangeFactory.exchange = 'nbgrader_k8s_exchange.plugin.Exchange'
    c.ExchangeFactory.fetch_assignment = 'nbgrader_k8s_exchange.plugin.ExchangeFetchAssignment'
    c.ExchangeFactory.fetch_feedback = 'nbgrader_k8s_exchange.plugin.ExchangeFetchFeedback'
    c.ExchangeFactory.list = 'nbgrader_k8s_exchange.plugin.ExchangeList'
    c.ExchangeFactory.release_assignment = 'nbgrader_k8s_exchange.plugin.ExchangeReleaseAssignment'
    c.ExchangeFactory.release_feedback = 'nbgrader_k8s_exchange.plugin.ExchangeReleaseFeedback'
    c.ExchangeFactory.submit = 'nbgrader_k8s_exchange.plugin.ExchangeSubmit'

    # List courses for the student even if there are no assignments
    def list_courses(self):
        auth = Authenticator(config=c)

        return {
          "success": True,
          "value":  auth.get_student_courses(os.environ['JUPYTERHUB_USER'])
        }

    AssignmentList.list_courses = list_courses
kind: ConfigMap
metadata:
  name: nbgrader-config-global
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map15.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to argocd/ConfigMap/argocd-cmd-params-cm:
apiVersion: v1
data:
  server.insecure: "true"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: argocd-cmd-params-cm
    app.kubernetes.io/part-of: argocd
  name: argocd-cmd-params-cm
  namespace: argocd

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/cluster-app-config-map:
apiVersion: v1
data:
  headless_service_dns: cluster-app-headless-service.default.svc.cluster.local
  phx_host: localhost
kind: ConfigMap
metadata:
  name: cluster-app-config-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongodb-configmap:
apiVersion: v1
data:
  database_url: mongodb-service
kind: ConfigMap
metadata:
  name: mongodb-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/udemy-k8s-cm:
apiVersion: v1
data:
  SPRING_PROFILES_ACTIVE: production-microservice
  spring.profiles.active: production-microservice
kind: ConfigMap
metadata:
  name: udemy-k8s-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/cluster-app-config-map:
apiVersion: v1
data:
  headless_service_dns: cluster-app-headless-service.default.svc.cluster.local
  phx_host: localhost
kind: ConfigMap
metadata:
  name: cluster-app-config-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map6.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-configmap:
apiVersion: v1
data:
  mysql_binlog_format.cnf: |
    [mysqld]
    binlog-format=mixed
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map7.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-configmap:
apiVersion: v1
data:
  mysql_binlog_format.cnf: |
    [mysqld]
    binlog-format=mixed
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map8.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to kube-system/ConfigMap/descheduler-policy-configmap:
apiVersion: v1
data:
  policy.yaml: |
    apiVersion: "descheduler/v1alpha2"
    kind: "DeschedulerPolicy"
    profiles:
      - name: ProfileName
        pluginConfig:
        - name: "DefaultEvictor"
        - name: "RemovePodsViolatingInterPodAntiAffinity"
        - name: "RemoveDuplicates"
        - name: "LowNodeUtilization"
          args:
            thresholds:
              "cpu" : 20
              "memory": 20
            targetThresholds:
              "cpu" : 20
              "memory": 20
            useDeviationThresholds: true
        - name: "RemoveFailedPods"
          args:
            reasons:
            - "NodeAffinity"
            exitCodes:
            - 1
            includingInitContainers: true
            excludeOwnerKinds:
            - "Job"
            minPodLifetimeSeconds: 300
        plugins:
          balance:
            enabled:
              - "LowNodeUtilization"
              - "RemoveDuplicates"
          deschedule:
            enabled:
              - "RemovePodsViolatingInterPodAntiAffinity"
kind: ConfigMap
metadata:
  name: descheduler-policy-configmap
  namespace: kube-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_map9.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to kube-system/ConfigMap/coredns:
apiVersion: v1
data:
  Corefile: |
    .:53 {
        log
        errors
        health {
           lameduck 5s
        }
        ready
        kubernetes cluster.local in-addr.arpa ip6.arpa {
           pods insecure
           fallthrough in-addr.arpa ip6.arpa
           ttl 30
        }
        prometheus :9153
        hosts {
           192.168.65.254 host.minikube.internal
           192.168.49.2 kubia.example.com # Add this line for kubia.example.com
           fallthrough
        }
        forward . /etc/resolv.conf {
           max_concurrent 1000
        }
        cache 30
        loop
        reload
        loadbalance
    }
kind: ConfigMap
metadata:
  name: coredns
  namespace: kube-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_patch.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nats-config:
apiVersion: v1
data:
  nats.conf: |
    pid_file: "/var/run/nats/nats.pid"
    http: 8222

    tls {
      ca_file: "/etc/nats-server-tls-certs/ca.crt",
      cert_file: "/etc/nats-server-tls-certs/server.crt",
      key_file: "/etc/nats-server-tls-certs/server.key",
      timeout: 3
    }

    server_name: $POD_NAME
    jetstream {
      store_dir: /data/jetstream
    }

    cluster {
      name: pl-nats
      port: 6222
      routes [
        nats://pl-nats-0.pl-nats:6222
        nats://pl-nats-1.pl-nats:6222
        nats://pl-nats-2.pl-nats:6222
      ]

      tls {
        ca_file: "/etc/nats-server-tls-certs/ca.crt",
        cert_file: "/etc/nats-server-tls-certs/server.crt",
        key_file: "/etc/nats-server-tls-certs/server.key",
        timeout: 3
      }

      advertise: $CLUSTER_ADVERTISE
      connect_retries: 30
    }
kind: ConfigMap
metadata:
  name: nats-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_patch1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nats-config:
apiVersion: v1
data:
  nats.conf: |
    pid_file: "/var/run/nats/nats.pid"
    http: 8222

    tls {
      ca_file: "/etc/nats-server-tls-certs/ca.crt",
      cert_file: "/etc/nats-server-tls-certs/server.crt",
      key_file: "/etc/nats-server-tls-certs/server.key",
      timeout: 3
    }

    server_name: $POD_NAME
    jetstream {
      store_dir: /data/jetstream
    }

    cluster {
      name: pl-nats
      port: 6222
      routes [
        nats://pl-nats-0.pl-nats:6222
        nats://pl-nats-1.pl-nats:6222
        nats://pl-nats-2.pl-nats:6222
      ]

      tls {
        ca_file: "/etc/nats-server-tls-certs/ca.crt",
        cert_file: "/etc/nats-server-tls-certs/server.crt",
        key_file: "/etc/nats-server-tls-certs/server.key",
        timeout: 3
      }

      advertise: $CLUSTER_ADVERTISE
      connect_retries: 30
    }
kind: ConfigMap
metadata:
  name: nats-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_patch2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nats-config:
apiVersion: v1
data:
  nats.conf: |
    pid_file: "/var/run/nats/nats.pid"
    http: 8222

    tls {
      ca_file: "/etc/nats-server-tls-certs/ca.crt",
      cert_file: "/etc/nats-server-tls-certs/server.crt",
      key_file: "/etc/nats-server-tls-certs/server.key",
      timeout: 3
    }

    server_name: $POD_NAME
    jetstream {
      store_dir: /data/jetstream
    }

    cluster {
      name: pl-nats
      port: 6222
      routes [
        nats://pl-nats-0.pl-nats:6222
        nats://pl-nats-1.pl-nats:6222
        nats://pl-nats-2.pl-nats:6222
      ]

      tls {
        ca_file: "/etc/nats-server-tls-certs/ca.crt",
        cert_file: "/etc/nats-server-tls-certs/server.crt",
        key_file: "/etc/nats-server-tls-certs/server.key",
        timeout: 3
      }

      advertise: $CLUSTER_ADVERTISE
      connect_retries: 30
    }
kind: ConfigMap
metadata:
  name: nats-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_patch3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nats-config:
apiVersion: v1
data:
  nats.conf: |
    pid_file: "/var/run/nats/nats.pid"
    http: 8222

    tls {
      ca_file: "/etc/nats-server-tls-certs/ca.crt",
      cert_file: "/etc/nats-server-tls-certs/server.crt",
      key_file: "/etc/nats-server-tls-certs/server.key",
      timeout: 3
    }

    server_name: $POD_NAME
    jetstream {
      store_dir: /data/jetstream
    }

    cluster {
      name: pl-nats
      port: 6222
      routes [
        nats://pl-nats-0.pl-nats:6222
        nats://pl-nats-1.pl-nats:6222
        nats://pl-nats-2.pl-nats:6222
      ]

      tls {
        ca_file: "/etc/nats-server-tls-certs/ca.crt",
        cert_file: "/etc/nats-server-tls-certs/server.crt",
        key_file: "/etc/nats-server-tls-certs/server.key",
        timeout: 3
      }

      advertise: $CLUSTER_ADVERTISE
      connect_retries: 30
    }
kind: ConfigMap
metadata:
  name: nats-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_secret.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to monitoring/Secret/grafana-config:
apiVersion: v1
kind: Secret
metadata:
  labels:
    app.kubernetes.io/component: grafana
    app.kubernetes.io/name: grafana
  name: grafana-config
  namespace: monitoring
stringData:
  grafana.ini: |
    [date_formats]
    default_timezone = UTC
    [server]
    root_url: /grafana/
    serve_from_sub_path: true
type: Opaque

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: config_ssc.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/admission-policies-secret-sync-controller-config:
apiVersion: v1
data:
  controllerName: secret-sync-controller
  controllerNamespace: secrets-store-sync-controller
  controllerServiceAccountName: secrets-store-sync-controller-sa
  labelKey: secrets-store-sync-controller.k8s.io/managed
  labelValue: ""
  tokenAudience1: api://TokenAudienceExample
kind: ConfigMap
metadata:
  name: admission-policies-secret-sync-controller-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_11.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/jsl:
apiVersion: v1
data:
  ww.config: |
    superman: flight
    batman: smartness
kind: ConfigMap
metadata:
  name: jsl
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_12.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/manifest-example:
apiVersion: v1
data:
  city: Ann Arbor
  state: Michigan
kind: ConfigMap
metadata:
  name: manifest-example
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_13.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/application-configs:
apiVersion: v1
data:
  app.type: test-application
  app.ui: web
  app.value: "45000"
kind: ConfigMap
metadata:
  name: application-configs
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_14.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  special.how: very
  special.type: charm
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_15.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  special.how: very
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_15_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/env-config:
apiVersion: v1
data:
  log_level: INFO
kind: ConfigMap
metadata:
  name: env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_16.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to metallb-system/ConfigMap/config:
apiVersion: v1
data:
  config: |
    address-pools:
    - name: default
      protocol: layer2
      addresses:
      - <ip-address-range-start>-<ip-address-range-stop>
kind: ConfigMap
metadata:
  name: config
  namespace: metallb-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  DB_Host: mysql
  DB_Password: paswrd
  DB_User: root
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_21.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/avengers:
apiVersion: v1
data:
  vision: wanda
kind: ConfigMap
metadata:
  name: avengers
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_22.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-configmap:
apiVersion: v1
data:
  app-config: City = Hamburg State = Hamburg Country = Germany
kind: ConfigMap
metadata:
  name: my-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_23.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/application-log-configs:
apiVersion: v1
data:
  log_level: WARNING
  log_type: TEXT
kind: ConfigMap
metadata:
  name: application-log-configs
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_24.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  nginx.conf: |-
    events {
    }
    http {
      server {
        listen 80 default_server;
        listen [::]:80 default_server;

        index    index.html index.htm index.php;

        root /var/www/html;
        server_name _;
        location / {
          try_files $uri $uri/ =404;
        }
        location ~ \.php$ {
          include fastcgi_params;
          fastcgi_param REQUEST_METHOD $request_method;
          fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
          fastcgi_pass 127.0.0.1:9000;
        }
      }
    }
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_25.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  SPECIAL_LEVEL: very
  SPECIAL_TYPE: charm
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_26.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to metallb-system/ConfigMap/config:
apiVersion: v1
data:
  config: |
    address-pools:
    - name: my-ip-space
      protocol: layer2
      addresses:
      - 192.168.1.240-192.168.1.250
kind: ConfigMap
metadata:
  name: config
  namespace: metallb-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to kube-system/ConfigMap/coredns:
apiVersion: v1
data:
  Corefile: |
    .:53 {
        errors
        health {
            lameduck 5s
        }
        ready
        kubernetes cluster.local in-addr.arpa ip6.arpa {
            pods insecure
            fallthrough in-addr.arpa ip6.arpa
            ttl 30
        }
        prometheus :9153
        forward . /etc/resolv.conf
        cache 30
        loop
        reload
        loadbalance
    }
kind: ConfigMap
metadata:
  name: coredns
  namespace: kube-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_31.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-configmap:
apiVersion: v1
data:
  City: Hamburg
  Country: Germany
  State: Hamburg
kind: ConfigMap
metadata:
  name: my-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_32.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  app.properties: |
    environment=production
    logging=INFO
    logs_path=$APP_HOME/logs/
    parllel_jobs=3
    wait_time=30sec
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to metallb-system/ConfigMap/config:
apiVersion: v1
data:
  config: |
    address-pools:
    - name: default
      protocol: layer2
      addresses:
      - 192.168.1.240-192.168.1.250
kind: ConfigMap
metadata:
  name: config
  namespace: metallb-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/nginx-configuration:
apiVersion: v1
data:
  use-proxy-protocol: "true"
kind: ConfigMap
metadata:
  labels:
    app: ingress-nginx
  name: nginx-configuration
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap_7.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/sonar-config:
apiVersion: v1
data:
  url: jdbc:postgresql://postgres:5432/postgres
kind: ConfigMap
metadata:
  labels:
    app: postgres
  name: sonar-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_aws_config.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-aws-config:
apiVersion: v1
data:
  aws_cli: "on"
  aws_output: json
  aws_region: eu-west-3
kind: ConfigMap
metadata:
  name: configmap-aws-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_db.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-servicedb:
apiVersion: v1
data:
  config_servicedb.cfg: |
    ID_ACCOUNT_AWS="ID_ACCOUNT_AWS"
    GROUP_NAME="SensorsManagerTeam"
    SESSION_NAME="AssumeRoleSession"
  flaskenv: development
kind: ConfigMap
metadata:
  name: configmap-servicedb
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_endpoint_routing.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-gateway-endpoint-routing:
apiVersion: v1
data:
  is_it_prime__v1: http://ksvc-endpoint-is-it-prime.default.svc.cluster.local/is_it_prime
  postgresql__query__v1: http://ksvc-endpoint-postgresql-interface.default.svc.cluster.local/query
kind: ConfigMap
metadata:
  name: configmap-gateway-endpoint-routing
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_env.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/goserver-env:
apiVersion: v1
data:
  AGE: "22"
  NAME: John DOE
kind: ConfigMap
metadata:
  name: goserver-env
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_env_pod.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    env:
    - name: SPECIAL_LEVEL_KEY
      valueFrom:
        configMapKeyRef:
          key: special.how
          name: special-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  special.how: very
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_env_pod_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/env-config:
apiVersion: v1
data:
  log_level: INFO
kind: ConfigMap
metadata:
  name: env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_env_pod_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    env:
    - name: SPECIAL_LEVEL_KEY
      valueFrom:
        configMapKeyRef:
          key: special.how
          name: special-config
    - name: LOG_LEVEL
      valueFrom:
        configMapKeyRef:
          key: log_level
          name: env-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    envFrom:
    - configMapRef:
        name: special-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    env:
    - name: SPECIAL_LEVEL_KEY
      valueFrom:
        configMapKeyRef:
          key: special.how
          name: special-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod1_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  special.how: very
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_env_pod1_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/env-config:
apiVersion: v1
data:
  log_level: INFO
kind: ConfigMap
metadata:
  name: env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_env_pod1_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    env:
    - name: SPECIAL_LEVEL_KEY
      valueFrom:
        configMapKeyRef:
          key: special.how
          name: special-config
    - name: LOG_LEVEL
      valueFrom:
        configMapKeyRef:
          key: log_level
          name: env-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod1_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    envFrom:
    - configMapRef:
        name: special-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    env:
    - name: SPECIAL_LEVEL_KEY
      valueFrom:
        configMapKeyRef:
          key: special.how
          name: special-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod2_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  special.how: very
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_env_pod2_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/env-config:
apiVersion: v1
data:
  log_level: INFO
kind: ConfigMap
metadata:
  name: env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_env_pod2_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    env:
    - name: SPECIAL_LEVEL_KEY
      valueFrom:
        configMapKeyRef:
          key: special.how
          name: special-config
    - name: LOG_LEVEL
      valueFrom:
        configMapKeyRef:
          key: log_level
          name: env-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod2_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    envFrom:
    - configMapRef:
        name: special-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    env:
    - name: SPECIAL_LEVEL_KEY
      valueFrom:
        configMapKeyRef:
          key: special.how
          name: special-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod3_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  special.how: very
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_env_pod3_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/env-config:
apiVersion: v1
data:
  log_level: INFO
kind: ConfigMap
metadata:
  name: env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_env_pod3_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    env:
    - name: SPECIAL_LEVEL_KEY
      valueFrom:
        configMapKeyRef:
          key: special.how
          name: special-config
    - name: LOG_LEVEL
      valueFrom:
        configMapKeyRef:
          key: log_level
          name: env-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_env_pod3_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    envFrom:
    - configMapRef:
        name: special-config
    image: k8s.gcr.io/busybox
    name: test-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_family.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-family:
apiVersion: v1
data:
  members: m1, m2, m3, m4
kind: ConfigMap
metadata:
  name: configmap-family
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_gateway.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-gateway:
apiVersion: v1
data:
  config_gateway.cfg: |
    HOST_S3 = "servicebucket-svc"
    PORT_S3 = "82"
    HOST_DB = "servicedb-svc"
    PORT_DB = "83"
    BUCKET_TEMPLATE="sensor-device-template"
    BUCKET_DATA_SHEET="sensors-data-sheet"
  flaskenv: development
kind: ConfigMap
metadata:
  name: configmap-gateway
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_hashgen.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to string-ns/ConfigMap/example-configmap:
apiVersion: v1
data:
  MESSAGE: goodbye
kind: ConfigMap
metadata:
  name: example-configmap
  namespace: string-ns

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_hashgen1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to string-ns/ConfigMap/example-configmap:
apiVersion: v1
data:
  MESSAGE: goodbye
kind: ConfigMap
metadata:
  name: example-configmap
  namespace: string-ns

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_hashgen2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to string-ns/ConfigMap/example-configmap:
apiVersion: v1
data:
  MESSAGE: goodbye
kind: ConfigMap
metadata:
  name: example-configmap
  namespace: string-ns

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_index_basico.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/apache-config:
apiVersion: v1
data:
  index.html: |
    <html>
    <head>
        <title>Bienvenidos al servidor web de Jorsat</title>
    </head>
    <body>
        <h1>Bienvenidos al servidor web de Jorsat</h1>
    </body>
    </html>
kind: ConfigMap
metadata:
  name: apache-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_ingress-nginx-controller.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx-private/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  allow-snippet-annotations: "true"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
  name: ingress-nginx-controller
  namespace: ingress-nginx-private

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_ingress-nginx-controller1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx-private/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  allow-snippet-annotations: "true"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
  name: ingress-nginx-controller
  namespace: ingress-nginx-private

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_manifest.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  nginx.conf: "events { }\n\nhttp {\n\n  server {\n\n    listen 80;\n    listen 443
    ssl;\n    ssl_certificate /etc/nginx/tls/certificado.crt;\n    ssl_certificate_key
    /etc/nginx/tls/chave-privada.key;\n\n    location / {\n      \n      return 200
    'Voc foi Sassationado!\\n';\n      add_header 'Content-Type' text/plain;\n    \n
    \   }\n  \n  }\n\n}\n"
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_mysql.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-config:
apiVersion: v1
data:
  default_auth: |
    [mysqld]
    default_authentication_plugin=mysql_native_password
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_nginx.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/bittorrent-nginx-configmap:
apiVersion: v1
data:
  nginx.conf: "events {}\nhttp {\n  server {\n    listen 80 ssl;  \n\n    ssl_certificate
    /config/keys/fullchain.pem;\n    ssl_certificate_key /config/keys/privkey.pem;\n\n
    \   location / {\n      proxy_pass http://localhost:9091; \n      proxy_set_header
    Host $host;\n      proxy_set_header X-Real-IP $remote_addr;\n      proxy_set_header
    X-Forwarded-For $proxy_add_x_forwarded_for;\n      proxy_set_header X-Forwarded-Proto
    $scheme;\n    }\n  }\n}\n"
kind: ConfigMap
metadata:
  name: bittorrent-nginx-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_s3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-services3:
apiVersion: v1
data:
  config_serviceS3.cfg: |
    GROUP_NAME="SensorsManagerTeam"
    SESSION_NAME="AssumeRoleSession"
    BUCKET_DATA_SHEET="sensors-data-sheet"
    BUCKET_TEMAPLATE="sensor-device-template"
    ID_ACCOUNT_AWS="ID_ACCOUNT_AWS"
  flaskenv: development
kind: ConfigMap
metadata:
  name: configmap-services3
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_sample.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/example-configmap:
apiVersion: v1
data:
  app_name: MyApp
  app_version: "1.0"
kind: ConfigMap
metadata:
  name: example-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_sample_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/config-map-deployment:
apiVersion: apps/v1
kind: Deployment
metadata:
  name: config-map-deployment
  namespace: default
spec:
  replicas: 3
  selector:
    matchLabels:
      app: example-app
  template:
    metadata:
      labels:
        app: example-app
    spec:
      containers:
      - env:
        - name: APP_NAME
          valueFrom:
            configMapKeyRef:
              key: app_name
              name: example-configmap
        - name: APP_VERSION
          valueFrom:
            configMapKeyRef:
              key: app_version
              name: example-configmap
        image: my/app-image:latest
        name: app-container

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/config-map-deployment

skipped mutate policy add-safe-to-evict -> resource default/Deployment/config-map-deployment
policy disallow-default-namespace -> resource default/Deployment/config-map-deployment failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Deployment/config-map-deployment failed:
1 - autogen-validate-image-tag validation failure: validation error: Using a mutable image tag e.g. 'latest' is not allowed. rule autogen-validate-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Deployment/config-map-deployment failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/config-map-deployment failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/config-map-deployment failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/config-map-deployment failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-pod-probes -> resource default/Deployment/config-map-deployment failed:
1 - autogen-validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Deployment/config-map-deployment failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/config-map-deployment failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_shell_script.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/script-index:
apiVersion: v1
data:
  script.sh: |
    #!/bin/sh
    echo "<html><body><h1>This is Pod $HOSTNAME</h1></body></html>" > /usr/share/nginx/html/index.html
kind: ConfigMap
metadata:
  name: script-index
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_tcp-services.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/tcp-services:
apiVersion: v1
data:
  "1883": home-automation/mosquitto:1883
kind: ConfigMap
metadata:
  name: tcp-services
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_tcp-services1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/tcp-services:
apiVersion: v1
data:
  "1883": home-automation/mosquitto:1883
kind: ConfigMap
metadata:
  name: tcp-services
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap_test1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  app.properties: |
    environment=production
    logging=INFO
    log_path=$APP_HOME/logs/
    prallel_jobs=3
    wait_time=30sec
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_udp-services.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/udp-services:
apiVersion: v1
data:
  "5683": home-automation/home-assistant-coiot:5683
kind: ConfigMap
metadata:
  name: udp-services
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_udp-services1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/udp-services:
apiVersion: v1
data:
  "5683": home-automation/home-assistant-coiot:5683
kind: ConfigMap
metadata:
  name: udp-services
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_volume_pod.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  SPECIAL_LEVEL: very
  SPECIAL_TYPE: charm
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_volume_pod_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - ls /etc/config/
    image: k8s.gcr.io/busybox
    name: test-container
    volumeMounts:
    - mountPath: /etc/config
      name: config-volume
  restartPolicy: Never
  volumes:
  - configMap:
      defaultMode: 493
      name: special-config
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_volume_pod_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - cat /etc/config/keys
    image: k8s.gcr.io/busybox
    name: test-container
    volumeMounts:
    - mountPath: /etc/config
      name: config-volume
  restartPolicy: Never
  volumes:
  - configMap:
      items:
      - key: SPECIAL_LEVEL
        path: keys
      name: special-config
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_volume_pod1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  SPECIAL_LEVEL: very
  SPECIAL_TYPE: charm
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_volume_pod1_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - ls /etc/config/
    image: k8s.gcr.io/busybox
    name: test-container
    volumeMounts:
    - mountPath: /etc/config
      name: config-volume
  restartPolicy: Never
  volumes:
  - configMap:
      defaultMode: 493
      name: special-config
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_volume_pod1_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - cat /etc/config/keys
    image: k8s.gcr.io/busybox
    name: test-container
    volumeMounts:
    - mountPath: /etc/config
      name: config-volume
  restartPolicy: Never
  volumes:
  - configMap:
      items:
      - key: SPECIAL_LEVEL
        path: keys
      name: special-config
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_volume_pod2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  SPECIAL_LEVEL: very
  SPECIAL_TYPE: charm
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_volume_pod2_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - ls /etc/config/
    image: k8s.gcr.io/busybox
    name: test-container
    volumeMounts:
    - mountPath: /etc/config
      name: config-volume
  restartPolicy: Never
  volumes:
  - configMap:
      defaultMode: 493
      name: special-config
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_volume_pod2_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - cat /etc/config/keys
    image: k8s.gcr.io/busybox
    name: test-container
    volumeMounts:
    - mountPath: /etc/config
      name: config-volume
  restartPolicy: Never
  volumes:
  - configMap:
      items:
      - key: SPECIAL_LEVEL
        path: keys
      name: special-config
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_volume_pod3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/special-config:
apiVersion: v1
data:
  SPECIAL_LEVEL: very
  SPECIAL_TYPE: charm
kind: ConfigMap
metadata:
  name: special-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap_volume_pod3_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - ls /etc/config/
    image: k8s.gcr.io/busybox
    name: test-container
    volumeMounts:
    - mountPath: /etc/config
      name: config-volume
  restartPolicy: Never
  volumes:
  - configMap:
      defaultMode: 493
      name: special-config
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap_volume_pod3_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/dapi-test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: dapi-test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - cat /etc/config/keys
    image: k8s.gcr.io/busybox
    name: test-container
    volumeMounts:
    - mountPath: /etc/config
      name: config-volume
  restartPolicy: Never
  volumes:
  - configMap:
      items:
      - key: SPECIAL_LEVEL
        path: keys
      name: special-config
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/dapi-test-pod
policy disallow-default-namespace -> resource default/Pod/dapi-test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/dapi-test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/dapi-test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/dapi-test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/dapi-test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/dapi-test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/dapi-test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/dapi-test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap293.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to md2pdf/ConfigMap/blob-storage-disk-permissions:
apiVersion: v1
data:
  set-permissions.sh: |
    #!/bin/sh
    # Fix permissions in this blob-storage.

    set -u
    set -e

    mount="$1"
    user_id=1000

    curr_user_id=$(stat -c '%!u(MISSING)' "$mount")

    if [ "$curr_user_id" != "$user_id" ]; then
      echo "Changing permissions on '$mount' from '$curr_user_id' -> '$user_id'..."
      chown -R "$user_id:$user_id" "$mount"
    fi
kind: ConfigMap
metadata:
  name: blob-storage-disk-permissions
  namespace: md2pdf

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap294.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to md2pdf/ConfigMap/db-config:
apiVersion: v1
data:
  DATABASE_URL: postgres://development:development@postgresdb.md2pdf/postgres
kind: ConfigMap
metadata:
  name: db-config
  namespace: md2pdf

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap295.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to md2pdf/ConfigMap/queue-config:
apiVersion: v1
data:
  EXCHANGE_NAME: md2pdf.exchange
  QUEUE_JOBS: md2pdf.jobs
  QUEUE_JOBS_DURABLE: "false"
  QUEUE_JOBS_ROUTING_KEY: md2pdf.job
  QUEUE_STATUS: md2pdf.status
  QUEUE_STATUS_DURABLE: "false"
  QUEUE_STATUS_ROUTING_KEY: md2pdf.status
  RABBITMQ_HOST: rabbitmq.md2pdf
  RABBITMQ_PASSWORD: guest
  RABBITMQ_USERNAME: guest
kind: ConfigMap
metadata:
  name: queue-config
  namespace: md2pdf

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap296.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to md2pdf/ConfigMap/rabbitmq-config:
apiVersion: v1
data:
  enabled_plugins: |
    [rabbitmq_management,rabbitmq_peer_discovery_k8s].
  rabbitmq.conf: |
    ## Cluster formation. See https://www.rabbitmq.com/cluster-formation.html to learn more.
    cluster_formation.peer_discovery_backend  = rabbit_peer_discovery_k8s
    cluster_formation.k8s.host = kubernetes.default.svc.cluster.local

    ## Should RabbitMQ node name be computed from the pod's hostname or IP address?
    ## IP addresses are not stable, so using [stable] hostnames is recommended when possible.
    ## Set to "hostname" to use pod hostnames.
    ## When this value is changed, so should the variable used to set the RABBITMQ_NODENAME
    ## environment variable.
    cluster_formation.k8s.address_type = hostname

    ## How often should node cleanup checks run?
    cluster_formation.node_cleanup.interval = 30

    ## Set to false if automatic removal of unknown/absent nodes
    ## is desired. This can be dangerous, see
    ##  * https://www.rabbitmq.com/cluster-formation.html#node-health-checks-and-cleanup
    ##  * https://groups.google.com/forum/#!msg/rabbitmq-users/wuOfzEywHXo/k8z_HWIkBgAJ
    cluster_formation.node_cleanup.only_log_warning = true
    cluster_partition_handling = autoheal

    ## See https://www.rabbitmq.com/ha.html#master-migration-data-locality
    queue_master_locator=min-masters

    ## This is just an example.
    ## This enables remote access for the default user with well known credentials.
    ## Consider deleting the default user and creating a separate user with a set of generated
    ## credentials instead.
    ## Learn more at https://www.rabbitmq.com/access-control.html#loopback-users
    loopback_users.guest = false
kind: ConfigMap
metadata:
  name: rabbitmq-config
  namespace: md2pdf

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap297.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to spring-petclinic/ConfigMap/petclinic-config:
apiVersion: v1
data:
  application.yaml: "server:\n  shutdown: graceful\n  lifecycle:\n    timeout-per-shutdown-phase:
    15\n  port: 8080\n  compression:\n    enabled: true\n    mime-types: application/json,text/css,application/javascript\n
    \   min-response-size: 2048\n\n# Logging\nlogging.level.org.springframework: INFO\n\n#
    Metrics\nmanagement:\n  metrics:\n    use-global-registry: false\n  endpoint:\n
    \   metrics:\n      enabled: false\n    health:\n      probes:\n        enabled:
    true\n  health:\n    livenessState:\n      enabled: true\n    readinessState:\n
    \     enabled: true\n    restart:\n      enabled: true\n    metrics:\n      enabled:
    true\n  endpoints:\n    web:\n      exposure:\n        include: '*'\n\ncustomers-service-id:
    http://customers-service.spring-petclinic.traefik.mesh:8080\nvisits-service-id:
    http://vists-service.spring-petclinic.traefik.mesh:8080\n\nspring:\n  autoconfigure.exclude:
    org.springframework.boot.actuate.autoconfigure.metrics.export.wavefront.WavefrontMetricsExportAutoConfiguration\n
    \ sleuth:\n    sampler:\n      probability: 1.0\n    config:\n      # Allow the
    microservices to override the remote properties with their own System properties
    or config file\n      allow-override: true\n      # Override configuration with
    any local property source\n      override-none: true\n  messages:\n    basename:
    messages/messages\n  cloud:\n    kubernetes:\n      discovery:\n        enabled:
    true\n    loadbalancer:\n      ribbon:\n        enabled: false\n    gateway:\n
    \     x-forwarded:  \n        enabled: true \n        for-enabled: true \n        proto-enabled:
    true \n        host-append: false  \n        port-append: false  \n        proto-append:
    false\n      routes:\n        - id: vets-service\n          uri: http://vets-service.spring-petclinic.traefik.mesh:8080\n
    \         predicates:\n            - Path=/api/vet/**\n          filters:\n            -
    StripPrefix=2\n        - id: visits-service\n          uri: http://visits-service.spring-petclinic.traefik.mesh:8080\n
    \         predicates:\n            - Path=/api/visit/**\n          filters:\n
    \           - StripPrefix=2\n        - id: customers-service\n          uri: http://customers-service.spring-petclinic.traefik.mesh:8080\n
    \         predicates:\n            - Path=/api/customer/**\n          filters:\n
    \           - StripPrefix=2\nvets:\n  cache:\n    ttl: 60\n    heap-size: 101"
kind: ConfigMap
metadata:
  name: petclinic-config
  namespace: spring-petclinic

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap298.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/msvc-usuarios:
apiVersion: v1
data:
  application.yaml: |-
    config:
      texto: Configurando ambiente por defecto
    ---
    spring:
      config:
        activate:
          on-profile: dev
    config:
      texto: Configurando ambiente de desarrollo
    ---
    spring:
      config:
        activate:
          on-profile: prod
    config:
      texto: Configurando ambiente de produccion
  curso_url: msvc-cursos:8002
  database: msvc_usuarios
  db_host: mysql8:3306
  lb_auth_issuer_uri: http://172.26.55.224:30476
  lb_usuarios_uri: http://172.26.55.224:30350
  port: "8001"
kind: ConfigMap
metadata:
  name: msvc-usuarios
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap298_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/msvc-cursos:
apiVersion: v1
data:
  database: msvc_cursos
  db_host: postgres14:5432
  port: "8002"
  usuario_url: msvc-usuarios:8001
kind: ConfigMap
metadata:
  name: msvc-cursos
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap299.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DB: auth
  MYSQL_HOST: host.minikube.internal
  MYSQL_PORT: "3306"
  MYSQL_USER: auth_user
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap30.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/example-config:
apiVersion: v1
data:
  config.json: |
    {
      "environment" : "dev"
    }
kind: ConfigMap
metadata:
  name: example-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap300.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap301.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap302.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap303.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap304.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/commafeed-configmap:
apiVersion: v1
data:
  CF_APP_PUBLICURL: https://commafeed.mischavandenburg.net
  CF_DATABASE_DRIVERCLASS: org.postgresql.Driver
  CF_DATABASE_URL: jdbc:postgresql://commafeed-db.mischavandenburg.net:5432/commafeed
kind: ConfigMap
metadata:
  name: commafeed-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap305.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/health-api-configmap:
apiVersion: v1
data:
  DB_HOST: health-db.mischavandenburg.net
  DB_NAME: health
kind: ConfigMap
metadata:
  name: health-api-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap306.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/linkding-configmap:
apiVersion: v1
data:
  LD_DB_DATABASE: linkding
  LD_DB_ENGINE: postgres
  LD_DB_HOST: linkding-pg.mischavandenburg.net
  LD_DB_PORT: "5432"
  LD_SERVER_PORT: "3003"
kind: ConfigMap
metadata:
  name: linkding-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap307.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/n8n-configmap:
apiVersion: v1
data:
  DB_POSTGRESDB_DATABASE: n8n
  DB_POSTGRESDB_HOST: n8n-db.mischavandenburg.net
  DB_POSTGRESDB_PORT: "5432"
  DB_TYPE: postgresdb
  N8N_PORT: "3008"
  N8N_PROTOCOL: http
  N8N_SECURE_COOKIE: "false"
kind: ConfigMap
metadata:
  name: n8n-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap308.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/shelly-configmap:
apiVersion: v1
data:
  MQTT_BROKER: 192.168.120.186
  MQTT_PORT: "1883"
  PG_DATABASE: shelly
  PG_HOST: home-iot-db.mischavandenburg.net
kind: ConfigMap
metadata:
  name: shelly-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap309.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/wallabag-configmap:
apiVersion: v1
data:
  POSTGRES_USER: wallabag
  SYMFONY__ENV__DATABASE_DRIVER: pdo_pgsql
  SYMFONY__ENV__DATABASE_HOST: wallabag-db.mischavandenburg.net
  SYMFONY__ENV__DATABASE_NAME: wallabag
  SYMFONY__ENV__DATABASE_PORT: "5432"
  SYMFONY__ENV__DATABASE_USER: wallabag
  SYMFONY__ENV__DOMAIN_NAME: https://wallabag.mischavandenburg.net
kind: ConfigMap
metadata:
  name: wallabag-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap31.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/nginx-configuration:
apiVersion: v1
data:
  client-body-buffer-size: 60k
  client-header-buffer-size: 16k
  error-log-level: warn
  http2-max-field-size: 16k
  large-client-header-buffers: 4 16k
  location-snippet: include /etc/nginx/custom-snippets/location-custom.conf;
  log-format-escape-json: "true"
  log-format-upstream: '{"time":"$time_iso8601","remote_addr":"$remote_addr","proxy_protocol_addr":"$proxy_protocol_addr","proxy_protocol_port":"$proxy_protocol_port","x_forward_for":"$proxy_add_x_forwarded_for","remote_user":"$remote_user","host":"$host","request_method":"$request_method","request_uri":"$request_uri","server_protocol":"$server_protocol","status":$status,"request_time":$request_time,"request_length":$request_length,"bytes_sent":$bytes_sent,"upstream_name":"$proxy_upstream_name","upstream_addr":"$upstream_addr","upstream_uri":"$uri","upstream_response_length":$upstream_response_length,"upstream_response_time":$upstream_response_time,"upstream_status":$upstream_status,"http_referrer":"$http_referer","http_user_agent":"$http_user_agent","http_cookie":"$http_cookie"}'
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/part-of: ingress-nginx
  name: nginx-configuration
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap31_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/tcp-services:
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/part-of: ingress-nginx
  name: tcp-services
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap31_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/udp-services:
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/part-of: ingress-nginx
  name: udp-services
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap310.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/zettelkasten-tracker-configmap:
apiVersion: v1
data:
  DB_HOST: quantified-self-db.mischavandenburg.net
  DB_NAME: zettelkasten-tracker
kind: ConfigMap
metadata:
  name: zettelkasten-tracker-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: Configmap3100.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/configmap-demo-3:
apiVersion: v1
kind: Pod
metadata:
  name: configmap-demo-3
  namespace: default
spec:
  containers:
  - image: nginx
    name: demo-container
    volumeMounts:
    - mountPath: /etc/config
      name: config
  volumes:
  - configMap:
      name: configmap-3
    name: config

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/configmap-demo-3

skipped mutate policy add-safe-to-evict -> resource default/Pod/configmap-demo-3
policy disallow-default-namespace -> resource default/Pod/configmap-demo-3 failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/configmap-demo-3 failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/configmap-demo-3 failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/configmap-demo-3 failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/configmap-demo-3 failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/configmap-demo-3 failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/configmap-demo-3 failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/configmap-demo-3 failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/configmap-demo-3 failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configMap3101.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/config-map03:
apiVersion: v1
kind: Pod
metadata:
  name: config-map03
  namespace: default
spec:
  containers:
  - env:
    - name: PARAMS
      value: P_name P_app P_region P_api
    - name: P_name
      value: roboshop
    - name: P_app
      value: nginx-top
    - name: P_region
      value: ap-south-1
    - name: P_api
      value: nginx_api
    image: chaitu1812/check-params
    name: c1

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/config-map03

skipped mutate policy add-safe-to-evict -> resource default/Pod/config-map03
policy disallow-default-namespace -> resource default/Pod/config-map03 failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/config-map03 failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/config-map03 failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/config-map03 failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/config-map03 failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/config-map03 failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/config-map03 failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/config-map03 failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/config-map03 failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap311.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pgadmin-configmap:
apiVersion: v1
data:
  PGADMIN_LISTEN_PORT: "3004"
kind: ConfigMap
metadata:
  name: pgadmin-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap312.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to renovate/ConfigMap/renovate-configmap:
apiVersion: v1
data:
  RENOVATE_AUTODISCOVER: "false"
  RENOVATE_GIT_AUTHOR: Renovate Bot <bot@renovateapp.com>
  RENOVATE_PLATFORM: github
kind: ConfigMap
metadata:
  name: renovate-configmap
  namespace: renovate

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap313.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-controller:
apiVersion: v1
data:
  plugins: panfactum
kind: ConfigMap
metadata:
  name: nginx-controller
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap314.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to metallb-system/ConfigMap/config:
apiVersion: v1
data:
  config: |
    address-pools:
    - name: default
      protocol: layer2
      addresses:
      - StartIP-ENDIP
kind: ConfigMap
metadata:
  name: config
  namespace: metallb-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap315.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  APP_COLOR: blue
  APP_MODE: prod
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap318.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/postgres-config:
apiVersion: v1
data:
  DB: postgres
  PASSWORD: postgres
  USER: postgres
kind: ConfigMap
metadata:
  name: postgres-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap318_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/hello-cm:
apiVersion: v1
kind: Pod
metadata:
  labels:
    app: application
  name: hello-cm
  namespace: default
spec:
  containers:
  - env:
    - name: PORT
      value: "3000"
    - name: DB_HOST
      value: postgres
    envFrom:
    - configMapRef:
        name: postgres-config
      prefix: POSTGRES_
    image: 080196/hello-cm
    name: hello-cm
    ports:
    - containerPort: 3000

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/hello-cm

skipped mutate policy add-safe-to-evict -> resource default/Pod/hello-cm
policy disallow-default-namespace -> resource default/Pod/hello-cm failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/hello-cm failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/hello-cm failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/hello-cm failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/hello-cm failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/hello-cm failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/hello-cm failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/hello-cm failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/hello-cm failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap318_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/postgres:
apiVersion: v1
kind: Pod
metadata:
  labels:
    app: db
  name: postgres
  namespace: default
spec:
  containers:
  - envFrom:
    - configMapRef:
        name: postgres-config
      prefix: POSTGRES_
    image: postgres
    name: postgres
    ports:
    - containerPort: 5432

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/postgres

skipped mutate policy add-safe-to-evict -> resource default/Pod/postgres
policy disallow-default-namespace -> resource default/Pod/postgres failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/postgres failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/postgres failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/postgres failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/postgres failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/postgres failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/postgres failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/postgres failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/postgres failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap318_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/postgres:
apiVersion: v1
kind: Service
metadata:
  labels:
    app: db
  name: postgres
  namespace: default
spec:
  ports:
  - port: 5432
    targetPort: 5432
  selector:
    app: db

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap319.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/homepage-configmap:
apiVersion: v1
data:
  health-check.html: |
    <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Health Check Status</title>
      <style>
        body {
          background-color: #d3ffd3; /* Hintergrundfarbe */
          color: #008000; /* Schriftfarbe */
          font-family: Arial, sans-serif; /* Schriftart */
          text-align: center; /* Zentrierung des Textes */
        }
        h1 {
          color: #228b22; /* Farbe fr berschriften */
        }
      </style>
    </head>
    <body>
      <h1>Healthcheck des Servers</h1>
      <p>Der Server ist gesund</p>
    </body>
    </html>
  index.html: "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n
    \ <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n
    \ <title>Homepage Gruppe G</title>\n  <style>\n    body {\n      background-color:
    #f5f5f5; /* Hintergrundfarbe */\n      color: #333; /* Schriftfarbe */\n      font-family:
    Arial, sans-serif; /* Schriftart */\n      text-align: center; /* Zentrierung
    des Textes */\n    }\n    h1 {\n      color: #1e90ff; /* Farbe fr berschriften
    */\n    }\n    a {\n      color: #4caf50; /* Farbe fr Links */\n    }\n  </style>\n</head>\n<body>\n
    \ <h1>Willkommen am Server der Gruppe G</h1>\n  <p>Bitte am Link klicken</p>\n
    \ \n  <!-- Link to Health Check -->\n  <a href=\"health-check.html\">Check Health
    Status</a>\n</body>\n</html>\n"
kind: ConfigMap
metadata:
  name: homepage-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap320.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to kube-system/ConfigMap/descheduler-policy-configmap:
apiVersion: v1
data:
  policy.yaml: |
    apiVersion: "descheduler/v1alpha1"
    kind: "DeschedulerPolicy"
    strategies:
      "RemoveDuplicates":
         enabled: true
      "RemovePodsViolatingInterPodAntiAffinity":
         enabled: true
      "LowNodeUtilization":
         enabled: true
         params:
           nodeResourceUtilizationThresholds:
             thresholds:
               "cpu" : 20
               "memory": 20
               "pods": 20
             targetThresholds:
               "cpu" : 50
               "memory": 50
               "pods": 50
kind: ConfigMap
metadata:
  name: descheduler-policy-configmap
  namespace: kube-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap325.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ms-layer/ConfigMap/helloworld:
apiVersion: v1
data:
  AUTHORS: ericsee
kind: ConfigMap
metadata:
  name: helloworld
  namespace: ms-layer

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap326.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ms-layer/ConfigMap/sillyworld:
apiVersion: v1
data:
  AUTHORS: ericsee
kind: ConfigMap
metadata:
  name: sillyworld
  namespace: ms-layer

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap328.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ghost/ConfigMap/ghost-configmap:
apiVersion: v1
data:
  database__client: mysql
  database__connection__host: mysql
  mail__options__host: smtp.eu.mailgun.org
  mail__options__port: "465"
  mail__options__secure: "true"
  mail__options__service: Mailgun
  mail__transport: SMTP
  url: https://questverse.blog
kind: ConfigMap
metadata:
  name: ghost-configmap
  namespace: ghost

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap329.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pixa-config:
apiVersion: v1
data:
  PIX_DB_DATABASE: your-db-name-placeholder
  PIX_DB_HOST: your-db-host-placeholder
  PIX_DB_PASSWORD: your-db-password-placeholder
  PIX_DB_USER: your-db-user-placeholder
  PIXA_AUTH_ALGORITHM: your-auth-algorithm-placeholder
  PIXA_AUTH_SECRET_KEY: your-auth-secret-key-placeholder
  PIXA_STORAGE_ACCOUNT_KEY: your-storage-account-key-placeholder
  PIXA_STORAGE_CONNECTION_STRING: your-storage-connection-string-placeholder
  PIXA_STORAGE_SHARE_NAME: your-share-name-placeholder
  PIXA_STORAGE_STORAGE_NAME: your-storage-name-placeholder
  PIXA_STORAGE_URL_SASTOKEN: your-storage-sastoken-placeholder
  PIXA_STORAGELOGS_CONNECTION_STRING: your-logs-connection-string-placeholder
  PIXA_STORAGELOGS_CONTAINER_NAME: your-logs-container-name-placeholder
  PIXA_STORAGELOGS_STORAGE_NAME: your-logs-storage-name-placeholder
kind: ConfigMap
metadata:
  name: pixa-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap330.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-set-env-config:
apiVersion: v1
data:
  key-1: value-1
  key-2: value-2
kind: ConfigMap
metadata:
  name: test-set-env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap331.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test:
apiVersion: v1
kind: ConfigMap
metadata:
  name: test
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap332.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap333.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap334.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  master.cnf: |
    [mysqld]
    log-bin
  slave.cnf: |
    [mysqld]
    super-read-only
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap335.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-configmap:
apiVersion: v1
data:
  data-1: value-1
  data-2: value-2
kind: ConfigMap
metadata:
  name: test-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap336.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to grafana/ConfigMap/syslog-grafana-agent:
apiVersion: v1
data:
  config.river: |
    discovery.relabel "syslog" {
            targets = []

            rule {
                    source_labels = ["__syslog_message_hostname"]
                    target_label  = "host"
            }

            rule {
                    source_labels = ["__syslog_message_hostname"]
                    target_label  = "hostname"
            }

            rule {
                    source_labels = ["__syslog_message_severity"]
                    target_label  = "level"
            }

            rule {
                    source_labels = ["__syslog_message_app_name"]
                    target_label  = "application"
            }

            rule {
                    source_labels = ["__syslog_message_facility"]
                    target_label  = "facility"
            }

            rule {
                    source_labels = ["__syslog_connection_hostname"]
                    target_label  = "connection_hostname"
            }
    }

    loki.source.syslog "syslog" {
            listener {
                    address      = "0.0.0.0:601"
                    protocol     = "tcp"
                    idle_timeout = "0s"
                    labels       = { job = "syslog", component = "loki.source.syslog", protocol = "tcp" }
                    max_message_length = 0
            }
            listener {
                    address      = "0.0.0.0:514"
                    protocol     = "udp"
                    idle_timeout = "0s"
                    labels       = { job = "syslog", component = "loki.source.syslog", protocol = "udp" }
                    max_message_length = 0
            }
            forward_to    = [loki.write.syslog.receiver]
            relabel_rules = discovery.relabel.syslog.rules
    }

    loki.write "syslog" {
            endpoint {
                    url = "https://logs/loki/api/v1/push"
            }
    }
kind: ConfigMap
metadata:
  name: syslog-grafana-agent
  namespace: grafana

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap338.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/myconfig:
apiVersion: v1
data:
  sangamesh: gheware
  sangamesh1: gheware1
  sangamesh2: gheware2
  sangamesh3: gheware3
kind: ConfigMap
metadata:
  labels:
    sang: ghe
  name: myconfig
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap338_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/mypod:
apiVersion: v1
kind: Pod
metadata:
  labels:
    sang: ghe
  name: mypod
  namespace: default
spec:
  containers:
  - args:
    - sleep
    - 1d
    envFrom:
    - configMapRef:
        name: myconfig
        optional: false
    image: alpine
    name: mycon

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/mypod

skipped mutate policy add-safe-to-evict -> resource default/Pod/mypod
policy disallow-default-namespace -> resource default/Pod/mypod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/mypod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/mypod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/mypod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/mypod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/mypod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/mypod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/mypod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/mypod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap338_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/myconfig:
apiVersion: v1
data:
  sangamesh: gheware
  sangamesh1: gheware1
  sangamesh2: gheware2
  sangamesh3: gheware3
kind: ConfigMap
metadata:
  labels:
    sang: ghe
  name: myconfig
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap338_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/mypod:
apiVersion: v1
kind: Pod
metadata:
  labels:
    sang: ghe
  name: mypod
  namespace: default
spec:
  containers:
  - args:
    - sleep
    - 1d
    env:
    - name: SANGAMESH
      valueFrom:
        configMapKeyRef:
          key: sangamesh
          name: myconfig
    - name: SANGAMESH1
      valueFrom:
        configMapKeyRef:
          key: sangamesh1
          name: myconfig
    image: alpine
    name: mycon

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/mypod

skipped mutate policy add-safe-to-evict -> resource default/Pod/mypod
policy disallow-default-namespace -> resource default/Pod/mypod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/mypod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/mypod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/mypod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/mypod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/mypod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/mypod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/mypod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/mypod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap338_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/my-pod:
apiVersion: v1
kind: Pod
metadata:
  name: my-pod
  namespace: default
spec:
  containers:
  - image: my-image
    name: my-container
    volumeMounts:
    - mountPath: /etc/config
      name: config-volume
  volumes:
  - configMap:
      name: my-config
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/my-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/my-pod
policy disallow-default-namespace -> resource default/Pod/my-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/my-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/my-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/my-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/my-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/my-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/my-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/my-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/my-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmap339.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  MYSQL_ROOT_PASSWORD: password
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap340.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  MYSQL_ROOT_PASSWORD: password
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap356.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to kubernetes-101/ConfigMap/config:
apiVersion: v1
data:
  config.yaml: |
    config_key=config_value
kind: ConfigMap
metadata:
  labels:
    app: golang-api
    environment: production
  name: config
  namespace: kubernetes-101

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap357.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to kubernetes-101/ConfigMap/config:
apiVersion: v1
data:
  config.yaml: |
    config_key=config_value
kind: ConfigMap
metadata:
  labels:
    app: golang-api
    environment: production
  name: config
  namespace: kubernetes-101

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap358.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  nginx.conf: |-
    events { }
    http { server { listen 80; listen 443 ssl;
    ssl_certificate /etc/nginx/tls/certificado.crt; ssl_certificate_key /etc/nginx/tls/chave-privada.key;
    location / { return 200 'Ola terraqueos!\n'; add_header Content-Type text/plain; } } }
kind: ConfigMap
metadata:
  creationTimestamp: "2024-02-01T17:07:39Z"
  name: nginx-config
  namespace: default
  resourceVersion: "320351"
  uid: 877c6671-e5ba-4229-9095-41161e192196

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap359.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  proxy-connect-timeout: "10"
  proxy-read-timeout: "120"
  proxy-send-timeout: "120"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/part-of: ingress-nginx
  name: ingress-nginx-controller
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap360.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  proxy-set-headers: ingress-nginx/custom-headers
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/part-of: ingress-nginx
  name: ingress-nginx-controller
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap361.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  ssl-dh-param: ingress-nginx/lb-dhparam
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/part-of: ingress-nginx
  name: ingress-nginx-controller
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap373.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DATABASE_DB: auth
  MYSQL_DATABASE_HOST: host.minikube.internal
  MYSQL_DATABASE_PORT: "3306"
  MYSQL_DATABASE_USER: auth_user
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap374.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap375.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap376.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap38.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nodejs-env-config:
apiVersion: v1
data:
  APPLICATION: My Cool Application
  VERSION: 1.0.0
kind: ConfigMap
metadata:
  name: nodejs-env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap38_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ReplicaSet/nodejs-env:
apiVersion: apps/v1
kind: ReplicaSet
metadata:
  name: nodejs-env
  namespace: default
spec:
  replicas: 3
  selector:
    matchLabels:
      name: nodejs-env
  template:
    metadata:
      labels:
        name: nodejs-env
      name: nodejs-env
    spec:
      containers:
      - envFrom:
        - configMapRef:
            name: nodejs-env-config
        image: khannedy/nodejs-env
        name: nodejs-env
        ports:
        - containerPort: 3000

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/ReplicaSet/nodejs-env

skipped mutate policy add-safe-to-evict -> resource default/ReplicaSet/nodejs-env
policy disallow-latest-tag -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-require-image-tag validation failure: validation error: An image tag is required. rule autogen-require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 6, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: configmap38_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/nodejs-env-service:
apiVersion: v1
kind: Service
metadata:
  name: nodejs-env-service
  namespace: default
spec:
  ports:
  - nodePort: 30001
    port: 3000
    targetPort: 3000
  selector:
    name: nodejs-env
  type: NodePort

---


Mutation:
Mutation has been applied successfully.policy restrict-nodeport -> resource default/Service/nodejs-env-service failed:
1 - validate-nodeport validation error: Services of type NodePort are not allowed. rule validate-nodeport failed at path /spec/type/


pass: 1, fail: 1, warn: 0, error: 0, skip: 0 

##### FILE: configMap380.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap:
apiVersion: v1
data:
  MYSQL_DATABASE: petclinic
  MYSQL_URL: jdbc:mysql://mysql:3306/petclinic
  MYSQL_USER: petclinic
kind: ConfigMap
metadata:
  name: configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap381.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongodb-configmap:
apiVersion: v1
data:
  ensure-users.js: |
    const rootUser = cat('/etc/k8-test/admin/MONGO_ROOT_USERNAME');
    const rootPass = cat('/etc/k8-test/admin/MONGO_ROOT_PASSWORD');
    const usersStr = cat('/etc/k8-test/MONGO_USERS_LIST');
    const adminDb = db.getSiblingDB('admin');
    adminDb.auth(rootUser, rootPass);
    print('Successfully authenticated admin user');

    const databases = ['mp3s', 'videos'];

    databases.forEach((targetDbStr) => {
      const targetDb = db.getSiblingDB(targetDbStr);
      const customRoles = adminDb
        .getRoles({ rolesInfo: 1, showBuiltinRoles: false })
        .map(role => role.role)
        .filter(Boolean);
      usersStr
        .trim()
        .split(';')
        .map(s => s.split(':'))
        .forEach(user => {
          const username = user[0];
          const rolesStr = user[1];
          const password = user[2];
          if (!rolesStr || !password) {
            return;
          }
          const roles = rolesStr.split(',');
          const userDoc = {
            user: username,
            pwd: password,
            roles: [
              { role: 'readWrite', db: targetDbStr },
              ...roles.map(role => {
                if (!~customRoles.indexOf(role)) {
                  return { role, db: targetDbStr };
                }
                return role;
              }),
            ],
          };
          try {
            targetDb.createUser(userDoc);
          } catch (err) {
            if (!~err.message.toLowerCase().indexOf('duplicate')) {
              throw err;
            }
          }
        });
    });
  mongo.conf: |
    storage:
      dbPath: /data/db
kind: ConfigMap
metadata:
  name: mongodb-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap382.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap383.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  AUTH_TABLE: auth_user
  DATABASE_HOST: db
  DATABASE_NAME: authdb
  DATABASE_USER: sharath
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap384.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MONGODB_URI: mongodb://<username>:<password>@mongodb:27017/mp3s?authSource=admin
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap385.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
  MONGODB_MP3S_URI: mongodb://<username>:<password>@mongodb:27017/mp3s?authSource=admin
  MONGODB_VIDEOS_URI: mongodb://<username>:<password>@mongodb:27017/videos?authSource=admin
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap386.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap39.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/fileshare:
apiVersion: v1
data:
  default.conf: |
    server {
      listen       80 default_server;
      server_name  _;

      default_type text/plain;

      location / {
        return 200 '$hostname\n';
      }

      location /files {
        alias /data;
        autoindex on;
        client_body_temp_path /tmp;
        dav_methods PUT DELETE MKCOL COPY MOVE;
        create_full_put_path on;
        dav_access user:rw group:rw all:r;
      }
    }
kind: ConfigMap
metadata:
  name: fileshare
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap398.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DB: auth
  MYSQL_HOST: host.minikube.internal
  MYSQL_PORT: "3306"
  MYSQL_USER: auth_user
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap399.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap40.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-configmap:
apiVersion: v1
data:
  default.conf: |
    server {
        listen       80 default_server;
        server_name  _;

        default_type text/plain;

        location / {
            return 200 '$hostname\n';
        }
    }
kind: ConfigMap
metadata:
  name: my-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap400.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap401.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  SENDGRID_SENDER_EMAIL: kaieternity1993@gmail.com
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap402.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap404.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DB: auth
  MYSQL_HOST: host.minikube.internal
  MYSQL_PORT: "3306"
  MYSQL_USER: auth_user
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap405.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap406.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap407.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap408.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap409.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DB: auth
  MYSQL_HOST: host.minikube.internal
  MYSQL_PORT: "3306"
  MYSQL_USER: auth_user
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap41.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-configmap:
apiVersion: v1
data:
  default.conf: |
    server {
        listen       80 default_server;
        server_name  _;

        default_type text/plain;

        location / {
            return 200 '$hostname\n';
        }
    }
kind: ConfigMap
metadata:
  name: my-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap410.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap411.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-config:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
kind: ConfigMap
metadata:
  name: gateway-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap412.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap413.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap417.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to home/ConfigMap/immich-configmap:
apiVersion: v1
data:
  DB_PORT: "5432"
  IMMICH_MACHINE_LEARNING_URL: http://immich-machine-learning.home.svc.cluster.local:3003
  IMMICH_SERVER_URL: http://immich-server.home.svc.cluster.local:3001
  IMMICH_WEB_URL: http://immich-web.home.svc.cluster.local:3000
  LOG_LEVEL: verbose
  REDIS_HOSTNAME: dragonfly.database.svc.cluster.local
  REDIS_PORT: "6379"
  TRANSFORMERS_CACHE: /usr/src/app/.transformers_cache
kind: ConfigMap
metadata:
  name: immich-configmap
  namespace: home

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap418.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to home/ConfigMap/vikunja-configmap:
apiVersion: v1
data:
  Caddyfile: |-
    {
        admin off
        auto_https off
    }

    :8080 {
        log {
            output stdout
        }

        @api {
            path /api/*
            path /.well-known/*
            path /dav/*
        }

        header {
            -Server  # Remove Server header
        }

        handle @api {
            reverse_proxy localhost:3456
        }

        handle {
            reverse_proxy localhost:80
        }
    }
kind: ConfigMap
metadata:
  name: vikunja-configmap
  namespace: home

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap42.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-configmap:
apiVersion: v1
data:
  default.conf: |
    server {
        listen       80 default_server;
        server_name  _;

        default_type text/plain;

        location / {
            return 200 '$hostname\n';
        }
    }
kind: ConfigMap
metadata:
  name: my-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap421.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/${APP}-gatus-ep:
apiVersion: v1
data:
  config.yaml: |
    endpoints:
      - name: "${APP}"
        group: infrastructure
        url: "tcp://${GATUS_SVC_NAME}.${GATUS_NAMESPACE}.svc.cluster.local:${GATUS_SVC_PORT}"
        interval: 1m
        client:
          dns-resolver: tcp://1.1.1.1:53
        conditions: ["[CONNECTED] == true"]
        alerts:
          - type: pushover
        ui:
          hide-url: true
          hide-hostname: true
kind: ConfigMap
metadata:
  labels:
    gatus.io/enabled: "true"
  name: ${APP}-gatus-ep
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap423.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to immich/ConfigMap/immich-config:
apiVersion: v1
data:
  DB_DATABASE_NAME: immich
  DB_HOSTNAME: postgres.immich.svc
  DB_PORT: "5432"
  DB_USERNAME: immich
  REDIS_HOSTNAME: redis.immich.svc
  REDIS_PORT: "6379"
kind: ConfigMap
metadata:
  name: immich-config
  namespace: immich

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap424.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to pihole/ConfigMap/pihole-config:
apiVersion: v1
data:
  TZ: Europe/Madrid
kind: ConfigMap
metadata:
  name: pihole-config
  namespace: pihole

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap425.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to postgres/ConfigMap/postgres-config:
apiVersion: v1
data:
  POSTGRES_USER: admin
kind: ConfigMap
metadata:
  name: postgres-config
  namespace: postgres

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap426.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to vaultwarden/ConfigMap/vaultwarden-config:
apiVersion: v1
data:
  SIGNUPS_ALLOWED: "false"
kind: ConfigMap
metadata:
  name: vaultwarden-config
  namespace: vaultwarden

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap428.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to music/ConfigMap/navidrome:
apiVersion: v1
data:
  ND_BASEURL: /navidrome
  ND_LOGLEVEL: info
  ND_PROMETHEUS_ENABLED: "true"
  ND_SESSIONTIMEOUT: 24h
  ND_UIWELCOMEMESSAGE: Welcome to Aditya's music server
kind: ConfigMap
metadata:
  name: navidrome
  namespace: music

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap429.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to production/ConfigMap/kibana-config:
apiVersion: v1
data:
  kibana.yml: |
    server.name: kibana
    server.host: "0.0.0.0"
    server.port: 5601

    # Elasticsearch Connection
    elasticsearch.hosts: ["http://jobber-elastic.production.svc.cluster.local:9200"]

    monitoring.ui.container.elasticsearch.enabled: true
    xpack.fleet.enabled: true
    xpack.fleet.agents.enabled: true
    xpack.fleet.agents.elasticsearch.hosts: ["http://jobber-elastic.production.svc.cluster.local:9200"]
    xpack.reporting.roles.enabled: true
    xpack.fleet.agentIdVerificationEnabled: false
    xpack.security.encryptionKey: fhjskloppd678ehkdfdlliverpoolfcr
    xpack.encryptedSavedObjects.encryptionKey: fhjskloppd678ehkdfdlliverpoolfcr

    ## Add policy for apm-server integration
    xpack.fleet.packages:
      - name: apm
        version: latest
    xpack.fleet.agentPolicies:
      - name: Agent policy 1
        id: agent-policy-1
        namespace: default
        monitoring_enabled:
          - logs
          - metrics
        package_policies:
          - name: apm-1
            id: default-apm
            package:
              name: apm

    ## Misc
    elasticsearch.requestTimeout: 90000
kind: ConfigMap
metadata:
  name: kibana-config
  namespace: production

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap43.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-config:
apiVersion: v1
data:
  enabled_plugins: |
    [rabbitmq_peer_discovery_k8s].
  rabbitmq.conf: |
    ## Cluster formation. See http://www.rabbitmq.com/cluster-formation.html to learn more.
    cluster_formation.peer_discovery_backend  = rabbit_peer_discovery_k8s
    cluster_formation.k8s.host = kubernetes.default
    ## Should RabbitMQ node name be computed from the pod's hostname or IP address?
    ## IP addresses are not stable, so using [stable] hostnames is recommended when possible.
    ## Set to "hostname" to use pod hostnames.
    ## When this value is changed, so should the variable used to set the RABBITMQ_NODENAME
    ## environment variable.
    cluster_formation.k8s.address_type = ip
    ## How often should node cleanup checks run?
    cluster_formation.node_cleanup.interval = 30
    ## Set to false if automatic removal of unknown/absent nodes
    ## is desired. This can be dangerous, see
    ##  * http://www.rabbitmq.com/cluster-formation.html#node-health-checks-and-cleanup
    ##  * https://groups.google.com/forum/#!msg/rabbitmq-users/wuOfzEywHXo/k8z_HWIkBgAJ
    cluster_formation.node_cleanup.only_log_warning = true
    cluster_partition_handling = autoheal
    ## See http://www.rabbitmq.com/ha.html#master-migration-data-locality
    queue_master_locator=min-masters
    ## See http://www.rabbitmq.com/access-control.html#loopback-users
    loopback_users.guest = false
kind: ConfigMap
metadata:
  name: rabbitmq-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap431.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to projectname/ConfigMap/projectname-config:
apiVersion: v1
data:
  APP_DEBUG: "true"
  APP_ENV: local
  APP_KEY: base64:41O0zXX5PDtUAfz2FBXAKG1LRPp9lUzy+kZxTpu3wKo=
  APP_NAME: Filament K8s Demo
  APP_URL: http://localhost:8000
  BROADCAST_DRIVER: log
  CACHE_DRIVER: redis
  DB_CONNECTION: mysql
  DB_DATABASE: workshop_k8s
  DB_HOST: mysql
  DB_PASSWORD: secret
  DB_PORT: "3306"
  DB_USERNAME: workshop_k8s
  FILESYSTEM_DISK: local
  LOG_CHANNEL: stdout
  LOG_DEPRECATIONS_CHANNEL: "null"
  LOG_LEVEL: debug
  MAIL_ENCRYPTION: "null"
  MAIL_FROM_ADDRESS: hello@example.com
  MAIL_FROM_NAME: ${APP_NAME}
  MAIL_HOST: mailpit
  MAIL_MAILER: smtp
  MAIL_PASSWORD: "null"
  MAIL_PORT: "1025"
  MAIL_USERNAME: "null"
  MEMCACHED_HOST: 127.0.0.1
  QUEUE_CONNECTION: redis
  REDIS_HOST: redis
  REDIS_PASSWORD: secret
  REDIS_PORT: "6379"
  SESSION_DRIVER: redis
  SESSION_LIFETIME: "120"
kind: ConfigMap
metadata:
  name: projectname-config
  namespace: projectname

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap44.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-configmap:
apiVersion: v1
data:
  default.conf: |
    server {
        listen       80 default_server;
        server_name  _;
        default_type text/plain;

        location / {
            return 200 '$hostname\n';
        }
    }
kind: ConfigMap
metadata:
  name: my-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap440.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to all-applications/ConfigMap/order-configmap:
apiVersion: v1
data:
  Otlp__Endpoint: http://otel-collector:4317
  RabbitMq__HostName: rabbit
kind: ConfigMap
metadata:
  name: order-configmap
  namespace: all-applications

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap441.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/game-demo:
apiVersion: v1
data:
  course: devops
  duration: 35hrs
kind: ConfigMap
metadata:
  name: game-demo
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap442.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to log-output/ConfigMap/log-output-configmap:
apiVersion: v1
data:
  hello_message: Hello!
kind: ConfigMap
metadata:
  name: log-output-configmap
  namespace: log-output

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap443.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-config:
apiVersion: v1
data:
  course: k8s
  key3: |
    Hello
    Welcome to Config maps
    Multiline testing
  name: siva
kind: ConfigMap
metadata:
  name: my-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap445.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to langfuse/ConfigMap/langfuse-configmap:
apiVersion: v1
data:
  langfuse-enable-experimentalfeatures: "true"
  langfuse-next-public-sign-up-disabled: "false"
  langfuse-nextauth-url: https://langfuse.local.reinthal.cc
  langfuse-node-env: production
  langfuse-telemetry-enabled: "true"
kind: ConfigMap
metadata:
  name: langfuse-configmap
  namespace: langfuse

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap448.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-config:
apiVersion: v1
data:
  my-env-var: my-env-var-value
kind: ConfigMap
metadata:
  name: my-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap449.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/promtail-config:
apiVersion: v1
data:
  promtail.yaml: |
    server:
      http_listen_port: 9080
      grpc_listen_port: 0

    clients:
    - url: http://loki:3100/loki/api/v1/push

    positions:
      filename: /tmp/positions.yaml
    target_config:
      sync_period: 10s
    scrape_configs:
    - job_name: pod-logs
      kubernetes_sd_configs:
        - role: pod
      pipeline_stages:
        - docker: {}
      relabel_configs:
        - source_labels:
            - __meta_kubernetes_pod_node_name
          target_label: __host__
        - action: labelmap
          regex: __meta_kubernetes_pod_label_(.+)
        - action: replace
          replacement: $1
          separator: /
          source_labels:
            - __meta_kubernetes_namespace
            - __meta_kubernetes_pod_name
          target_label: job
        - action: replace
          source_labels:
            - __meta_kubernetes_namespace
          target_label: namespace
        - action: replace
          source_labels:
            - __meta_kubernetes_pod_name
          target_label: pod
        - action: replace
          source_labels:
            - __meta_kubernetes_pod_container_name
          target_label: container
        - replacement: /var/log/pods/*$1/*.log
          separator: /
          source_labels:
            - __meta_kubernetes_pod_uid
            - __meta_kubernetes_pod_container_name
          target_label: __path__
kind: ConfigMap
metadata:
  name: promtail-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap451.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/dados:
apiVersion: v1
data:
  DB_DATABASE: testemed
  DB_HOST: mysql
  REDIS_HOST: my-release-redis-master.default.svc.cluster.local
kind: ConfigMap
metadata:
  name: dados
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap452.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/api:
apiVersion: v1
data:
  rabbitmq_hostname: rabbitmq
kind: ConfigMap
metadata:
  name: api
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap453.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/console:
apiVersion: v1
data:
  rabbitmq_hostname: rabbitmq
kind: ConfigMap
metadata:
  name: console
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap454.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mssql:
apiVersion: v1
data:
  mssql_pid: ""
kind: ConfigMap
metadata:
  name: mssql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap455.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mssql:
apiVersion: v1
data:
  mssql_pid: Developer
kind: ConfigMap
metadata:
  name: mssql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap456.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/postgres-config:
apiVersion: v1
data:
  POSTGRES_DB: microservice
  POSTGRES_PASSWORD: root
  POSTGRES_USER: root
kind: ConfigMap
metadata:
  name: postgres-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap457.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-config:
apiVersion: v1
data:
  enabled_plugins: |
    [rabbitmq_management,rabbitmq_peer_discovery_k8s].
  rabbitmq.conf: |
    ## Cluster formation. See https://www.rabbitmq.com/cluster-formation.html to learn more.
    cluster_formation.peer_discovery_backend  = rabbit_peer_discovery_k8s
    cluster_formation.k8s.host = kubernetes.default.svc.cluster.local
    ## Should RabbitMQ node name be computed from the pod's hostname or IP address?
    ## IP addresses are not stable, so using [stable] hostnames is recommended when possible.
    ## Set to "hostname" to use pod hostnames.
    ## When this value is changed, so should the variable used to set the RABBITMQ_NODENAME
    ## environment variable.
    cluster_formation.k8s.address_type = hostname
    ## How often should node cleanup checks run?
    cluster_formation.node_cleanup.interval = 30
    ## Set to false if automatic removal of unknown/absent nodes
    ## is desired. This can be dangerous, see
    ##  * https://www.rabbitmq.com/cluster-formation.html#node-health-checks-and-cleanup
    ##  * https://groups.google.com/forum/#!msg/rabbitmq-users/wuOfzEywHXo/k8z_HWIkBgAJ
    cluster_formation.node_cleanup.only_log_warning = true
    cluster_partition_handling = autoheal
    ## See https://www.rabbitmq.com/ha.html#master-migration-data-locality
    queue_master_locator=min-masters
    ## This is just an example.
    ## This enables remote access for the default user with well known credentials.
    ## Consider deleting the default user and creating a separate user with a set of generated
    ## credentials instead.
    ## Learn more at https://www.rabbitmq.com/access-control.html#loopback-users
    loopback_users.guest = false
kind: ConfigMap
metadata:
  name: rabbitmq-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap459.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/ease-config:
apiVersion: v1
data:
  APP_DEBUG: "true"
  APP_ENV: production
  APP_KEY: base64:4S74CjRhwJDfzccJ1zKa+mXx6i9zv35p1Sn5S6Hb3zA=
  APP_LOG_LEVEL: debug
  APP_NAME: ease
  APP_URL: http://localhost
  ASSET_URL: https://example.com.bd/
  CACHE_DRIVER: redis
  DB_CONNECTION: mysql
  DB_DATABASE: test
  DB_HOST: mysql
  DB_PASSWORD: pass
  DB_PORT: "3306"
  DB_USERNAME: test
  QUEUE_CONNECTION: redis
  QUEUE_DRIVER: redis
  REDIS_HOST: ease-redis
  REDIS_PORT: "6379"
  SESSION_DRIVER: redis
kind: ConfigMap
metadata:
  name: ease-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap46.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-set-env-config:
apiVersion: v1
data:
  key-1: value-1
  key-2: value-2
kind: ConfigMap
metadata:
  name: test-set-env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap460.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/db-config:
apiVersion: v1
data:
  dbName: moviedb
  host: postgres
kind: ConfigMap
metadata:
  name: db-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap461.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-configmap:
apiVersion: v1
data:
  mongodb_uri: mongodb://mongo:27017/TodoApp
  node_env: development
  port: "3000"
kind: ConfigMap
metadata:
  name: app-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap462.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/db-config:
apiVersion: v1
data:
  dbName: moviedb
  host: postgres
kind: ConfigMap
metadata:
  name: db-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap463.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MONGO_URI: mongodb://host.minikube.internal:27017/authDB
  PORT: "5051"
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap464.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  AMQP_URL: amqp://host.minikube.internal:5672
  MP3_DB_URI: mongodb://host.minikube.internal:27017/mp3DB
  MP3_QUEUE: mp3Queue
  PORT: "5052"
  RABBIT_SERVICE: rabbitmq
  VIDEO_QUEUE: videoQueue
  VIDEOS_DB_URI: mongodb://host.minikube.internal:27017/videosDB
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap465.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_BASE_URL: http://auth:5051/api/auth
  MONGO_URI: mongodb://host.minikube.internal:27017/videosDB
  MP3_MONGO_URI: mongodb://host.minikube.internal:27017/mp3DB
  MP3_QUEUE: mp3Queue
  PORT: "5050"
  RABBIT_SERVICE: rabbitmq
  VIDEO_QUEUE: videoQueue
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap466.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notifications-configmap:
apiVersion: v1
data:
  AMQP_URL: amqp://host.minikube.internal:5672
  MP3_DB_URI: mongodb://host.minikube.internal:27017/mp3DB
  MP3_QUEUE: mp3Queue
  PORT: "5053"
  RABBIT_SERVICE: rabbitmq
  VIDEO_QUEUE: videoQueue
  VIDEOS_DB_URI: mongodb://host.minikube.internal:27017/videosDB
kind: ConfigMap
metadata:
  name: notifications-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap467.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap468.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/database-configmap:
apiVersion: v1
data:
  PROTOCOL: postgresql
kind: ConfigMap
metadata:
  name: database-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap469.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DB: auth
  MYSQL_HOST: host.minikube.internal
  MYSQL_PORT: "3306"
  MYSQL_USER: auth_user
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap47.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test:
apiVersion: v1
kind: ConfigMap
metadata:
  name: test
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap470.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap471.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap472.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap473.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap474.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/okd-in-use-nginx-conf:
apiVersion: v1
data:
  nginx.conf: "user nginx;\nworker_processes  3;\nerror_log  /var/log/nginx/error.log;\nevents
    {\n  worker_connections  10240;\n}\nhttp {\n  log_format  main\n          'remote_addr:$remote_addr\\t'\n
    \         'time_local:$time_local\\t'\n          'method:$request_method\\t'\n
    \         'uri:$request_uri\\t'\n          'host:$host\\t'\n          'status:$status\\t'\n
    \         'bytes_sent:$body_bytes_sent\\t'\n          'referer:$http_referer\\t'\n
    \         'useragent:$http_user_agent\\t'\n          'forwardedfor:$http_x_forwarded_for\\t'\n
    \         'request_time:$request_time';\n  access_log\t/var/log/nginx/access.log
    main;\n  server {\n      listen       8080;\n      server_name  _;\n      location
    / {\n          root   html;\n          index  index.html index.htm;\n      }\n
    \ }\n  include /etc/nginx/virtualhost/virtualhost.conf;\n}\n"
  virtualhost.conf: |
    upstream app {
      server localhost:8080;
      keepalive 1024;
    }
    server {
      listen 8080 default_server;
      root /usr/local/app;
      access_log /var/log/nginx/app.access_log main;
      error_log /var/log/nginx/app.error_log;
      location / {
        proxy_pass http://app/;
        proxy_http_version 1.1;
      }
    }
kind: ConfigMap
metadata:
  name: okd-in-use-nginx-conf
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap475.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/okd-in-use-project-config:
apiVersion: v1
data:
  default.port: "9091"
kind: ConfigMap
metadata:
  name: okd-in-use-project-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap48.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap49.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap50.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  master.cnf: |
    [mysqld]
    log-bin
  slave.cnf: |
    [mysqld]
    super-read-only
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap507.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/word-app-config:
apiVersion: v1
data:
  words: nicht,schlecht,oder
kind: ConfigMap
metadata:
  name: word-app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap51.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-configmap:
apiVersion: v1
data:
  data-1: value-1
  data-2: value-2
kind: ConfigMap
metadata:
  name: test-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap510.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/meshcentral-config:
apiVersion: v1
data:
  config.json: |
    {
          "$schema": "https://raw.githubusercontent.com/Ylianst/MeshCentral/master/meshcentral-config-schema.json",
          "settings": {
                "plugins": {
                      "enabled": false
                },
                "cert": "meshcentral.housefam.casa",
                "port": 4430,
                "AliasPort": 443,
                "redirPort": 800,
                "AgentPong": 300,
                "TLSOffload": true
          },
          "domains": {
                "": {
                      "minify": true,
                      "localSessionRecording": false,
                      "certUrl": "https://meshcentral.housefam.casa"
                }
          }
    }
kind: ConfigMap
metadata:
  name: meshcentral-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap511.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/twitchdropsminer-config:
apiVersion: v1
data:
  settings.json: |
    {
        "autostart": false,
        "autostart_tray": false,
        "connection_quality": 1,
        "exclude": {
            "__type": "set",
            "data": [
                "Black Desert",
                "Metin2",
                "Mir Korabley",
                "NARAKA: BLADEPOINT",
                "Ninja Must Die",
                "Shakes and Fidget",
                "Summoners War: Chronicles",
                "Warhammer 40,000: Warpforge",
                "Warhaven",
                "World of Tanks",
                "World of Warships"
            ]
        },
        "language": "English",
        "priority": [
            "Assassin's Creed Shadows",
            "Cult of the Lamb",
            "Diablo IV",
            "Disney Dreamlight Valley",
            "Elite: Dangerous",
            "Last Epoch",
            "New World",
            "Overwatch 2",
            "Path of Exile",
            "Path of Exile 2",
            "Rocket League",
            "Sea of Thieves",
            "Temtem",
            "The Elder Scrolls Online",
            "Tom Clancy's The Division 2",
            "Warframe"
        ],
        "priority_only": false,
        "proxy": {
            "__type": "URL",
            "data": ""
        },
        "tray_notifications": true
    }
  startup.sh: |
    #!/bin/sh
    cp /TwitchDropsMiner/cookies.jar.import /TwitchDropsMiner/cookies.jar
    cp /TwitchDropsMiner/settings.json.import /TwitchDropsMiner/settings.json
    python -u main.py -vvv
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: twitchdropsminer
  name: twitchdropsminer-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap512.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap:
apiVersion: v1
data:
  eureka_service_address: http://eureka-0.eureka-service:8761/eureka
  foodcataloguedb_url: mysql-db-instance.cl4wekm08mox.us-east-1.rds.amazonaws.com:3306/foodcataloguedb
  orderdb_url: url_mongo
  restaurantdb_url: mysql-db-instance.cl4wekm08mox.us-east-1.rds.amazonaws.com:3306/restaurantdb
  userdb_url: mysql-db-instance.cl4wekm08mox.us-east-1.rds.amazonaws.com:3306/userdb
kind: ConfigMap
metadata:
  name: configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap52.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-set-env-config:
apiVersion: v1
data:
  key-1: value-1
  key-2: value-2
kind: ConfigMap
metadata:
  name: test-set-env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap529.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/game-demo:
apiVersion: v1
data:
  game.properties: |
    enemy.types=aliens,monsters
    player.maximum-lives=5
  player_initial_lives: "3"
  ui_properties_file_name: user-interface.properties
  user-interface.properties: |
    color.good=purple
    color.bad=yellow
    allow.textmode=true
kind: ConfigMap
metadata:
  name: game-demo
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap53.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test:
apiVersion: v1
kind: ConfigMap
metadata:
  name: test
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap530.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/config:
apiVersion: v1
data:
  DB_HOST: 127.0.0.1
  DB_PORT: "3306"
  DB_USER: user
kind: ConfigMap
metadata:
  name: config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap531.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to devproject/ConfigMap/test-config:
apiVersion: v1
data:
  class.day: weekdays
  class.name: kubernetes
kind: ConfigMap
metadata:
  name: test-config
  namespace: devproject

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap533.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  http-snippet: |
    proxy_cache_path /tmp/nginx-cache levels=1:2 keys_zone=static-cache:2m max_size=100m inactive=7d use_temp_path=off;
    proxy_cache_key $scheme$proxy_host$request_uri;
    proxy_cache_lock on;
    proxy_cache_use_stale updating;
kind: ConfigMap
metadata:
  name: ingress-nginx-controller
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap534.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  http-snippet: |
    proxy_cache_path /tmp/nginx-cache levels=1:2 keys_zone=static-cache:2m max_size=100m inactive=7d use_temp_path=off;
    proxy_cache_key $scheme$proxy_host$request_uri;
    proxy_cache_lock on;
    proxy_cache_use_stale updating;
kind: ConfigMap
metadata:
  name: ingress-nginx-controller
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap535.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  http-snippet: |
    proxy_cache_path /tmp/nginx-cache levels=1:2 keys_zone=static-cache:2m max_size=100m inactive=7d use_temp_path=off;
    proxy_cache_key $scheme$proxy_host$request_uri;
    proxy_cache_lock on;
    proxy_cache_use_stale updating;
kind: ConfigMap
metadata:
  name: ingress-nginx-controller
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap536.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  http-snippet: |
    proxy_cache_path /tmp/nginx-cache levels=1:2 keys_zone=static-cache:2m max_size=100m inactive=7d use_temp_path=off;
    proxy_cache_key $scheme$proxy_host$request_uri;
    proxy_cache_lock on;
    proxy_cache_use_stale updating;
kind: ConfigMap
metadata:
  name: ingress-nginx-controller
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap537.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to configurable/ConfigMap/configurable-env:
apiVersion: v1
data:
  Configurable__Environment: prod
  Configurable__Release: 24.01.2
kind: ConfigMap
metadata:
  name: configurable-env
  namespace: configurable

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap538.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-content:
apiVersion: v1
data:
  index.html: |-
    <!DOCTYPE html>
    <html>
      <body>
        <h1>
          Nothing to see here
        </h1>
      </body>
    </html>
kind: ConfigMap
metadata:
  labels:
    kubernetes.courselabs.co: ingress
  name: nginx-content
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap539.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  http-snippet: |
    proxy_cache_path /tmp/nginx-cache levels=1:2 keys_zone=static-cache:2m max_size=100m inactive=7d use_temp_path=off;
    proxy_cache_key $scheme$proxy_host$request_uri;
    proxy_cache_lock on;
    proxy_cache_use_stale updating;
kind: ConfigMap
metadata:
  name: ingress-nginx-controller
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap54.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap540.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/job-cleanup-script:
apiVersion: v1
data:
  run.sh: "#!/bin/sh\nkubectl config set-credentials user --token=$(cat /var/run/secrets/kubernetes.io/serviceaccount/token)
    > /dev/null\n\necho '** Deleting Completed Jobs **'\nkubectl delete jobs -n $CLEANUP_NAMESPACE
    $(kubectl get jobs -n $CLEANUP_NAMESPACE -o=jsonpath='{.items[?(@.status.conditions[0].type==\"Complete\")].metadata.name}')
    || true\n  \nif [ \"$CLEANUP_STATUS\" == \"ALL\" ]; then\n  echo '** Deleting
    Failed Jobs **'\n  kubectl delete jobs -n $CLEANUP_NAMESPACE $(kubectl get jobs
    -n $CLEANUP_NAMESPACE -o=jsonpath='{.items[?(@.status.conditions[0].type==\"Failed\")].metadata.name}')
    || true\nfi\n\necho \"** Done cleaning namespace: $CLEANUP_NAMESPACE **\""
kind: ConfigMap
metadata:
  labels:
    kubernetes.courselabs.co: jobs
  name: job-cleanup-script
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap541.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to configurable/ConfigMap/configurable-env:
apiVersion: v1
data:
  Configurable__Environment: uat
  Configurable__Release: 24.01.2
kind: ConfigMap
metadata:
  name: configurable-env
  namespace: configurable

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap542.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/simple-proxy-configmap:
apiVersion: v1
data:
  nginx.conf: "user  nginx;\nworker_processes  1;\n\nerror_log  /var/log/nginx/error.log
    warn;\npid        /var/run/nginx.pid;\n\nevents {\n  worker_connections  1024;\n}\n\nhttp
    {\n  proxy_cache_path /cache levels=1:2 keys_zone=STATIC:10m inactive=24h  max_size=1g;\n\n
    \ gzip  on;    \n  gzip_proxied any;\n\n  map $sent_http_content_type $expires
    {\n    default                    off;\n    ~image/                    6M;\n  }
    \n\n  server {\n    listen 80 default_server;\n    listen [::]:80 default_server;\n\n
    \   location / {\n        \n        proxy_pass             http://simple-statefulset;\n
    \       \n        proxy_set_header       Host $host;\n        proxy_cache            STATIC;\n
    \       proxy_cache_valid      200  1d;\n        proxy_cache_use_stale  error
    timeout invalid_header updating\n                               http_500 http_502
    http_503 http_504;\n        add_header             X-Cache     $upstream_cache_status;\n
    \       add_header             X-Host      $hostname;         \n    }\n  }\n}"
kind: ConfigMap
metadata:
  name: simple-proxy-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap544.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-config:
apiVersion: v1
data:
  enabled_plugins: |
    [rabbitmq_management,rabbitmq_peer_discovery_k8s].
  rabbitmq.conf: |
    ## Cluster formation. See https://www.rabbitmq.com/cluster-formation.html to learn more.
    cluster_formation.peer_discovery_backend  = rabbit_peer_discovery_k8s
    cluster_formation.k8s.host = kubernetes.default.svc.cluster.local
    ## Should RabbitMQ node name be computed from the pod's hostname or IP address?
    ## IP addresses are not stable, so using [stable] hostnames is recommended when possible.
    ## Set to "hostname" to use pod hostnames.
    ## When this value is changed, so should the variable used to set the RABBITMQ_NODENAME
    ## environment variable.
    cluster_formation.k8s.address_type = hostname
    ## How often should node cleanup checks run?
    cluster_formation.node_cleanup.interval = 30
    ## Set to false if automatic removal of unknown/absent nodes
    ## is desired. This can be dangerous, see
    ##  * https://www.rabbitmq.com/cluster-formation.html#node-health-checks-and-cleanup
    ##  * https://groups.google.com/forum/#!msg/rabbitmq-users/wuOfzEywHXo/k8z_HWIkBgAJ
    cluster_formation.node_cleanup.only_log_warning = true
    cluster_partition_handling = autoheal
    ## See https://www.rabbitmq.com/ha.html#master-migration-data-locality
    queue_master_locator=min-masters
    ## This is just an example.
    ## This enables remote access for the default user with well known credentials.
    ## Consider deleting the default user and creating a separate user with a set of generated
    ## credentials instead.
    ## Learn more at https://www.rabbitmq.com/access-control.html#loopback-users
    loopback_users.guest = false
kind: ConfigMap
metadata:
  name: rabbitmq-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap545.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongodep-configmap:
apiVersion: v1
data:
  databse_url: mongodep
kind: ConfigMap
metadata:
  name: mongodep-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap546.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/myconfigmap:
apiVersion: v1
data:
  DB_url: https://8080/db.com
  IP_ADDRESS: 192.80.42.168
kind: ConfigMap
metadata:
  name: myconfigmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap547.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongodb-configmap:
apiVersion: v1
data:
  database_url: mongodb-service
kind: ConfigMap
metadata:
  name: mongodb-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap55.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap550.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/not-secret-variables:
apiVersion: v1
data:
  ENV_KEY: variable_value
kind: ConfigMap
metadata:
  name: not-secret-variables
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap552.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to staging/ConfigMap/postgres-config:
apiVersion: v1
data:
  POSTGRES_PASSWORD: supersecret
  init: |
    CREATE TABLE importantdata (
    id int4 PRIMARY KEY,
    count int4 NOT NULL
    );

    INSERT INTO importantdata (id , count) VALUES (1, 0);
kind: ConfigMap
metadata:
  labels:
    app: postgres
  name: postgres-config
  namespace: staging

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap56.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  master.cnf: |
    [mysqld]
    log-bin
  slave.cnf: |
    [mysqld]
    super-read-only
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap57.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-configmap:
apiVersion: v1
data:
  data-1: value-1
  data-2: value-2
kind: ConfigMap
metadata:
  name: test-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap575.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  nginx.conf: |
    worker_processes auto;

    events {
        worker_connections 1024;
    }

    rtmp {
        server {
            listen 1935;

            application live {
                live on;
                record off;
                hls on;
                hls_path /hls/live;
                hls_fragment 3;
            }
        }
    }

    http {
        server {
            listen 8081;

            location /live {
                types {
                    application/vnd.apple.mpegurl m3u8;
                    video/mp2t;
                }
                root /hls;
            }
        }
    }
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap576.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongodb-configmap:
apiVersion: v1
data:
  ensure-users.js: |
    const rootUser = cat('/etc/k8-test/admin/MONGO_ROOT_USERNAME');
    const rootPass = cat('/etc/k8-test/admin/MONGO_ROOT_PASSWORD');
    const usersStr = cat('/etc/k8-test/MONGO_USERS_LIST');
    const adminDb = db.getSiblingDB('admin');
    adminDb.auth(rootUser, rootPass);
    print('Successfully authenticated admin user');

    const databases = ['mp3s', 'videos'];

    databases.forEach((targetDbStr) => {
      const targetDb = db.getSiblingDB(targetDbStr);
      const customRoles = adminDb
        .getRoles({ rolesInfo: 1, showBuiltinRoles: false })
        .map(role => role.role)
        .filter(Boolean);
      usersStr
        .trim()
        .split(';')
        .map(s => s.split(':'))
        .forEach(user => {
          const username = user[0];
          const rolesStr = user[1];
          const password = user[2];
          if (!rolesStr || !password) {
            return;
          }
          const roles = rolesStr.split(',');
          const userDoc = {
            user: username,
            pwd: password,
            roles: [
              { role: 'readWrite', db: targetDbStr },
              ...roles.map(role => {
                if (!~customRoles.indexOf(role)) {
                  return { role, db: targetDbStr };
                }
                return role;
              }),
            ],
          };
          try {
            targetDb.createUser(userDoc);
          } catch (err) {
            if (!~err.message.toLowerCase().indexOf('duplicate')) {
              throw err;
            }
          }
        });
    });
  mongo.conf: |
    storage:
      dbPath: /data/db
kind: ConfigMap
metadata:
  name: mongodb-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap577.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap578.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  AUTH_TABLE: auth_user
  DATABASE_HOST: db
  DATABASE_NAME: authdb
  DATABASE_USER: nasi
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap579.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MONGODB_URI: mongodb://nasi:nasi1234@mongodb:27017/mp3s?authSource=admin
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap580.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
  MONGODB_MP3S_URI: mongodb://nasi:nasi1234@mongodb:27017/mp3s?authSource=admin
  MONGODB_VIDEOS_URI: mongodb://nasi:nasi1234@mongodb:27017/videos?authSource=admin
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap581.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap588.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-configmap:
apiVersion: v1
data:
  data-1: value-1
  data-2: value-2
kind: ConfigMap
metadata:
  name: test-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap59.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/ihotraco-configmap:
apiVersion: v1
data:
  CASSANDRA_HOSTNAME: <VALUE>
  CASSANDRA_PORT: <VALUE>
  IMAGE_REPOSITORY: <VALUE>
  MAIL_HOST: <VALUE>
  MAIL_PORT: <VALUE>
  MONGO_DB: <VALUE>
  MONGO_HOST: <VALUE>
  MONGO_INITDB_DATABASE: <VALUE>
  MONGO_INITDB_ROOT_USERNAME: <VALUE>
  MONGO_PORT: <VALUE>
  MQTT_HOSTNAME: <VALUE>
  SPRING_DATA_MONGODB_HOST: <VALUE>
  URLS: <VALUE>
  finance_email: <VALUE>
  hotraco_email: <VALUE>
  java_profiles: <VALUE>
  mail-password: <VALUE>
  target_url: <VALUE>
kind: ConfigMap
metadata:
  name: ihotraco-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap590.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/quake3-server-config:
apiVersion: v1
data:
  config.yaml: |
    fragLimit: 25
    timeLimit: 15m
    bot:
      minPlayers: 3
    game:
      motd: "Welcome to Quake Kube"
      type: FreeForAll
      forceRespawn: false
      inactivity: 10m
      quadFactor: 3
      weaponRespawn: 3
    server:
      hostname: "quakekube"
      maxClients: 12
      password: "changeme"
    commands:
      - addbot sarge 2
    maps:
    - name: q3dm7
      type: FreeForAll
      timeLimit: 10m
    - name: q3dm17
      type: FreeForAll
    - name: q3wctf1
      type: CaptureTheFlag
      captureLimit: 8
    - name: q3tourney2
      type: Tournament
    - name: q3wctf3
      type: CaptureTheFlag
      captureLimit: 8
    - name: ztn3tourney1
      type: Tournament
kind: ConfigMap
metadata:
  name: quake3-server-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap593.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-creds:
apiVersion: v1
data:
  DB_HOST: 192.168.0.11
  DB_NAME: studentapp
  DB_PASSWORD: redhat123
  DB_USER: linux
kind: ConfigMap
metadata:
  name: mysql-creds
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap594.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/backend-configmap:
apiVersion: v1
data:
  dbAddr: db-service
kind: ConfigMap
metadata:
  name: backend-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap595.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DB: auth
  MYSQL_HOST: host.minikube.internal
  MYSQL_PORT: "3306"
  MYSQL_USER: auth_user
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap596.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap597.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap598.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap6.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/game-demo:
apiVersion: v1
data:
  game.properties: |
    enemy.types=aliens,monsters
    player.maximum-lives=5
  player_initial_lives: "3"
  ui_properties_file_name: user-interface.properties
  user-interface.properties: |
    color.good=purple
    color.bad=yellow
    allow.textmode=true
kind: ConfigMap
metadata:
  name: game-demo
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap600.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/kubby-create-bucket-config:
apiVersion: v1
data:
  config: |
    [default]
    region = us-east-1
kind: ConfigMap
metadata:
  name: kubby-create-bucket-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap601.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/kubby-cloudserver-config:
apiVersion: v1
data:
  config.json: |
    {
        "port": 8000,
        "listenOn": [],
        "metricsPort": 8002,
        "metricsListenOn": [],
        "replicationGroupId": "RG001",
        "restEndpoints": {
            "localhost": "us-east-1",
            "127.0.0.1": "us-east-1",
            "kubby-cloudserver": "us-east-1",
            "kubby-cloudserver.kubby.svc.cluster.local": "us-east-1"
        },
        "websiteEndpoints": [],
        "replicationEndpoints": [{
            "site": "zenko",
            "servers": ["127.0.0.1:8000"],
            "default": true
        }],
        "backbeat": {
            "host": "localhost",
            "port": 8900
        },
        "workflowEngineOperator": {
            "host": "localhost",
            "port": 3001
        },
        "cdmi": {
            "host": "localhost",
            "port": 81,
            "path": "/dewpoint",
            "readonly": true
        },
        "bucketd": {
            "bootstrap": ["localhost:9000"]
        },
        "vaultd": {
            "host": "localhost",
            "port": 8500
        },
        "clusters": 1,
        "log": {
            "logLevel": "info",
            "dumpLevel": "error"
        },
        "healthChecks": {
            "allowFrom": ["127.0.0.1/8", "::1"]
        },
        "metadataClient": {
            "host": "metadata",
            "port": 9990
        },
        "dataClient": {
            "host": "data",
            "port": 9991
        },
        "pfsClient": {
            "host": "localhost",
            "port": 9992
        },
        "metadataDaemon": {
            "bindAddress": "::",
            "port": 9990
        },
        "dataDaemon": {
            "bindAddress": "::",
            "port": 9991
        },
        "pfsDaemon": {
            "bindAddress": "localhost",
            "port": 9992
        },
        "recordLog": {
            "enabled": true,
            "recordLogName": "s3-recordlog"
        },
        "mongodb": {
            "replicaSetHosts": "mongo-mongodb-0.mongo-mongodb-headless:27017,mongo-mongodb-1.mongo-mongodb-headless:27017,mongo-mongodb-2.mongo-mongodb-headless:27017",
            "writeConcern": "majority",
            "replicaSet": "rs0",
            "readPreference": "primary",
            "database": "metadata"
        },
        "externalBackends": {},
        "requests": {
            "viaProxy": false,
            "trustedProxyCIDRs": [],
            "extractClientIPFromHeader": ""
        },
        "bucketNotificationDestinations": [
            {
                "resource": "target1",
                "type": "dummy",
                "host": "localhost:6000"
            }
        ]
    }
  locationConfig.json: |
    {
        "us-east-1": {
            "type": "file",
            "objectId": "us-east-1",
            "legacyAwsBehavior": true,
            "details": {}
        }
    }
kind: ConfigMap
metadata:
  name: kubby-cloudserver-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap602.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/kubby-cloudserver-config:
apiVersion: v1
data:
  config.json: |
    {
        "port": 8000,
        "listenOn": [],
        "metricsPort": 8002,
        "metricsListenOn": [],
        "replicationGroupId": "RG001",
        "restEndpoints": {
            "localhost": "us-east-1",
            "127.0.0.1": "us-east-1",
            "kubby-cloudserver": "us-east-1",
            "kubby-cloudserver.kubby.svc.cluster.local": "us-east-1"
        },
        "websiteEndpoints": [],
        "replicationEndpoints": [{
            "site": "zenko",
            "servers": ["127.0.0.1:8000"],
            "default": true
        }],
        "backbeat": {
            "host": "localhost",
            "port": 8900
        },
        "workflowEngineOperator": {
            "host": "localhost",
            "port": 3001
        },
        "cdmi": {
            "host": "localhost",
            "port": 81,
            "path": "/dewpoint",
            "readonly": true
        },
        "bucketd": {
            "bootstrap": ["localhost:9000"]
        },
        "vaultd": {
            "host": "localhost",
            "port": 8500
        },
        "clusters": 1,
        "log": {
            "logLevel": "info",
            "dumpLevel": "error"
        },
        "healthChecks": {
            "allowFrom": ["127.0.0.1/8", "::1"]
        },
        "metadataClient": {
            "host": "metadata",
            "port": 9990
        },
        "dataClient": {
            "host": "data",
            "port": 9991
        },
        "pfsClient": {
            "host": "localhost",
            "port": 9992
        },
        "metadataDaemon": {
            "bindAddress": "::",
            "port": 9990
        },
        "dataDaemon": {
            "bindAddress": "::",
            "port": 9991
        },
        "pfsDaemon": {
            "bindAddress": "localhost",
            "port": 9992
        },
        "recordLog": {
            "enabled": true,
            "recordLogName": "s3-recordlog"
        },
        "mongodb": {
            "replicaSetHosts": "mongo-mongodb-0.mongo-mongodb-headless:27017,mongo-mongodb-1.mongo-mongodb-headless:27017,mongo-mongodb-2.mongo-mongodb-headless:27017",
            "writeConcern": "majority",
            "replicaSet": "rs0",
            "readPreference": "primary",
            "database": "metadata"
        },
        "externalBackends": {},
        "requests": {
            "viaProxy": false,
            "trustedProxyCIDRs": [],
            "extractClientIPFromHeader": ""
        },
        "bucketNotificationDestinations": [
            {
                "resource": "target1",
                "type": "dummy",
                "host": "localhost:6000"
            }
        ]
    }
  locationConfig.json: |
    {
        "us-east-1": {
            "type": "file",
            "objectId": "us-east-1",
            "legacyAwsBehavior": true,
            "details": {}
        }
    }
kind: ConfigMap
metadata:
  name: kubby-cloudserver-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap605.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/users-config:
apiVersion: v1
data:
  DB_HOST: ""
  DB_NAME: ""
  DB_PORT: ""
  DEBUG: "True"
kind: ConfigMap
metadata:
  name: users-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap606.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/elastic-config:
apiVersion: v1
data:
  ELASTICSEARCH_HOST: elasticsearch
kind: ConfigMap
metadata:
  name: elastic-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap607.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/wikiculture-config:
apiVersion: v1
data:
  USER_SERVICE_HOST: user-service
  USER_SERVICE_PORT: "8000"
kind: ConfigMap
metadata:
  name: wikiculture-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap611.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-config:
apiVersion: v1
data:
  RABBITMQ_HOST: rabbitmq
  RABBITMQ_PORT: "5672"
kind: ConfigMap
metadata:
  name: rabbitmq-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap613.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-configmap:
apiVersion: v1
data:
  metadata.db: /directorypath/metadata.db
kind: ConfigMap
metadata:
  name: my-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap613_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/my-pod:
apiVersion: v1
kind: Pod
metadata:
  name: my-pod
  namespace: default
spec:
  containers:
  - image: your-image:tag
    name: my-container
    volumeMounts:
    - mountPath: /data
      name: config-volume
  volumes:
  - configMap:
      name: my-configmap
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/my-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/my-pod
policy disallow-default-namespace -> resource default/Pod/my-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Pod/my-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/my-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/my-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/my-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/my-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/my-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/my-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 7, fail: 8, warn: 0, error: 0, skip: 2 

##### FILE: configmap615.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/odin-api-config:
apiVersion: v1
data:
  config.yaml: |
    api:
      server:
        port: 8000
      redis:
        host: odin-redis-master
        port: 6379
        dbname: 0
kind: ConfigMap
metadata:
  name: odin-api-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap616.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/odin-healthcheck-config:
apiVersion: v1
data:
  config.yaml: |
    healthcheck:
      cron:
        timeout: 5
        pattern: "0 * * * * *"
      redis:
        host: odin-redis-master
        port: 6379
        dbname: 0
kind: ConfigMap
metadata:
  name: odin-healthcheck-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap62.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongodb-configmap:
apiVersion: v1
data:
  ensure-users.js: |
    const rootUser = cat('/etc/k8-test/admin/MONGO_ROOT_USERNAME');
    const rootPass = cat('/etc/k8-test/admin/MONGO_ROOT_PASSWORD');
    const usersStr = cat('/etc/k8-test/MONGO_USERS_LIST');
    const adminDb = db.getSiblingDB('admin');
    adminDb.auth(rootUser, rootPass);
    print('Successfully authenticated admin user');

    const databases = ['mp3s', 'videos'];

    databases.forEach((targetDbStr) => {
      const targetDb = db.getSiblingDB(targetDbStr);
      const customRoles = adminDb
        .getRoles({ rolesInfo: 1, showBuiltinRoles: false })
        .map(role => role.role)
        .filter(Boolean);
      usersStr
        .trim()
        .split(';')
        .map(s => s.split(':'))
        .forEach(user => {
          const username = user[0];
          const rolesStr = user[1];
          const password = user[2];
          if (!rolesStr || !password) {
            return;
          }
          const roles = rolesStr.split(',');
          const userDoc = {
            user: username,
            pwd: password,
            roles: [
              { role: 'readWrite', db: targetDbStr },
              ...roles.map(role => {
                if (!~customRoles.indexOf(role)) {
                  return { role, db: targetDbStr };
                }
                return role;
              }),
            ],
          };
          try {
            targetDb.createUser(userDoc);
          } catch (err) {
            if (!~err.message.toLowerCase().indexOf('duplicate')) {
              throw err;
            }
          }
        });
    });
  mongo.conf: |
    storage:
      dbPath: /data/db
kind: ConfigMap
metadata:
  name: mongodb-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap622.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/helloworld-configmap:
apiVersion: v1
data:
  game.properties: "enemy.types=aliens,monsters\nplayer.maximum-lives=6    \n"
  player_initial_lives: "5"
  ui_properties_file_name: user-interface.properties
  user-interface.properties: "color.good=purple\ncolor.bad=yellow\nallow.textmode=true
    \   \n"
kind: ConfigMap
metadata:
  name: helloworld-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap623.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/helloworld-configmap:
apiVersion: v1
data:
  ololo: "3"
kind: ConfigMap
metadata:
  name: helloworld-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap624.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/helloworld-configmap:
apiVersion: v1
data:
  ololo: "3"
kind: ConfigMap
metadata:
  name: helloworld-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap625.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-creds:
apiVersion: v1
data:
  DB_HOST: 192.168.0.11
  DB_NAME: studentapp
  DB_PASSWORD: redhat123
  DB_USER: linux
kind: ConfigMap
metadata:
  name: mysql-creds
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap626.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-conf:
apiVersion: v1
data:
  default.conf: |
    server {
      listen       80;
      server_name  localhost;
      location / {
          root   /usr/share/nginx/html;
          index  index.html index.htm;
      }
      error_page   500 502 503 504  /50x.html;
      location = /50x.html {
          root   /usr/share/nginx/html;
      }
      location /nginx_status {
        stub_status;
        allow 127.0.0.1;  #only allow requests from localhost
        deny all;   #deny all other hosts
      }
    }
kind: ConfigMap
metadata:
  name: nginx-conf
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap627.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-creds:
apiVersion: v1
data:
  DB_HOST: 192.168.0.11
  DB_NAME: studentapp
  DB_PASSWORD: redhat123
  DB_USER: linux
kind: ConfigMap
metadata:
  name: mysql-creds
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap628.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-config:
apiVersion: v1
data:
  my-property: |
    my-api-key: "123456890abcdef"
kind: ConfigMap
metadata:
  name: my-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap63.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap632.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongodb-configmap:
apiVersion: v1
data:
  database_url: mongodb-service
kind: ConfigMap
metadata:
  name: mongodb-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap633.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/goapp-config:
apiVersion: v1
data:
  greeting: Hola
kind: ConfigMap
metadata:
  name: goapp-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap634.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mssql-connection-configmap:
apiVersion: v1
data:
  db-connection-string: Server=mssql-service;Database=ProdcutsDB;User ID=SA;Password=@Aa123456789;Encrypt=False;
kind: ConfigMap
metadata:
  labels:
    app: webapp
  name: mssql-connection-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap635.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app:
apiVersion: v1
data:
  app_name: payments-svc
  app_version: v1.0
kind: ConfigMap
metadata:
  name: app
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap636.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/payments:
apiVersion: v1
data:
  app_name: payments-svc
  app_version: v1.0
kind: ConfigMap
metadata:
  name: payments
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap637.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/config:
apiVersion: v1
data:
  config: |
    address-pools:
    - name: default
      protocol: layer2
      addresses:
      - 192.168.22.100-192.168.22.150
kind: ConfigMap
metadata:
  name: config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap638.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/payments:
apiVersion: v1
data:
  app_name: payments-svc
  app_version: v1.0
kind: ConfigMap
metadata:
  name: payments
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap639.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/log-config:
apiVersion: v1
data:
  Region: Dev
  Zone: Dev
  ngsaLog: ngsadev
  webvLog: webvdev
kind: ConfigMap
metadata:
  name: log-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap64.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  AUTH_TABLE: auth_user
  DATABASE_HOST: db
  DATABASE_NAME: authdb
  DATABASE_USER: nasi
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap640.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/postgres-config:
apiVersion: v1
data:
  POSTGRES_DB: dbcar
  POSTGRES_PASSWORD: dbpass
  POSTGRES_USER: dbuser
kind: ConfigMap
metadata:
  labels:
    app: postgres
  name: postgres-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap641.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/backoffice-app:
apiVersion: v1
data:
  app_name: backoffice-app-svc
  app_version: v1.0
kind: ConfigMap
metadata:
  name: backoffice-app
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap642.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/backoffice-internal:
apiVersion: v1
data:
  app_name: backoffice-internal-svc
  app_version: v1.0
kind: ConfigMap
metadata:
  name: backoffice-internal
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap643.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/payments:
apiVersion: v1
data:
  app_name: payments-svc
  app_version: v1.0
kind: ConfigMap
metadata:
  name: payments
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap644.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/payments:
apiVersion: v1
data:
  app_name: payments-svc
  app_version: v1.0
kind: ConfigMap
metadata:
  name: payments
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap645.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/hash-data:
apiVersion: v1
data:
  greet: hello from configmap
kind: ConfigMap
metadata:
  name: hash-data
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap646.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  nginx.conf: |
    events { }

    http {
      server {
        listen 80;
        listen 443 ssl;

        ssl_certificate /etc/nginx/tls/certificado.crt;
        ssl_certificate_key /etc/nginx/tls/chave-privada.key;

        location / {
          return 200 'Ola terraqueos e extraterrestres!\n';
          add_header Content-Type text/plain;
        }
      }
    }
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap65.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MONGODB_URI: mongodb://nasi:nasi1234@mongodb:27017/mp3s?authSource=admin
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap653.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  default.conf: |
    server {
      listen 80;
      root /application/public;
      index index.php;

      add_header X-Frame-Options "SAMEORIGIN";
      add_header X-XSS-Protection "1; mode=block";
      add_header X-Content-Type-Options "nosniff";

      location / {
          try_files $uri $uri/ /index.php?$query_string;
      }

      location ~ \.php$ {
          fastcgi_pass 127.0.0.1:9000;
          fastcgi_index index.php;
          fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
          fastcgi_param DOCUMENT_ROOT $realpath_root;
          include fastcgi_params;
          fastcgi_buffers 16 16k;
          fastcgi_buffer_size 32k;
      }
    }
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap66.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
  MONGODB_MP3S_URI: mongodb://nasi:nasi1234@mongodb:27017/mp3s?authSource=admin
  MONGODB_VIDEOS_URI: mongodb://nasi:nasi1234@mongodb:27017/videos?authSource=admin
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap662.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/db-env:
apiVersion: v1
data:
  DB_HOST: postgres-db-postgresql.default.svc.cluster.local
  DB_NAME: postgres
  DB_PORT: "5432"
  DB_USERNAME: postgres
kind: ConfigMap
metadata:
  name: db-env
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap664.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/cfe-nginx-mapping:
apiVersion: v1
data:
  DEBUG: "0"
  PROJECT_NAME: CFE NGINX
kind: ConfigMap
metadata:
  name: cfe-nginx-mapping
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap665.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  POSTGRES_DB: auth
  POSTGRES_HOST: host.minikube.internal
  POSTGRES_PORT: "5432"
  POSTGRES_USER: auth_postgres
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap666.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap667.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDERcode: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap669.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-be-configmap:
apiVersion: v1
data:
  dbHost: app-postgresql
  dbPort: "5432"
kind: ConfigMap
metadata:
  name: app-be-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap67.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap670.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/hadoop-conf:
apiVersion: v1
data:
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.maximum-am-resource-percent: "0.2"
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.maximum-applications: "10000"
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.node-locality-delay: "40"
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.queue-mappings: ""
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.queue-mappings-override.enable: "false"
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.resource-calculator: org.apache.hadoop.yarn.util.resource.DefaultResourceCalculator
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.root.default.acl_administer_queue: '*'
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.root.default.acl_submit_applications: '*'
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.root.default.capacity: "100"
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.root.default.maximum-capacity: "100"
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.root.default.state: RUNNING
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.root.default.user-limit-factor: "1"
  CAPACITY-SCHEDULER.XML_yarn.scheduler.capacity.root.queues: default
  CORE-SITE.XML_fs.default.name: hdfs://namenode-0.namenode-svc.apache.svc.cluster.local
  CORE-SITE.XML_fs.defaultFS: hdfs://namenode-0.namenode-svc.apache.svc.cluster.local
  CORE-SITE.XML_hadoop.tmp.dir: /data
  HADOOP_HOME: /opt/hadoop
  HADOOP_MAPRED_HOME: /opt/hadoop
  HDFS-SITE.XML_dfs.namenode.rpc-address: namenode-0.namenode-svc.apache.svc.cluster.local:8020
  HDFS-SITE.XML_dfs.replication: "1"
  MAPRED-SITE.XML_mapreduce.application.classpath: $HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*,$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib-examples/*
  MAPRED-SITE.XML_mapreduce.framework.name: yarn
  MAPRED-SITE.XML_mapreduce.map.env: HADOOP_MAPRED_HOME=$HADOOP_HOME
  MAPRED-SITE.XML_mapreduce.reduce.env: HADOOP_MAPRED_HOME=$HADOOP_HOME
  MAPRED-SITE.XML_yarn.app.mapreduce.am.env: HADOOP_MAPRED_HOME=$HADOOP_HOME
  YARN-SITE.XML_yarn.nodemanager.aux-services: mapreduce_shuffle
  YARN-SITE.XML_yarn.nodemanager.delete.debug-delay-sec: "600"
  YARN-SITE.XML_yarn.nodemanager.env-whitelist: JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_HOME,PATH,LANG,TZ,HADOOP_MAPRED_HOME
  YARN-SITE.XML_yarn.nodemanager.pmem-check-enabled: "false"
  YARN-SITE.XML_yarn.nodemanager.vmem-check-enabled: "false"
  YARN-SITE.XML_yarn.resourcemanager.hostname: resourcemanager-0.resourcemanager-svc.apache.svc.cluster.local
kind: ConfigMap
metadata:
  name: hadoop-conf
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap678.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to relp-rsyslog/ConfigMap/rsyslog-config:
apiVersion: v1
data:
  rsyslog.conf: |
    # /etc/rsyslog.conf configuration file for rsyslog
    #
    # For more information install rsyslog-doc and see
    # /usr/share/doc/rsyslog-doc/html/configuration/index.html

    #################
    #### MODULES ####
    #################

    module(load="imuxsock") # provides support for local system logging
    #module(load="imklog")   # provides kernel logging support
    #module(load="immark")  # provides --MARK-- message capability

    # provides UDP syslog reception
    #module(load="imudp")
    #input(type="imudp" port="514")

    # provides TCP syslog reception
    #module(load="imtcp")
    #input(type="imtcp" port="514")

    ###########################
    #### GLOBAL DIRECTIVES ####
    ###########################

    #
    # Set the default permissions for all log files.
    # rsyslogd will start as root then dropped to standard user
    $FileOwner rsyslog
    $FileGroup rsyslogd
    $FileCreateMode 0640
    $DirCreateMode 0755
    $PrivDropToUser rsyslog
    $PrivDropToGroup rsyslogd
    $Umask 0022

    #
    # Where to place spool and state files
    #
    $WorkDirectory /var/spool/rsyslog

    #
    # Include all config files in /etc/rsyslog.d/
    #
    $IncludeConfig /etc/rsyslog.d/*.conf

    ###############
    #### RULES ####
    ###############

    #
    # Log anything besides private authentication messages to a single log file
    #
    *.*;auth,authpriv.none          -/var/log/syslog

    #
    # Log commonly used facilities to their own log file
    #
    auth,authpriv.*                 /var/log/auth.log
    cron.*                          -/var/log/cron.log
    kern.*                          -/var/log/kern.log
    mail.*                          -/var/log/mail.log
    user.*                          -/var/log/user.log

    #
    # Emergencies are sent to everybody logged in.
    #
    *.emerg                         :omusrmsg:*

    ## Enabling RELP
    ## RELP advanced configuration https://www.rsyslog.com/using-tls-with-relp
    ## See genkeys.txt for help with server-side only certificates generation:
    module(load="imrelp" tls.tlslib="openssl")

    # Configure the RELP input
    input(
        type="imrelp"
        port="22514"
        maxDataSize="10k"
        tls="on"
        tls.cacert="/rsyslog-certs/ca-cert.pem"
        tls.mycert="/rsyslog-certs/server-cert.pem"
        tls.myprivkey="/rsyslog-certs/server-key.pem"
        tls.tlscfgcmd="CipherString=ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384 MinProtocol=TLSv1.2 MaxProtocol=TLSv1.3"
    )
kind: ConfigMap
metadata:
  name: rsyslog-config
  namespace: relp-rsyslog

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap680.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/dados:
apiVersion: v1
data:
  DB_DATABASE: testemed
  DB_HOST: mysql
  REDIS_HOST: my-release-redis-master.default.svc.cluster.local
kind: ConfigMap
metadata:
  name: dados
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap682.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-conf:
apiVersion: v1
data:
  default.conf: |
    server {
      listen       80;
      server_name  localhost;
      location / {
          root   /usr/share/nginx/html;
          index  index.html index.htm;
      }
      error_page   500 502 503 504  /50x.html;
      location = /50x.html {
          root   /usr/share/nginx/html;
      }
      location /nginx_status {
        stub_status;
        allow 127.0.0.1;  #only allow requests from localhost
        deny all;   #deny all other hosts
      }
    }
kind: ConfigMap
metadata:
  name: nginx-conf
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap683.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/first-cm:
apiVersion: v1
data:
  Industry: E-commerce
  env: dev
  memory: 512MB
  project: flipkart
  space: login
kind: ConfigMap
metadata:
  name: first-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap684.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-set-env-config:
apiVersion: v1
data:
  key-1: value-1
  key-2: value-2
kind: ConfigMap
metadata:
  name: test-set-env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap685.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test:
apiVersion: v1
kind: ConfigMap
metadata:
  name: test
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap686.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap687.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap688.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  master.cnf: |
    [mysqld]
    log-bin
  slave.cnf: |
    [mysqld]
    super-read-only
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap689.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-configmap:
apiVersion: v1
data:
  data-1: value-1
  data-2: value-2
kind: ConfigMap
metadata:
  name: test-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap69.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DB: auth
  MYSQL_HOST: host.minikube.internal
  MYSQL_PORT: "3306"
  MYSQL_USER: auth_user
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap690.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-configmap:
apiVersion: v1
data:
  mysql.database: registry
  mysql.user: admin
kind: ConfigMap
metadata:
  name: mysql-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap691.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/backend-config:
apiVersion: v1
data:
  DJANGO_SUPERUSER_EMAIL: admin@example.com
  DJANGO_SUPERUSER_PASSWORD: admin
  DJANGO_SUPERUSER_USERNAME: admin
kind: ConfigMap
metadata:
  name: backend-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap692.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-db-config:
apiVersion: v1
data:
  db-url: localhost
kind: ConfigMap
metadata:
  name: my-db-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap692_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/myapp:
apiVersion: v1
kind: Pod
metadata:
  labels:
    name: myapp
  name: myapp
  namespace: default
spec:
  containers:
  - command:
    - sh
    - -c
    - env
    envFrom:
    - configMapRef:
        name: my-db-config
    image: busybox
    name: myapp
    resources:
      limits:
        cpu: 500m
        memory: 128Mi

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/myapp

skipped mutate policy add-safe-to-evict -> resource default/Pod/myapp
policy disallow-default-namespace -> resource default/Pod/myapp failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/myapp failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/myapp failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/myapp failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/myapp failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/myapp failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/requests/

policy require-pod-probes -> resource default/Pod/myapp failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/myapp failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/myapp failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configMap693.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/ocm-placement:
apiVersion: v1
data:
  apiVersion: apps.open-cluster-management.io/v1
  kind: placementrules
  matchKey: clusterName
  statusListKey: decisions
kind: ConfigMap
metadata:
  name: ocm-placement
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap694.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-map:
apiVersion: v1
data:
  foo: bar
kind: ConfigMap
metadata:
  name: my-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap697.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongodb-configmap:
apiVersion: v1
data:
  database_url: mongodb-service
kind: ConfigMap
metadata:
  name: mongodb-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap698.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  SERVER_HOST: server-service
  SERVER_PORT: "8000"
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap703.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  allow-snippet-annotations: "true"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/component: controller
    app.kubernetes.io/instance: ingress-nginx
    app.kubernetes.io/name: ingress-nginx
  name: ingress-nginx-controller
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap704.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  APP_COLOR: blue
  APP_MODE: prod
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap712.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to wp-ivan/ConfigMap/datos-bbdd:
apiVersion: v1
data:
  nombre: miwp
kind: ConfigMap
metadata:
  name: datos-bbdd
  namespace: wp-ivan

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap713.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  nginx.conf: |
    worker_processes auto;
    events { worker_connections 1024; }
    http {
      server {
        listen 8080;
        location / {
          add_header Content-Type text/plain;
          return 200 'Hello, world!';
        }
      }
    }
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap717.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/msvc-usuarios:
apiVersion: v1
data:
  curso_url: msvc-cursos:8002
  database: msvc_usuarios
  db_host: docker-mariadb-db:3306
  lb_auth_issuer_uri: http://172.22.77.4:31358
  lb_usuarios_uri: http://172.22.77.4:31457
  msvc-usuarios.yaml: |-
    config:
      texto: Configurando ambiente por defecto
    ---
    spring:
      config:
        activate:
          on-profile: dev
    config:
      texto: Configurando ambiente de desarrollo
    ---
    spring:
      config:
        activate:
          on-profile: pro
    config:
      texto: Configurando ambiente de produccion
  port: "8001"
  super_password: root-secret-development
kind: ConfigMap
metadata:
  name: msvc-usuarios
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap717_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/msvc-cursos:
apiVersion: v1
data:
  database: msvc_cursos
  db_host: docker-postgres-db:5432
  port: "8002"
  usuario_url: msvc-usuarios:8001
kind: ConfigMap
metadata:
  name: msvc-cursos
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap718.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongodb-configmap:
apiVersion: v1
data:
  ensure-users.js: |
    const rootUser = cat('/etc/k8-test/admin/MONGO_ROOT_USERNAME');
    const rootPass = cat('/etc/k8-test/admin/MONGO_ROOT_PASSWORD');
    const usersStr = cat('/etc/k8-test/MONGO_USERS_LIST');
    const adminDb = db.getSiblingDB('admin');
    adminDb.auth(rootUser, rootPass);
    print('Successfully authenticated admin user');

    const databases = ['mp3s', 'videos'];

    databases.forEach((targetDbStr) => {
      const targetDb = db.getSiblingDB(targetDbStr);
      const customRoles = adminDb
        .getRoles({ rolesInfo: 1, showBuiltinRoles: false })
        .map(role => role.role)
        .filter(Boolean);
      usersStr
        .trim()
        .split(';')
        .map(s => s.split(':'))
        .forEach(user => {
          const username = user[0];
          const rolesStr = user[1];
          const password = user[2];
          if (!rolesStr || !password) {
            return;
          }
          const roles = rolesStr.split(',');
          const userDoc = {
            user: username,
            pwd: password,
            roles: [
              { role: 'readWrite', db: targetDbStr },
              ...roles.map(role => {
                if (!~customRoles.indexOf(role)) {
                  return { role, db: targetDbStr };
                }
                return role;
              }),
            ],
          };
          try {
            targetDb.createUser(userDoc);
          } catch (err) {
            if (!~err.message.toLowerCase().indexOf('duplicate')) {
              throw err;
            }
          }
        });
    });
  mongo.conf: |
    storage:
      dbPath: /data/db
kind: ConfigMap
metadata:
  name: mongodb-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap719.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap720.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  AUTH_TABLE: auth_user
  DATABASE_HOST: db
  DATABASE_NAME: authdb
  DATABASE_USER: nasi
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap721.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MONGODB_URI: mongodb://nasi:nasi1234@mongodb:27017/mp3s?authSource=admin
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap722.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
  MONGODB_MP3S_URI: mongodb://nasi:nasi1234@mongodb:27017/mp3s?authSource=admin
  MONGODB_VIDEOS_URI: mongodb://nasi:nasi1234@mongodb:27017/videos?authSource=admin
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap723.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap724.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to cti-svcs-cdso-gdk-169643/ConfigMap/elasticsearch-kibana-conf:
apiVersion: v1
data:
  kibana.yml: |
    pid.file: /opt/bitnami/kibana/tmp/kibana.pid
    server.host: "::"
    server.port: 5601
    elasticsearch.hosts: [https://elasticsearch:9200]
    server.rewriteBasePath: false
    xpack.encryptedSavedObjects.encryptionKey: ABCDEFGHIJKLMNOPQRSTUVWXABCDEFGH
    xpack.reporting.encryptionKey: ABCDEFGHIJKLMNOPQRSTUVWXABCDEFGH
    xpack.security.encryptionKey: ABCDEFGHIJKLMNOPQRSTUVWXABCDEFGH
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: elasticsearch
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: kibana
    app.kubernetes.io/version: 8.12.0
    helm.sh/chart: kibana-10.8.0
  name: elasticsearch-kibana-conf
  namespace: cti-svcs-cdso-gdk-169643

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap725.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/databaseproject-configmap:
apiVersion: v1
data:
  MONGO_DB_HOST: databaseproject-mongodb-service
  MONGO_DB_NAME: databaseproject
  MONGO_DB_PORT: "27017"
kind: ConfigMap
metadata:
  name: databaseproject-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap727.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/simplebank-config:
apiVersion: v1
data:
  postgres-url: postgresql://root:secret@host.minikube.internal:5432/simple_bank?sslmode=disable
kind: ConfigMap
metadata:
  name: simplebank-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap728.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to k8s-apps/ConfigMap/internal-app-configmap:
apiVersion: v1
data:
  spring_profiles_active: local
kind: ConfigMap
metadata:
  name: internal-app-configmap
  namespace: k8s-apps

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap729.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to k8s-apps/ConfigMap/mongo-db-configmap:
apiVersion: v1
data:
  database_url: mongo-db
kind: ConfigMap
metadata:
  name: mongo-db-configmap
  namespace: k8s-apps

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap732.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to network/ConfigMap/cloudflare-ddns-configmap:
apiVersion: v1
data:
  DELETE_ON_STOP: "false"
  DOMAINS: cjsolsen.com
  IP6_PROVIDER: none
  PROXIED: "true"
  QUIET: "false"
  TZ: Europe/Zurich
  UPDATE_CRON: '@every 10m'
kind: ConfigMap
metadata:
  name: cloudflare-ddns-configmap
  namespace: network

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap733.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to observability/ConfigMap/gatus:
apiVersion: v1
data:
  config.yaml: |
    storage:
      type: postgres
      path: postgres://${GATUS_USER}:${GATUS_PASSWD}@gatus-cluster-rw.database.svc.cluster.local:5432/gatus?sslmode=disable
      caching: true
    metrics: true
    debug: false
    ui:
      title: Status | Gatus
      header: Status
      dark-mode: true
    alerting:
      pushover:
        application-token: ${PUSHOVER_TOKEN}
        user-key: ${PUSHOVER_USER_KEY}
        default-alert:
          description: "Health Check Failed!"
          send-on-resolved: true
          failure-threshold: 2
          success-threshold: 2
    endpoints:
      - name: Death - Ping
        group: Nodes
        url: "icmp://10.10.30.2"
        interval: 1m
        conditions:
          - "[CONNECTED] == true"
        alerts:
          - type: pushover
      - name: Black - Ping
        group: Nodes
        url: "icmp://10.10.30.3"
        interval: 1m
        conditions:
          - "[CONNECTED] == true"
        alerts:
          - type: pushover
      - name: Thrash - Ping
        group: Nodes
        url: "icmp://10.10.30.4"
        interval: 1m
        conditions:
          - "[CONNECTED] == true"
        alerts:
          - type: pushover
      - name: External DNS
        group: DNS
        url: "1.1.1.1" # Address of the DNS server to use
        interval: 5m
        dns:
          query-name: "cjsolsen.com"
          query-type: "A"
        conditions:
          - "[DNS_RCODE] == NOERROR"
        alerts:
          - type: pushover
      - name: Internal DNS
        group: DNS
        url: "10.10.30.1" # Address of the DNS server to use
        interval: 5m
        dns:
          query-name: "grafana.local.cjsolsen.com"
          query-type: "A"
        conditions:
          - "[BODY] == 10.10.30.71"
          - "[DNS_RCODE] == NOERROR"
        alerts:
          - type: pushover
kind: ConfigMap
metadata:
  name: gatus
  namespace: observability

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap740.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to kube-system/ConfigMap/pull-through-webhook:
apiVersion: v1
data:
  registries.yaml: |
    awsRegion: us-east-1
    awsAccountId: 123456789012
    registries:
      - quay.io
      - docker.io
      - ghcr.io
      - registry.k8s.io
kind: ConfigMap
metadata:
  name: pull-through-webhook
  namespace: kube-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap745.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/caddy-configmap:
apiVersion: v1
data:
  Caddyfile: |
    registry.alexbissessur.dev {
      reverse_proxy localhost:5000
      tls
    }
    test.alexbissessur.dev {
      respond "Test Works"
      tls
    }
kind: ConfigMap
metadata:
  name: caddy-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap747.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  nginx.conf: |
    server {
        listen 80;
        server_name localhost;
        location / {
            root /usr/share/nginx/html;
            index index.html;
        }
    }
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap748.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/${APP}-gatus-ep:
apiVersion: v1
data:
  config.yaml: |
    endpoints:
      - name: "${APP}"
        group: internal-backend
        url: "${GATUS_DNS_IP}"
        interval: 1m
        dns:
          query-name: "google.com"
          query-type: "A"
        conditions:
          - "[DNS_RCODE] == NOERROR"
        alerts:
          - type: discord
            send-on-resolved: true
            failure-threshold: 2
kind: ConfigMap
metadata:
  labels:
    gatus.io/enabled: "true"
  name: ${APP}-gatus-ep
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap753.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to twistlock/ConfigMap/defender-updater-script-configmap:
apiVersion: v1
data:
  DefenderUpdater.sh: "#!/bin/bash\n\necho -e \"* Setting Env Variables...\\n\"\n#
    Set needed variables for the script\nset -a\nAK=$AK\nSK=$SK\nAPI_URL=\"https://us-east1.cloud.twistlock.com/us-2-158286553\"\nAUTH_ENDPOINT=\"api/v1/authenticate\"\nIMAGE_NAME_ENDPOINT=\"api/v1/defenders/image-name\"\nDAEMONSET_NAME=\"twistlock-defender-ds\"\nCONTAINER_NAME=\"twistlock-defender\"\nNAMESPACE=\"twistlock\"\n\necho
    -e \"* Getting CWPP API AuthN Token...\\n\"\n# Get token for CWP API Request,
    needs jq binary installed\nTOKEN=$(curl --location \"$API_URL/$AUTH_ENDPOINT\"
    --header 'content-type: application/json' --data '{\"username\": \"'\"$AK\"'\",
    \"password\": \"'\"$SK\"'\"}' | jq -r '.token')\n# Print token value\necho $TOKEN\n\necho
    -e \"\\n* Getting Latest Defender Docker Image Name...\\n\"\n# Get Latest Defender
    Docker Image Name from the CWP API \nNEW_IMAGE=$(curl -X GET --location \"$API_URL/$IMAGE_NAME_ENDPOINT\"
    --header \"Authorization: Bearer $TOKEN\" --header 'Content-Type: application/json'
    --data '')\n# Delete doble quotes around Docker Image value\nNEW_IMAGE=\"${NEW_IMAGE//\\\"/}\"\n#
    Print Latest Defender Docker Image Name\necho $NEW_IMAGE\n\necho -e \"\\n* Updating
    Daemonset defender image...\\n\"\n# Updates image container into Defender Daemonset
    with new image version and add the command to annotations\nkubectl set image daemonset/$DAEMONSET_NAME
    $CONTAINER_NAME=$NEW_IMAGE -n $NAMESPACE --record\n\necho -e \"* Adding annotation
    to defender daemonset with timestamp & reason execution...\\n\"\n# Adds annotation
    to defender daemonset with timestamp & reason execution\nkubectl annotate daemonset
    $DAEMONSET_NAME kubernetes.io/change-cause=\"Defender updated by CronJob with
    latest docker image at $(date -u +'%!Y(MISSING)-%!m(MISSING)-%!d(MISSING)T%!H(MISSING):%!M(MISSING):%!S(MISSING)Z')\" -n $NAMESPACE\n"
kind: ConfigMap
metadata:
  name: defender-updater-script-configmap
  namespace: twistlock

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap754.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  primary.cnf: |
    # Modificacin del primario
    [mysqld]
    log-bin
  replica.cnf: |
    # Modificacin de los secundarios
    [mysqld]
    super-read-only
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap755.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-set-env-config:
apiVersion: v1
data:
  key-1: value-1
  key-2: value-2
kind: ConfigMap
metadata:
  name: test-set-env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap756.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test:
apiVersion: v1
kind: ConfigMap
metadata:
  name: test
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap757.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap758.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap759.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  master.cnf: |
    [mysqld]
    log-bin
  slave.cnf: |
    [mysqld]
    super-read-only
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap760.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-configmap:
apiVersion: v1
data:
  data-1: value-1
  data-2: value-2
kind: ConfigMap
metadata:
  name: test-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap761.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-set-env-config:
apiVersion: v1
data:
  key-1: value-1
  key-2: value-2
kind: ConfigMap
metadata:
  name: test-set-env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap762.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test:
apiVersion: v1
kind: ConfigMap
metadata:
  name: test
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap763.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap764.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/the-map:
apiVersion: v1
data:
  altGreeting: Good Morning!
  enableRisky: "false"
kind: ConfigMap
metadata:
  name: the-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap765.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  master.cnf: |
    [mysqld]
    log-bin
  slave.cnf: |
    [mysqld]
    super-read-only
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap766.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-configmap:
apiVersion: v1
data:
  data-1: value-1
  data-2: value-2
kind: ConfigMap
metadata:
  name: test-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap767.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/config-volumen:
apiVersion: v1
data:
  ENTORNO: desarrollo
  VERSION: "1.0"
kind: ConfigMap
metadata:
  name: config-volumen
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap769.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/prometheus-config:
apiVersion: v1
data:
  prometheus.yml: "global:\n  scrape_interval: 15s\n\nscrape_configs:\n  - job_name:
    'prometheus'\n    static_configs:\n      - targets: ['prometheus.default:9090']
    #    Prometheus\n  \n  - job_name: 'postgres-exporter'\n    static_configs:\n
    \     - targets: ['postgres-exporter.default:9187'] #    IP-
     PostgreSQL\n  \n  - job_name: 'redis-exporter'\n    static_configs:\n
    \     - targets: ['redis-exporter.default:9121'] #    IP- 
    Redis\n"
kind: ConfigMap
metadata:
  name: prometheus-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap770.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to authority/ConfigMap/enable-config:
apiVersion: v1
data:
  Cleverbit__Enabled: "true"
kind: ConfigMap
metadata:
  name: enable-config
  namespace: authority

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap771.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/vault-config:
apiVersion: v1
data:
  extraconfig-from-values.hcl: |-
    disable_mlock = true
    ui = true

    listener "tcp" {
      tls_disable = 1
      address = "[::]:8200"
      cluster_address = "[::]:8201"
    }
    storage "file" {
      path = "/vault/data"
    }
kind: ConfigMap
metadata:
  name: vault-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap775.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/demo-config:
apiVersion: v1
data:
  config: |
    greeting: Buongiorno
kind: ConfigMap
metadata:
  name: demo-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap779.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to weaviate/ConfigMap/weaviate-config:
apiVersion: v1
data:
  conf.yaml: |-
    authentication:
      anonymous_access:
        enabled: true
      oidc:
        enabled: false
    authorization:
      admin_list:
        enabled: false

    query_defaults:
      limit: 100
    debug: false
  player_initial_lives: "3"
  ui_properties_file_name: user-interface.properties
kind: ConfigMap
metadata:
  name: weaviate-config
  namespace: weaviate

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap781.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to cnpg-system/ConfigMap/cnpg-controller-manager-config:
apiVersion: v1
data:
  INHERITED_LABELS: app.kubernetes.io/part-of, app.kubernetes.io/managed-by, backstage.io/kubernetes-id
kind: ConfigMap
metadata:
  name: cnpg-controller-manager-config
  namespace: cnpg-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap782.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to kube-system/ConfigMap/coredns-custom:
apiVersion: v1
data:
  keycloak.override: |
    rewrite name substring sso.local.lan.vernal.dev keycloak-secure.keycloak.svc.cluster.local
kind: ConfigMap
metadata:
  name: coredns-custom
  namespace: kube-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap784.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-config:
apiVersion: v1
data:
  COMPANY: Fareye
  EMP_ID: FE2247
  HOST: http://hellonode-service:3000/hello
  USERNAME: Piyush
kind: ConfigMap
metadata:
  name: my-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap786.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/macy-env:
apiVersion: v1
data:
  DB_URL: https://demo:27017
kind: ConfigMap
metadata:
  name: macy-env
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap791.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/k8-env:
apiVersion: v1
data:
  sidecarconfig.yaml: |
    env:
    - name: demo
      Value: demo
kind: ConfigMap
metadata:
  labels:
    app: k8-env
  name: k8-env
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap799.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to mail-system/ConfigMap/spf-config:
apiVersion: v1
data:
  policyd-spf.conf: |
    debugLevel = 1
    TestOnly = 1
    HELO_reject = Fail
    Mail_From_reject = Fail
    PermError_reject = False
    TempError_Defer = False
    skip_addresses = 127.0.0.0/8,::ffff:127.0.0.0/104,::1
    Whitelist =  ${CONFIG_NGINX_WHITELIST}
    # Domain_Whitelist = mx1.not-example.com,mx2.not-example.com
    Reason_Message = Message {rejectdefer} due to: {spf}.
kind: ConfigMap
metadata:
  name: spf-config
  namespace: mail-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap8.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/simplebank-config:
apiVersion: v1
data:
  postgres-url: postgresql://root:secret@host.minikube.internal:5432/simple_bank?sslmode=disable
kind: ConfigMap
metadata:
  name: simplebank-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap82.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/dados:
apiVersion: v1
data:
  DB_DATABASE: testemed
  DB_HOST: mysql
kind: ConfigMap
metadata:
  name: dados
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap825.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/ntfy-server-config:
apiVersion: v1
data:
  NTFY_AUTH_DEFAULT_ACCESS: deny-all
  NTFY_AUTH_FILE: /var/lib/ntfy/user.db
  NTFY_BASE_URL: https://ntfy.solonsstuff.com
  NTFY_UPSTREAM_BASE_URL: https://ntfy.sh
kind: ConfigMap
metadata:
  name: ntfy-server-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap826.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/test-config-map:
apiVersion: v1
data:
  key1: val1
  key2: val2
kind: ConfigMap
metadata:
  labels:
    example: label1
  name: test-config-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap83.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to logging/ConfigMap/fluent-bit:
apiVersion: v1
data:
  custom_parsers.conf: |
    [PARSER]
        Name docker_no_time
        Format json
        Time_Keep Off
        Time_Key time
        Time_Format %!Y(MISSING)-%!m(MISSING)-%!d(MISSING)T%!H(MISSING):%!M(MISSING):%!S(MISSING).%!L(MISSING)

    [PARSER]
        Name syslog-rfc3164-nopri
        Format regex
        Regex /^(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$/
        Time_Key time
        Time_Format %!b(MISSING) %!d(MISSING) %!H(MISSING):%!M(MISSING):%!S(MISSING)
        Time_Keep Off
        Time_Offset +0200
  fluent-bit.conf: |
    [SERVICE]
        Daemon Off
        Flush 1
        Log_Level debug
        Parsers_File parsers.conf
        Parsers_File custom_parsers.conf
        HTTP_Server On
        HTTP_Listen 0.0.0.0
        HTTP_Port 2020
        Health_Check On

    [INPUT]
        name opentelemetry
        listen 0.0.0.0
        port 4318
        Tag otel.*

    [INPUT]
        Name tail
        Path /var/log/containers/*.log
        Exclude_Path /var/log/containers/*_logging_*.log
        Parser cri
        Tag kube.*
        Read_from_Head true
        Buffer_Chunk_Size 10MB
        Buffer_Max_Size 40MB
        Mem_Buf_Limit 512MB
        Refresh_Interval 5

    [INPUT]
        Name tail
        Path /var/log/syslog
        Parser syslog-rfc3164-nopri
        Tag syslog.*
        Read_from_Head true
        Buffer_Chunk_Size 10MB
        Buffer_Max_Size 40MB
        Mem_Buf_Limit 512MB
        Refresh_Interval 5

    [FILTER]
        Name kubernetes
        Match kube.*
        Merge_Log On
        K8S-Logging.Parser Off
        K8S-Logging.Exclude Off
        Buffer_Size 10MB

    [FILTER]
        Name nest
        Match kube.*
        Operation lift
        Nested_under kubernetes

    [FILTER]
        Name modify
        Match kube.*
        Rename message log
        Rename pod_name k2s.pod.name
        Rename namespace_name k2s.namespace.name
        Rename host k2s.host.name
        Remove container_image
        Remove docker_id
        Remove container_name
        Remove pod_id
        Remove annotations
        Remove labels
        Remove time
        Remove logtag
        Remove container_hash

    [FILTER]
        Name modify
        Match syslog.*
        Rename message log
        Rename host k2s.host.name

    [FILTER]
        Name     throttle
        Match    *
        Rate     800
        Window   3
        Print_Status  true
        Interval 30s

    [OUTPUT]
        Name opensearch
        Match *
        Host opensearch-cluster-master.logging.svc.cluster.local
        Port 9200
        Index k2s
        Buffer_Size 10MB
        Suppress_Type_Name On
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: fluent-bit
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: fluent-bit
    app.kubernetes.io/version: 3.0.4
    helm.sh/chart: fluent-bit-0.46.7
  name: fluent-bit
  namespace: logging

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap834.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/${APP}-health-check:
apiVersion: v1
data:
  health_check.sh: |
    #!/bin/sh
    response=$(wget --spider -S http://localhost/api/v1/status 2>&1 | grep "HTTP/" | awk '{print $2}')
    if [ "$response" != "200" ]; then
      echo "Health check failed - HTTP status $response"
      exit 1
    fi
kind: ConfigMap
metadata:
  name: ${APP}-health-check
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap835.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/${APP}-health-check:
apiVersion: v1
data:
  health_check.sh: |
    #!/bin/sh
    response=$(wget -q -O- http://localhost/ping | jq -r '.status')
    if [ "$response" != "OK" ]; then
      echo "$response"
      exit 1
    fi
kind: ConfigMap
metadata:
  name: ${APP}-health-check
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap836.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/health-check:
apiVersion: v1
data:
  health_check.sh: |
    #!/bin/sh
    response=$(wget -q -O- http://localhost/ping | jq -r '.status')
    if [ "$response" != "OK" ]; then
      echo "$response"
      exit 1
    fi
kind: ConfigMap
metadata:
  name: health-check
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap837.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/${APP}-health-check:
apiVersion: v1
data:
  health_check.sh: |
    #!/bin/sh
    response=$(wget -q -O- http://localhost/ping | jq -r '.status')
    if [ "$response" != "OK" ]; then
      echo "$response"
      exit 1
    fi
kind: ConfigMap
metadata:
  name: ${APP}-health-check
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap838.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/discordbot-config:
apiVersion: v1
data:
  EMOJI_STRING: "\U0001F9EA"
  LOG_LEVEL: DEBUG
  SREF_REACT: "\U0001F9D1"
kind: ConfigMap
metadata:
  name: discordbot-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap839.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/discordbot-config:
apiVersion: v1
data:
  LOG_LEVEL: INFO
kind: ConfigMap
metadata:
  name: discordbot-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap84.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to logging/ConfigMap/opensearch-cluster-master-config:
apiVersion: v1
data:
  opensearch.yml: |
    cluster.name: opensearch-cluster

    # Bind to all interfaces because we don't know what IP address Docker will assign to us.
    network.host: 0.0.0.0

    # Setting network.host to a non-loopback address enables the annoying bootstrap checks. "Single-node" mode disables them again.
    # Implicitly done if ".singleNode" is set to "true".
    # discovery.type: single-node

    # Plutono integration
    http.cors.enabled : true
    http.cors.allow-origin: "*"

    # Start OpenSearch Security Demo Configuration
    # WARNING: revise all the lines below before you go into production
    plugins:
      security:
        disabled: true
        ssl:
          transport:
            pemcert_filepath: esnode.pem
            pemkey_filepath: esnode-key.pem
            pemtrustedcas_filepath: root-ca.pem
            enforce_hostname_verification: false
          http:
            enabled: true
            pemcert_filepath: esnode.pem
            pemkey_filepath: esnode-key.pem
            pemtrustedcas_filepath: root-ca.pem
        allow_unsafe_democertificates: true
        allow_default_init_securityindex: true
        authcz:
          admin_dn:
            - CN=kirk,OU=client,O=client,L=test,C=de
        audit.type: internal_opensearch
        enable_snapshot_restore_privilege: true
        check_snapshot_restore_write_privileges: true
        restapi:
          roles_enabled: ["all_access", "security_rest_api_access"]
        system_indices:
          enabled: true
          indices:
            [
              ".opendistro-alerting-config",
              ".opendistro-alerting-alert*",
              ".opendistro-anomaly-results*",
              ".opendistro-anomaly-detector*",
              ".opendistro-anomaly-checkpoints",
              ".opendistro-anomaly-detection-state",
              ".opendistro-reports-*",
              ".opendistro-notifications-*",
              ".opendistro-notebooks",
              ".opendistro-asynchronous-search-response*",
            ]
    ######## End OpenSearch Security Demo Configuration ########
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/component: opensearch-cluster-master
    app.kubernetes.io/instance: opensearch
    app.kubernetes.io/name: opensearch
  name: opensearch-cluster-master-config
  namespace: logging

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap847.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to game-servers/ConfigMap/minecraft-configmap:
apiVersion: v1
data:
  AUTOPAUSE_TIMEOUT_EST: ""
  AUTOPAUSE_TIMEOUT_INIT: ""
  DIFFICULTY: ""
  ENABLE_AUTOPAUSE: ""
  ENABLE_WHITELIST: ""
  EULA: ""
  EXISTING_OPS_FILE: ""
  EXISTING_WHITELIST_FILE: ""
  MAX_MEMORY: ""
  MAX_TICK_TIME: ""
  MOTD: ""
  ONLINE_MODE: ""
  OPS: ""
  OVERRIDE_SERVER_PROPERTIES: ""
  SERVER_NAME: ""
  TYPE: ""
  VERSION: ""
  VIEW_DISTANCE: ""
  WHITELIST: ""
kind: ConfigMap
metadata:
  name: minecraft-configmap
  namespace: game-servers

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap85.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to monitoring/ConfigMap/kube-prometheus-stack-plutono:
apiVersion: v1
data:
  plutono.ini: |
    [analytics]
    check_for_updates = true
    [grafana_net]
    url = https://grafana.net
    [log]
    mode = console
    # [log.console]
    # level=debug
    [paths]
    data = /var/lib/plutono/
    logs = /var/log/plutono
    plugins = /var/lib/plutono/plugins
    provisioning = /etc/plutono/provisioning
    [server]
    # these settings needed to make it work with Ingress
    root_url = https://k2s.cluster.local/monitoring
    serve_from_sub_path = true
    domain = k2s.cluster.local
    [auth]
    oauth_auto_login: true
    signout_redirect_url: "https://k2s.cluster.local/oauth2/sign_out"
    [auth.proxy]
    enabled: true
    header_name: X-Email
    header_property: email
    auto_sign_up: true
    [users]
    allow_sign_up: false
    auto_assign_org: true
    auto_assign_org_role: Viewer
    [auth.anonymous]
    enabled = true
    org_role = Viewer
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: kube-prometheus-stack
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: kube-prometheus-stack-plutono
    app.kubernetes.io/version: 9.5.5
    helm.sh/chart: grafana-6.57.4
  name: kube-prometheus-stack-plutono
  namespace: monitoring

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap86.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to registry/ConfigMap/registry-config:
apiVersion: v1
data:
  config.yml: |
    version: 0.1
    log:
      fields:
        service: registry
    storage:
      delete:
        enabled: true
      cache:
        blobdescriptor: inmemory
      filesystem:
        rootdirectory: /var/lib/registry
    validation:
      disabled: true
    http:
      addr: :5000
      headers:
    health:
      storagedriver:
        enabled: true
        threshold: 3
kind: ConfigMap
metadata:
  name: registry-config
  namespace: registry

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap87.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/config-json:
apiVersion: v1
data:
  config.json: |
    {
      "routerBasename": "/viewer/",
      "extensions": [],
      "modes": [],
      "customizationService": {},
      "showStudyList": true,
      "maxNumberOfWebWorkers": 3,
      "showWarningMessageForCrossOrigin": false,
      "showCPUFallbackMessage": true,
      "showLoadingIndicator": true,
      "useSharedArrayBuffer": "FALSE",
      "strictZSpacingForVolumeViewport": true,
      "groupEnabledModesFirst": true,
      "maxNumRequests": {
      "interaction": 100,
      "thumbnail": 75,
      "prefetch": 25
      },
      "dataSources": [
      {
        "namespace": "@ohif/extension-default.dataSourcesModule.dicomweb",
        "sourceName": "DataFromAWS",
        "configuration": {
        "friendlyName": "AWS S3 Static wado server",
        "name": "aws",
        "wadoUriRoot": "https://d33do7qe4w26qo.cloudfront.net/dicomweb",
        "qidoRoot": "https://d33do7qe4w26qo.cloudfront.net/dicomweb",
        "wadoRoot": "https://d33do7qe4w26qo.cloudfront.net/dicomweb",
        "qidoSupportsIncludeField": false,
        "imageRendering": "wadors",
        "thumbnailRendering": "wadors",
        "enableStudyLazyLoad": true,
        "supportsFuzzyMatching": false,
        "supportsWildcard": true,
        "staticWado": true,
        "singlepart": "bulkdata,video",
        "bulkDataURI": {
          "enabled": true,
          "relativeResolution": "studies"
        },
        "omitQuotationForMultipartRequest": true
        }
      },
      {
        "namespace": "@ohif/extension-default.dataSourcesModule.dicomweb",
        "sourceName": "dataFromDicomAddon",
        "configuration": {
        "friendlyName": "Dicom addon static wado server",
        "name": "Dicom addon",
        "wadoUriRoot": "http://k2s.cluster.local/dicom/dicomweb",
        "qidoRoot": "http://k2s.cluster.local/dicom/dicomweb",
        "wadoRoot": "http://k2s.cluster.local/dicom/dicomweb",
        "qidoSupportsIncludeField": false,
        "imageRendering": "wadors",
        "thumbnailRendering": "wadors",
        "enableStudyLazyLoad": true,
        "supportsFuzzyMatching": false,
        "supportsWildcard": true,
        "staticWado": true,
        "singlepart": "bulkdata,video",
        "bulkDataURI": {
          "enabled": true,
          "relativeResolution": "studies"
        },
        "omitQuotationForMultipartRequest": true
        }
      },
      {
        "namespace": "@ohif/extension-default.dataSourcesModule.dicomweb",
        "sourceName": "dataFromDicomAddonTls",
        "configuration": {
        "friendlyName": "Dicom addon static wado server",
        "name": "Dicom addon",
        "wadoUriRoot": "https://k2s.cluster.local/dicom/dicomweb",
        "qidoRoot": "https://k2s.cluster.local/dicom/dicomweb",
        "wadoRoot": "https://k2s.cluster.local/dicom/dicomweb",
        "qidoSupportsIncludeField": false,
        "imageRendering": "wadors",
        "thumbnailRendering": "wadors",
        "enableStudyLazyLoad": true,
        "supportsFuzzyMatching": false,
        "supportsWildcard": true,
        "staticWado": true,
        "singlepart": "bulkdata,video",
        "bulkDataURI": {
          "enabled": true,
          "relativeResolution": "studies"
        },
        "omitQuotationForMultipartRequest": true
        }
      }
      ],
      "defaultDataSourceName": "DataFromAWS"
    }
kind: ConfigMap
metadata:
  name: config-json
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap877.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/locust-script-cm:
apiVersion: v1
data:
  locustfile.py: |
    from locust import HttpUser, between, task
    import time


    class Quickstart(HttpUser):
        wait_time = between(1, 5)

        @task
        def google(self):
            self.client.request_name = "google"
            self.client.get("https://google.com/")

        @task
        def microsoft(self):
            self.client.request_name = "microsoft"
            self.client.get("https://microsoft.com/")

        @task
        def facebook(self):
            self.client.request_name = "facebook"
            self.client.get("https://facebook.com/")
kind: ConfigMap
metadata:
  name: locust-script-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap880.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to aprenda-golang/ConfigMap/api-cm:
apiVersion: v1
data:
  REDIS_HOST: redis.aprenda-golang.svc.cluster.local
  REDIS_PORT: "6379"
  SERVER_PORT: "8000"
kind: ConfigMap
metadata:
  name: api-cm
  namespace: aprenda-golang

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap884.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/ascentfronend-config:
apiVersion: v1
data:
  VITE_AUTHENTICATION_SERVICE_URI: https://aflahaflu.shop/api/auth-service
  VITE_CLOUDINARY_URL: https://api.cloudinary.com/v1_1/dzaoju6lr/image/upload
  VITE_CLOUDINARY_VIDEO_URL: https://api.cloudinary.com/v1_1/dzaoju6lr/video/upload
  VITE_COMMUNICATION_SERVICE: https://aflahaflu.shop/api/communication-service
  VITE_COMPANY_SERVICE: https://aflahaflu.shop/api/company-service
  VITE_GOOGLE_CLIEND_ID: 1093148345924-5iolpvqk2u8g5f674gchrno70ednj51i.apps.googleusercontent.com
  VITE_GOOLE_SECRET: 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
  VITE_JOB_SERVICE: https://aflahaflu.shop/api/job-service
  VITE_JWT_EMAIL_VALIDATION_KEY: verifyingemail
  VITE_JWT_SECRET: jsonwebtokensecret
  VITE_SOCKET_URL: https://aflahaflu.shop/
  VITE_USER_SERVICE_URI: https://aflahaflu.shop/api/user-service
  VITE_ZEGOCLOUD_APPID: "210522789"
  VITE_ZEGOCLOUD_SERVER_SECRET: 6c163aceed2ad123be2254d8f0467f30
kind: ConfigMap
metadata:
  name: ascentfronend-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap885.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  APP_COLOR: blue
  APP_MODE: prod
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap886.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  master.cnf: |
    #  MySQL 
    [mysqld]
    log-bin
  slave.cnf: |
    #  MySQL 
    [mysqld]
    super-read-only
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap887.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to web/ConfigMap/my-config:
apiVersion: v1
data:
  MYSQL_DATABASE: mydatabase
  MYSQL_SERVICE_HOST: mysqldb-service
  MYSQL_user: raju
kind: ConfigMap
metadata:
  name: my-config
  namespace: web

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap895.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/myapp:
apiVersion: v1
data:
  PORT: "5432"
  POSTGRES_DATABASE: guaydatabase
  POSTGRES_PASSWORD: pepeIsTheBest
  POSTGRES_USER: pepe
kind: ConfigMap
metadata:
  name: myapp
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap896.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-conf:
apiVersion: v1
data:
  default.conf: |
    server {
      listen       80;
      server_name  localhost;
      location / {
          root   /usr/share/nginx/html;
          index  index.html index.htm;
      }
      error_page   500 502 503 504  /50x.html;
      location = /50x.html {
          root   /usr/share/nginx/html;
      }
      location /nginx_status {
        stub_status;
        allow 127.0.0.1;  #only allow requests from localhost
        deny all;   #deny all other hosts
      }
    }
kind: ConfigMap
metadata:
  name: nginx-conf
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap897.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to cjc4/ConfigMap/miniflux-config:
apiVersion: v1
data:
  BASE_URL: https://miniflux.cjc4.com
  POLLING_FREQUENCY: "15"
  RUN_MIGRATIONS: "1"
  WEBAUTHN: "1"
kind: ConfigMap
metadata:
  name: miniflux-config
  namespace: cjc4

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap899.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql:
apiVersion: v1
data:
  primary.cnf: |
    # Modificacin del primario
    [mysqld]
    log-bin
  replica.cnf: |
    # Modificacin de los secundarios
    [mysqld]
    super-read-only
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap9.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/nginx-configuration:
apiVersion: v1
data:
  client-body-buffer-size: 60k
  client-header-buffer-size: 16k
  error-log-level: warn
  http2-max-field-size: 16k
  large-client-header-buffers: 4 16k
  location-snippet: include /etc/nginx/custom-snippets/location-custom.conf;
  log-format-escape-json: "true"
  log-format-upstream: '{"time":"$time_iso8601","remote_addr":"$remote_addr","proxy_protocol_addr":"$proxy_protocol_addr","proxy_protocol_port":"$proxy_protocol_port","x_forward_for":"$proxy_add_x_forwarded_for","remote_user":"$remote_user","host":"$host","request_method":"$request_method","request_uri":"$request_uri","server_protocol":"$server_protocol","status":$status,"request_time":$request_time,"request_length":$request_length,"bytes_sent":$bytes_sent,"upstream_name":"$proxy_upstream_name","upstream_addr":"$upstream_addr","upstream_uri":"$uri","upstream_response_length":$upstream_response_length,"upstream_response_time":$upstream_response_time,"upstream_status":$upstream_status,"http_referrer":"$http_referer","http_user_agent":"$http_user_agent","http_cookie":"$http_cookie"}'
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/part-of: ingress-nginx
  name: nginx-configuration
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap9_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/tcp-services:
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/part-of: ingress-nginx
  name: tcp-services
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap9_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/udp-services:
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/part-of: ingress-nginx
  name: udp-services
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap902.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pg-init:
apiVersion: v1
data:
  setup.sql: |
    CREATE ROLE vault;
    ALTER ROLE vault WITH SUPERUSER LOGIN PASSWORD 'vault';
    \c wizard
    CREATE SCHEMA app;
    CREATE TABLE app.coffee(
      name TEXT PRIMARY KEY,
      species TEXT,
      regions TEXT,
      comment TEXT
    );
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Arusha','C. arabica','Tanzania, Papua New Guine','Either a Typica variety or a French Mission.');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Bourbon','C. arabica','Rwanda, Latin America','Around 1708 the French planted coffee on the island of Bourbon in the middle of the Indian Ocean, all probably from the same parent stock.');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Catuai','C. arabica','Latin America','This is a hybrid of Mundo Novo and Caturra bred in Brazil in the late 1940s.');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Colombian','C. arabica','Colombia','When Colombian coffee is freshly roasted it has a bright acidity, is heavy in body and is intensely aromatic.');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Ethiopian Harar','C. arabica','Ethiopia','Known for its complex, fruity flavor that resembles a dry red wine.');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Ethiopian Yirgacheffe','C. arabica','Ethiopia','From the Yirgachefe district in the Gedeo Zone of the Southern Nations, Nationalities, and Peoples Region of Ethiopia.');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Geisha','C. arabica','Ethiopia, Tanzania, Costa Rica, Panama, Colombia, Peru','The most expensive varietal at coffee auctions, fetching $350.25USD in 2013.[24]');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Hawaiian Kona','C. arabica','Hawaii','Grown on the slopes of Hualalai and Mauna Loa in the Kona District on the Big Island of Hawaii.');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Java','Interspecific hybrid','Indonesia','This coffee was once so widely traded that java became a slang term for coffee.');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Maragogipe','C. arabica','Latin America','Maragogipe is considered to be a natural mutation from Typica');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Santos','C. arabica','Brazil','The name refers to the port in Brazil where coffee passed through, and was regarded as higher quality than Brazilian coffee.');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Sulawesi','C. arabica','Indonesia','Sulawesi exhibits a rich, full body, well-balanced acidity and is multi-dimensional in character.');
    INSERT INTO app.coffee(name, species, regions, comment) VALUES ('Sumatra Mandheling','C. arabica','Indonesia','Mandheling is named after the Mandailing people located in North Sumatra, Indonesia.');
    CREATE TABLE app.users(
      username TEXT PRIMARY KEY,
      password TEXT
    );
    INSERT INTO app.users(username, password) VALUES ('alice', 'pFnLK*Xe4c:jYyU');
    INSERT INTO app.users(username, password) VALUES ('bob', 'v9~CRa-$q%!P(MISSING)~87!5');
    INSERT INTO app.users(username, password) VALUES ('joe', 'VfU{Y3\^XuM]8#^-');
    INSERT INTO app.users(username, password) VALUES ('sue', 't=6h%!c(MISSING)K?)k[KC9M');
kind: ConfigMap
metadata:
  labels:
    app: postgres
  name: pg-init
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap904.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-configmap:
apiVersion: v1
data:
  AUTH_HOST: alpha-auth-service
  AUTH_PORT: "8080"
  DB_HOST: alpha-db-service
  MYSQL_DATABASE: weatherapp
  MYSQL_USER: admin
  REDIS_USER: redis
  WEATHER_HOST: alpha-weather-service
  WEATHER_PORT: "5000"
kind: ConfigMap
metadata:
  name: app-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap907.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/piggybank-configmap:
apiVersion: v1
data:
  DATA_MICROSERVICE: PiggyBank
kind: ConfigMap
metadata:
  name: piggybank-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap908.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  KATARZYNA: HELLO Katarzyna!
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap909.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DB: auth
  MYSQL_HOST: host.minikube.internal
  MYSQL_PORT: "3306"
  MYSQL_USER: auth_user
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap910.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap911.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SVC_ADDRESS: auth:5000
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap912.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap913.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap915.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to media/ConfigMap/immich-configmap:
apiVersion: v1
data:
  DB_PORT: "5432"
  DISABLE_REVERSE_GEOCODING: "true"
  ENABLE_MAPBOX: "false"
  IMMICH_MACHINE_LEARNING_URL: http://immich-machine-learning.media.svc.cluster.local:3003
  IMMICH_SERVER_URL: http://immich-server.media.svc.cluster.local:3001
  IMMICH_WEB_URL: http://immich-web.media.svc.cluster.local:3000
  LOG_LEVEL: verbose
  NODE_ENV: production
  REDIS_URL: ioredis://eyJkYiI6MTEsInNlbnRpbmVscyI6W3siaG9zdCI6InJlZGlzLW5vZGUtMC5yZWRpcy1oZWFkbGVzcy5kYXRhYmFzZS5zdmMuY2x1c3Rlci5sb2NhbCIsInBvcnQiOjI2Mzc5fSx7Imhvc3QiOiJyZWRpcy1ub2RlLTEucmVkaXMtaGVhZGxlc3MuZGF0YWJhc2Uuc3ZjLmNsdXN0ZXIubG9jYWwiLCJwb3J0IjoyNjM3OX0seyJob3N0IjoicmVkaXMtbm9kZS0yLnJlZGlzLWRhdGFiYXNlLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiLCJwb3J0IjoyNjM3OX1dLCJuYW1lIjoicmVkaXMtbWFzdGVyIn0=
  SERVER_PORT: "3001"
  TRANSFORMERS_CACHE: /usr/src/app/.transformers_cache
kind: ConfigMap
metadata:
  name: immich-configmap
  namespace: media

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap916.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/cdn-proxy-configmap:
apiVersion: v1
data:
  nginx-config: |
    user nginx;
    worker_processes 1;
    events {
      worker_connections 1024;
    }
    http {
      include /etc/nginx/mime.types;
      default_type application/octet-stream;
      sendfile on;
      keepalive_timeout 65;
      server {
        listen 80;
        client_max_body_size 128M;
        location / {
        proxy_set_header Host "s3.monosense.io";
        proxy_hide_header "Set-Cookie";
        proxy_intercept_errors on;
        proxy_pass https://s3.monosense.io:9000/static-content/;
        }
      }
    }
kind: ConfigMap
metadata:
  name: cdn-proxy-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap917.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DB: auth
  MYSQL_HOST: host.minikube.internal
  MYSQL_PORT: "3306"
  MYSQL_USER: auth
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap918.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/gateway-configmap:
apiVersion: v1
data:
  AUTH_SERVICE_ADDRESS: auth:5000
kind: ConfigMap
metadata:
  name: gateway-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap919.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: none
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap920.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  DB_NAME: goals_database
  DB_PORT: "5432"
  DB_USERNAME: goals_user
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap921.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/k6-loadtest:
apiVersion: v1
data:
  test.js: |
    import { sleep, check } from 'k6';
    import http from 'k6/http';

    export default () => {
      const res = http.get('http://bookinfo-gateway-istio.default.svc.cluster.local');
      check(res, {
        'status is 200': () => res.status === 200,
      });
      sleep(1);
    };
kind: ConfigMap
metadata:
  name: k6-loadtest
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap923.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/argocd-image-updater-config:
apiVersion: v1
data:
  registries.conf: |
    registries:
    - name: AWS ECR
      prefix: 839695154978.dkr.ecr.ap-northeast-1.amazonaws.com
      api_url: https://839695154978.dkr.ecr.ap-northeast-1.amazonaws.com
      credentials: pullsecret:argocd/regcred
      default: true
      insecure: false
kind: ConfigMap
metadata:
  name: argocd-image-updater-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap924.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/hitohub-cm:
apiVersion: v1
kind: ConfigMap
metadata:
  name: hitohub-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap925.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/hitohub-cm:
apiVersion: v1
data:
  API_ENDPOINT: https://api-hitohub.b0xp.io
  FIREBASE_APP_ID: 1:886666292987:web:be12e53c9c16f381
  FIREBASE_AUTH_DOMAIN: vr-match-prod.firebaseapp.com
  FIREBASE_DATABASE_URL: https://vr-match-prod.firebaseio.com
  FIREBASE_MESSAGING_SENDER_ID: "886666292987"
  FIREBASE_PROJECT_ID: vr-match-prod
  FIREBASE_STORAGE_BUCKET: vr-match-prod.appspot.com
  GOOGLE_ANALYTICS_TRACKING_ID: UA-38081475-5
  VR_MATCH_CLIENT_ORIGIN: https://hitohub.b0xp.io
  VR_MATCH_CLOUD_STORAGE_BUCKET_NAME: vr-match-prod
  VR_MATCH_MYSQL_DBNAME: vr_match
  VR_MATCH_MYSQL_HOSTNAME: tidb-cluster-tidb
  VR_MATCH_MYSQL_PORT: "4000"
  VR_MATCH_MYSQL_USER: root
kind: ConfigMap
metadata:
  name: hitohub-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap926.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/hitohub-cm:
apiVersion: v1
data:
  API_ENDPOINT: https://api-hitohub-stage.b0xp.io
  FIREBASE_APP_ID: 1:431230778247:web:d195b37d884b0cc7
  FIREBASE_AUTH_DOMAIN: vr-match.firebaseapp.com
  FIREBASE_DATABASE_URL: https://vr-match.firebaseio.com
  FIREBASE_MESSAGING_SENDER_ID: "431230778247"
  FIREBASE_PROJECT_ID: vr-match
  FIREBASE_STORAGE_BUCKET: vr-match.appspot.com
  GOOGLE_ANALYTICS_TRACKING_ID: UA-38081475-5
  VR_MATCH_CLIENT_ORIGIN: https://hitohub-stage.b0xp.io
  VR_MATCH_CLOUD_STORAGE_BUCKET_NAME: vr-match-staging
  VR_MATCH_MYSQL_DBNAME: vr_match
  VR_MATCH_MYSQL_HOSTNAME: tidb-cluster-tidb
  VR_MATCH_MYSQL_PORT: "4000"
  VR_MATCH_MYSQL_USER: root
kind: ConfigMap
metadata:
  name: hitohub-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap927.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to k8s-ecr-token-updater/ConfigMap/ecr-registry-helper-cm:
apiVersion: v1
data:
  AWS_REGION: ap-northeast-1
  DOCKER_SECRET_NAME: regcred
kind: ConfigMap
metadata:
  name: ecr-registry-helper-cm
  namespace: k8s-ecr-token-updater

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap928.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/palworld-cm:
apiVersion: v1
data:
  COMMUNITY: "false"
  MULTITHREADING: "true"
  PGID: "1000"
  PLAYERS: "6"
  PORT: "8211"
  PUID: "1000"
  RCON_ENABLED: "true"
  RCON_PORT: "25575"
  SERVER_DESCRIPTION: Best palworld server on K8s
  SERVER_NAME: Fan Bois
  SERVER_PASSWORD: worldofpals
  TZ: UTC
kind: ConfigMap
metadata:
  name: palworld-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap929.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to selfhosted/ConfigMap/valheim-config:
apiVersion: v1
data:
  BACKUPS: "true"
  BACKUPS_DIRECTORY: /config/backups
  BACKUPS_DIRECTORY_PERMISSIONS: "755"
  BACKUPS_FILE_PERMISSIONS: "644"
  BACKUPS_IDLE_GRACE_PERIOD: "3600"
  BACKUPS_IF_IDLE: "false"
  BACKUPS_INTERVAL: "600"
  BACKUPS_MAX_AGE: "14"
  BACKUPS_MAX_COUNT: "72"
  CONFIG_DIRECTORY_PERMISSIONS: "755"
  SERVER_ARGS: -crossplay -modifier resources most -modifier DeathPenalty casual -setkey
    nobuildcost -modifier Portals casual
  SERVER_PUBLIC: "true"
  STATUS_HTTP: "true"
  SUPERVISOR_HTTP: "true"
  TZ: Australia/Perth
  UPDATE_CRON: 0 6 * * *
  WORLDS_DIRECTORY_PERMISSIONS: "755"
  WORLDS_FILE_PERMISSIONS: "644"
kind: ConfigMap
metadata:
  annotations:
    reloader.stakater.com/match: "true"
  name: valheim-config
  namespace: selfhosted

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap932.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to redis/ConfigMap/redis-config:
apiVersion: v1
data:
  redis.conf: |
    bind 0.0.0.0
    protected-mode yes
    port 6379
    tcp-backlog 511
    timeout 0
    tcp-keepalive 300
    daemonize no
    supervised no
    pidfile /var/run/redis.pid
    loglevel notice
    logfile ""
    databases 16
kind: ConfigMap
metadata:
  name: redis-config
  namespace: redis

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap933.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to nginx-web/ConfigMap/nginx-conf:
apiVersion: v1
data:
  nginx.conf: |
    user nginx;
    worker_processes auto;
    error_log /var/log/nginx/error.log warn;
    pid /var/run/nginx.pid;
    events {
        worker_connections 1024;
    }
    http {
        include /etc/nginx/mime.types;
        default_type application/octet-stream;
        log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                        '$status $body_bytes_sent "$http_referer" '
                        '"$http_user_agent" "$http_x_forwarded_for"';
        access_log /var/log/nginx/access.log main;
        sendfile on;
        keepalive_timeout 65;
        server {
            listen 80;
            server_name localhost;
            location / {
                root /usr/share/nginx/html;
                index index.html index.htm;
            }
            error_page 500 502 503 504 /50x.html;
            location = /50x.html {
                root /usr/share/nginx/html;
            }
        }
    }
kind: ConfigMap
metadata:
  name: nginx-conf
  namespace: nginx-web

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap936.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ns-practica3/ConfigMap/practica3-2cm:
apiVersion: v1
data:
  missatge1: Me gusta Kubernetes
  missatge2: |
    Tararior tarararo
    Lorem ipsum dolor sit amet
    Ut enim ad minim veniam
kind: ConfigMap
metadata:
  name: practica3-2cm
  namespace: ns-practica3

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap937.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mycfgmap:
apiVersion: v1
data:
  bindHost: 0.0.0.0
  bindPort: "3456"
  db.config: |
    host=mydb.svc.local
    port=3457
kind: ConfigMap
metadata:
  name: mycfgmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap938.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nodejs-env-config:
apiVersion: v1
data:
  APPLICATION: My Cool Application
  VERSION: 1.0.0
kind: ConfigMap
metadata:
  name: nodejs-env-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap938_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ReplicaSet/nodejs-env:
apiVersion: apps/v1
kind: ReplicaSet
metadata:
  name: nodejs-env
  namespace: default
spec:
  replicas: 3
  selector:
    matchLabels:
      name: nodejs-env
  template:
    metadata:
      labels:
        name: nodejs-env
      name: nodejs-env
    spec:
      containers:
      - envFrom:
        - configMapRef:
            name: nodejs-env-config
        image: khannedy/nodejs-env
        name: nodejs-env
        ports:
        - containerPort: 3000

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/ReplicaSet/nodejs-env

skipped mutate policy add-safe-to-evict -> resource default/ReplicaSet/nodejs-env
policy disallow-latest-tag -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-require-image-tag validation failure: validation error: An image tag is required. rule autogen-require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/ReplicaSet/nodejs-env failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 6, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: configmap938_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/nodejs-env-service:
apiVersion: v1
kind: Service
metadata:
  name: nodejs-env-service
  namespace: default
spec:
  ports:
  - nodePort: 30001
    port: 3000
    targetPort: 3000
  selector:
    name: nodejs-env
  type: NodePort

---


Mutation:
Mutation has been applied successfully.policy restrict-nodeport -> resource default/Service/nodejs-env-service failed:
1 - validate-nodeport validation error: Services of type NodePort are not allowed. rule validate-nodeport failed at path /spec/type/


pass: 1, fail: 1, warn: 0, error: 0, skip: 0 

##### FILE: configmap939.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/postgres-config:
apiVersion: v1
data:
  PGDATA: /var/lib/postgresql/data/pgdata
  POSTGRES_DB: postgresdb
  POSTGRES_PASSWORD: postgres
  POSTGRES_USER: postgres
kind: ConfigMap
metadata:
  labels:
    app: postgres
  name: postgres-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap940.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-node-app-config:
apiVersion: v1
data:
  database_host: db.example.com
  database_name: mydb
kind: ConfigMap
metadata:
  name: my-node-app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap941.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/go-api-content-configmap:
apiVersion: v1
data:
  content.txt: |
    Hi! I got deployed in Kubernetes Base Environment using Kustomize
    Multi-line Test
kind: ConfigMap
metadata:
  name: go-api-content-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap943.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/go-api-content-configmap:
apiVersion: v1
data:
  content.txt: |
    Hi! I got deployed in Kubernetes Base Environment using Kustomize
    Multi-line Test
kind: ConfigMap
metadata:
  name: go-api-content-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap944.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/go-api-content-configmap:
apiVersion: v1
data:
  content.txt: |
    Hi! I got deployed in Kubernetes Base Environment using Kustomize
    Multi-line Test
kind: ConfigMap
metadata:
  name: go-api-content-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap945.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to kube-auth-proxy/ConfigMap/config:
apiVersion: v1
data:
  config.yaml: |-
    Proxy:
      Port: 8080
    LDAP:
      URL: ldaps://ldap.example.com:636
      Group: kubeauth
      BaseDN: dc=example,dc=com
      BindDN: uid=svc-kube-auth,cn=users,dc=example,dc=com
kind: ConfigMap
metadata:
  name: config
  namespace: kube-auth-proxy

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap947.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/company:
apiVersion: v1
data:
  application.properties: |
    company.employee.client=http://localhost:8080
kind: ConfigMap
metadata:
  name: company
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap948.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/wordpress-config:
apiVersion: v1
data:
  MYSQL_DATABASE: wordpress
  MYSQL_USER: wordpress
  WORDPRESS_DB_HOST: mysql-service
  WORDPRESS_DB_NAME: wordpress
  WORDPRESS_DB_PASSWORD: password
  WORDPRESS_DB_USER: wordpress
kind: ConfigMap
metadata:
  labels:
    app: wordpress
  name: wordpress-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap949.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ml-workshop/ConfigMap/app-aflow-redis-configuration:
apiVersion: v1
data:
  master.conf: |-
    dir /data
    # User-supplied master configuration:
    rename-command FLUSHDB ""
    rename-command FLUSHALL ""
    # End of master configuration
  redis.conf: |-
    # User-supplied common configuration:
    # Enable AOF https://redis.io/topics/persistence#append-only-file
    appendonly yes
    # Disable RDB persistence, AOF persistence already enabled.
    save ""
    # End of common configuration
  replica.conf: |-
    dir /data
    slave-read-only yes
    # User-supplied replica configuration:
    rename-command FLUSHDB ""
    rename-command FLUSHALL ""
    # End of replica configuration
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: app-aflow
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: redis
    helm.sh/chart: redis-14.8.11
  name: app-aflow-redis-configuration
  namespace: ml-workshop

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap949_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ml-workshop/ConfigMap/app-aflow-redis-health:
apiVersion: v1
data:
  ping_liveness_local.sh: |-
    #!/bin/bash

    [[ -f $REDIS_PASSWORD_FILE ]] && export REDIS_PASSWORD="$(< "${REDIS_PASSWORD_FILE}")"
    export REDISCLI_AUTH="$REDIS_PASSWORD"
    response=$(
      timeout -s 3 $1 \
      redis-cli \
        -h localhost \
        -p $REDIS_PORT \
        ping
    )
    if [ "$response" != "PONG" ] && [ "$response" != "LOADING Redis is loading the dataset in memory" ]; then
      echo "$response"
      exit 1
    fi
  ping_liveness_local_and_master.sh: |-
    script_dir="$(dirname "$0")"
    exit_status=0
    "$script_dir/ping_liveness_local.sh" $1 || exit_status=$?
    "$script_dir/ping_liveness_master.sh" $1 || exit_status=$?
    exit $exit_status
  ping_liveness_master.sh: |-
    #!/bin/bash

    [[ -f $REDIS_MASTER_PASSWORD_FILE ]] && export REDIS_MASTER_PASSWORD="$(< "${REDIS_MASTER_PASSWORD_FILE}")"
    export REDISCLI_AUTH="$REDIS_MASTER_PASSWORD"
    response=$(
      timeout -s 3 $1 \
      redis-cli \
        -h $REDIS_MASTER_HOST \
        -p $REDIS_MASTER_PORT_NUMBER \
        ping
    )
    if [ "$response" != "PONG" ] && [ "$response" != "LOADING Redis is loading the dataset in memory" ]; then
      echo "$response"
      exit 1
    fi
  ping_readiness_local.sh: |-
    #!/bin/bash

    [[ -f $REDIS_PASSWORD_FILE ]] && export REDIS_PASSWORD="$(< "${REDIS_PASSWORD_FILE}")"
    export REDISCLI_AUTH="$REDIS_PASSWORD"
    response=$(
      timeout -s 3 $1 \
      redis-cli \
        -h localhost \
        -p $REDIS_PORT \
        ping
    )
    if [ "$response" != "PONG" ]; then
      echo "$response"
      exit 1
    fi
  ping_readiness_local_and_master.sh: |-
    script_dir="$(dirname "$0")"
    exit_status=0
    "$script_dir/ping_readiness_local.sh" $1 || exit_status=$?
    "$script_dir/ping_readiness_master.sh" $1 || exit_status=$?
    exit $exit_status
  ping_readiness_master.sh: |-
    #!/bin/bash

    [[ -f $REDIS_MASTER_PASSWORD_FILE ]] && export REDIS_MASTER_PASSWORD="$(< "${REDIS_MASTER_PASSWORD_FILE}")"
    export REDISCLI_AUTH="$REDIS_MASTER_PASSWORD"
    response=$(
      timeout -s 3 $1 \
      redis-cli \
        -h $REDIS_MASTER_HOST \
        -p $REDIS_MASTER_PORT_NUMBER \
        ping
    )
    if [ "$response" != "PONG" ]; then
      echo "$response"
      exit 1
    fi
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: app-aflow
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: redis
    helm.sh/chart: redis-14.8.11
  name: app-aflow-redis-health
  namespace: ml-workshop

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap949_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ml-workshop/ConfigMap/app-aflow-redis-scripts:
apiVersion: v1
data:
  start-master.sh: |-
    #!/bin/bash

    [[ -f $REDIS_PASSWORD_FILE ]] && export REDIS_PASSWORD="$(< "${REDIS_PASSWORD_FILE}")"
    if [[ ! -f /opt/bitnami/redis/etc/master.conf ]];then
        cp /opt/bitnami/redis/mounted-etc/master.conf /opt/bitnami/redis/etc/master.conf
    fi
    if [[ ! -f /opt/bitnami/redis/etc/redis.conf ]];then
        cp /opt/bitnami/redis/mounted-etc/redis.conf /opt/bitnami/redis/etc/redis.conf
    fi
    ARGS=("--port" "${REDIS_PORT}")
    ARGS+=("--requirepass" "${REDIS_PASSWORD}")
    ARGS+=("--masterauth" "${REDIS_PASSWORD}")
    ARGS+=("--include" "/opt/bitnami/redis/etc/redis.conf")
    ARGS+=("--include" "/opt/bitnami/redis/etc/master.conf")
    exec redis-server "${ARGS[@]}"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/instance: app-aflow
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: redis
    helm.sh/chart: redis-14.8.11
  name: app-aflow-redis-scripts
  namespace: ml-workshop

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap950.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/auth-configmap:
apiVersion: v1
data:
  MYSQL_DB: auth
  MYSQL_HOST: host.minikube.internal
  MYSQL_PORT: "3306"
  MYSQL_USER: auth_user
kind: ConfigMap
metadata:
  name: auth-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap951.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/converter-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: converter-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap952.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Secret/gateway-secret:
apiVersion: v1
kind: Secret
metadata:
  name: gateway-secret
  namespace: default
stringData:
  PLACEHOLDER: nothing
type: Opaque

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap953.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/notification-configmap:
apiVersion: v1
data:
  MP3_QUEUE: mp3
  VIDEO_QUEUE: video
kind: ConfigMap
metadata:
  name: notification-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap954.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-configmap:
apiVersion: v1
data:
  PLACEHOLDER: NONE
kind: ConfigMap
metadata:
  name: rabbitmq-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap960.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to roboshop/ConfigMap/cart:
apiVersion: v1
data:
  CATALOGUE_HOST: catalogue
  CATALOGUE_PORT: "8080"
  REDIS_HOST: redis
kind: ConfigMap
metadata:
  name: cart
  namespace: roboshop

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap961.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to roboshop/ConfigMap/catalogue:
apiVersion: v1
data:
  MONGO: "true"
kind: ConfigMap
metadata:
  name: catalogue
  namespace: roboshop

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap962.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to roboshop/ConfigMap/shipping:
apiVersion: v1
data:
  CART_ENDPOINT: cart:8080
  DB_HOST: mysql
kind: ConfigMap
metadata:
  name: shipping
  namespace: roboshop

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap963.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to roboshop/ConfigMap/user:
apiVersion: v1
data:
  MONGO: "true"
kind: ConfigMap
metadata:
  name: user
  namespace: roboshop

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap968.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to demonstrator/ConfigMap/demonstrator-configmap:
apiVersion: v1
data:
  value1: Hello World
  value2: Some value 2
kind: ConfigMap
metadata:
  name: demonstrator-configmap
  namespace: demonstrator

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap969.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-configmap:
apiVersion: v1
data:
  mysql_binlog_format.cnf: |
    [mysqld]
    binlog-format=mixed
kind: ConfigMap
metadata:
  labels:
    app: mysql
  name: mysql-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap970.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-config:
apiVersion: v1
data:
  nginx.conf: |
    {
     user: nginx;
    }
  virtualhost.conf: |
    {
     server: localhost;
     port: 80
    }
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap971.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mc3-nginx-conf:
apiVersion: v1
data:
  nginx.conf: |-
    user  nginx;
    worker_processes  1;

    error_log  /var/log/nginx/error.log warn;
    pid        /var/run/nginx.pid;

    events {
        worker_connections  1024;
    }

    http {
        include       /etc/nginx/mime.types;
        default_type  application/octet-stream;

        sendfile        on;
        keepalive_timeout  65;

        upstream webapp {
            server 127.0.0.1:5000;
        }

        server {
            listen 80;

            location / {
                proxy_pass         http://webapp;
                proxy_redirect     off;
            }
        }
    }
kind: ConfigMap
metadata:
  name: mc3-nginx-conf
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap972.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-conf:
apiVersion: v1
data:
  default.conf: |
    server {
      listen       80;
      server_name  localhost;
      location / {
          root   /usr/share/nginx/html;
          index  index.html index.htm;
      }
      error_page   500 502 503 504  /50x.html;
      location = /50x.html {
          root   /usr/share/nginx/html;
      }
      location /nginx_status {
        stub_status;
        allow 127.0.0.1;  #only allow requests from localhost
        deny all;   #deny all other hosts
      }
    }
kind: ConfigMap
metadata:
  name: nginx-conf
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap973.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/fluentd-config:
apiVersion: v1
data:
  fluentd.conf: |
    <source>
      type tail
      format none
      path /var/log/1.log
      pos_file /var/log/1.log.pos
      tag count.format1
    </source>

    <source>
      type tail
      format none
      path /var/log/2.log
      pos_file /var/log/2.log.pos
      tag count.format2
    </source>

    <match **>
      type google_cloud
    </match>
kind: ConfigMap
metadata:
  name: fluentd-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap974.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-configmap:
apiVersion: v1
data:
  app-config: City = Hamburg State = Hamburg Country = Germany
kind: ConfigMap
metadata:
  name: my-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap975.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-config:
apiVersion: v1
data: foo:"bar"
kind: ConfigMap
metadata:
  name: my-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap976.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/example-redis-config:
apiVersion: v1
data:
  redis-config: |
    maxmemory 2mb
    maxmemory-policy allkeys-lru
kind: ConfigMap
metadata:
  name: example-redis-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap977.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/game-demo:
apiVersion: v1
data:
  game.properties: "enemy.types=aliens,monsters\nplayer.maximum-lives=5    \n"
  player_initial_lives: "3"
  ui_properties_file_name: user-interface.properties
  user-interface.properties: |
    color.good=purple
    color.bad=yellow
    allow.textmode=true
kind: ConfigMap
metadata:
  name: game-demo
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap978.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  APP_COLOR: blue
  APP_MODE: prod
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap979.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  config.json: |-
    {
        "RedisHost": "redis-svc"
    }
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap980.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to metallb-system/ConfigMap/config:
apiVersion: v1
data:
  config: |
    address-pools:
    - name: default
      protocol: layer2
      addresses:
      - <ip-address-range-start>-<ip-address-range-stop>
kind: ConfigMap
metadata:
  name: config
  namespace: metallb-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap981.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to ingress-nginx/ConfigMap/ingress-nginx-controller:
apiVersion: v1
data:
  allow-snippet-annotations: "true"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/component: controller
    app.kubernetes.io/instance: ingress-nginx
    app.kubernetes.io/name: ingress-nginx
  name: ingress-nginx-controller
  namespace: ingress-nginx

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap982.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to redis/ConfigMap/redis-ss-configuration:
apiVersion: v1
data:
  master.conf: |
    maxmemory 400mb
    maxmemory-policy allkeys-lru
    maxclients 20000
    timeout 300
    appendonly no
    dbfilename dump.rdb
    dir /data
  slave.conf: |
    slaveof redis-ss-0.redis-ss.redis 6379
    maxmemory 400mb
    maxmemory-policy allkeys-lru
    maxclients 20000
    timeout 300
    dir /data
kind: ConfigMap
metadata:
  labels:
    app: redis
  name: redis-ss-configuration
  namespace: redis

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMap983.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to kube-system/ConfigMap/local-provisioner-config:
apiVersion: v1
data:
  storageClassMap: |
    local-volume:
       vendor: alibabacloud
       hostDir: /mnt/disks
       mountDir: /mnt/disks
       blockCleanerCommand:
         - "/scripts/shred.sh"
         - "2"
       volumeMode: Filesystem
       fsType: ext4
       deviceStartWith: vdb
       mkFSOptions: ""
       mountOptions: "nodelalloc"
kind: ConfigMap
metadata:
  name: local-provisioner-config
  namespace: kube-system

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap984.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/inventory-configmap:
apiVersion: v1
data:
  storage.enabled: "true"
kind: ConfigMap
metadata:
  name: inventory-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap985.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/order-service:
apiVersion: v1
data:
  application.yaml: |-
    logging:
      level:
        org:
          springframework:
            web:
              servlet:
                DispatcherServlet: DEBUG
kind: ConfigMap
metadata:
  name: order-service
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap986.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/postgres-secret:
apiVersion: v1
data:
  POSTGRES_DB: socialdb
  POSTGRES_PASSWORD: postgres
  POSTGRES_USER: postgres
kind: ConfigMap
metadata:
  labels:
    app: postgres
  name: postgres-secret
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap986_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/rabbitmq-secret:
apiVersion: v1
data:
  RABBITMQ_DEFAULT_PASS: rabbitmq
  RABBITMQ_DEFAULT_USER: rabbitmq
kind: ConfigMap
metadata:
  labels:
    app: rabbitmq
  name: rabbitmq-secret
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMap987.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/config:
apiVersion: v1
data:
  MESSAGE: malice in the combustion palace
kind: ConfigMap
metadata:
  creationTimestamp: "2024-03-20T14:44:49Z"
  name: config
  namespace: default
  resourceVersion: "37056"
  uid: b16d1a7c-5138-4264-8371-d5c1c066b353

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap988.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to anotherclass-212/ConfigMap/api-tester-2121-properties:
apiVersion: v1
data:
  application_role: ALL
  postgresql_filepath: /usr/src/myapp/datasource/postgresql-info.yaml
  spring_profiles_active: dev
kind: ConfigMap
metadata:
  labels:
    component: backend-server
    instance: api-tester-2121
    managed-by: kubectl
    name: api-tester
    part-of: k8s-anotherclass
    version: 1.0.0
  name: api-tester-2121-properties
  namespace: anotherclass-212

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmap989.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to app/ConfigMap/cvapp-configmap:
apiVersion: v1
data:
  api: http://app.cvapplication.xyz/api/v1/
kind: ConfigMap
metadata:
  name: cvapp-configmap
  namespace: app

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmapdemo.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/nginx-demo:
apiVersion: v1
data:
  index.html: |
    <html>
      <h1> Teste </h1>
    </html>
  vhost.conf: |
    server {
      listen 80;
      listen [::]:80;

      root /usr/share/nginx/app1;
      index index.html index.htm index.nginx-debian.html;

      server_name app.localhost.com www.app.localhost.com;

      location / {
          try_files $uri $uri/ =404;
       }
    }
  virtual_host: vhost1.localhost.com
kind: ConfigMap
metadata:
  name: nginx-demo
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmapdemo_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/nginx:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: nginx
  name: nginx
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - env:
        - name: VIRTUAL_HOST
          valueFrom:
            configMapKeyRef:
              key: virtual_host
              name: nginx-demo
        image: nginx
        name: nginx
        volumeMounts:
        - mountPath: /usr/share/nginx/app1/index.html
          name: index-html
          subPath: index.html
        - mountPath: /etc/nginx/config.d/vhost.conf
          name: vhost
          subPath: vhost.conf
      volumes:
      - configMap:
          items:
          - key: index.html
            path: index.html
          name: nginx-demo
        name: index-html
      - configMap:
          items:
          - key: vhost.conf
            path: vhost.conf
          name: nginx-demo
        name: vhost

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/nginx

skipped mutate policy add-safe-to-evict -> resource default/Deployment/nginx
policy disallow-default-namespace -> resource default/Deployment/nginx failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Deployment/nginx failed:
1 - autogen-require-image-tag validation failure: validation error: An image tag is required. rule autogen-require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Deployment/nginx failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/nginx failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/nginx failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/nginx failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-pod-probes -> resource default/Deployment/nginx failed:
1 - autogen-validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Deployment/nginx failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/nginx failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmapdemo1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/my-pod:
apiVersion: v1
kind: Pod
metadata:
  name: my-pod
  namespace: default
spec:
  containers:
  - env:
    - name: MY_CONFIG
      valueFrom:
        configMapKeyRef:
          key: key1
          name: my-config
    image: nginx
    name: my-container

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/my-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/my-pod
policy disallow-default-namespace -> resource default/Pod/my-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/my-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/my-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/my-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/my-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/my-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/my-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/my-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/my-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: ConfigMapDep2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/myapp-pod:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: myapp
  name: myapp-pod
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      app: myapp
  template:
    metadata:
      labels:
        app: myapp
    spec:
      containers:
      - env:
        - name: HTTP_PORT
          value: "80"
        - name: HTTPS_PORT
          value: "443"
        image: wbitt/network-multitool
        imagePullPolicy: IfNotPresent
        name: network-multitool
        ports:
        - containerPort: 80
          name: http-port
        - containerPort: 443
          name: https-port
        resources:
          limits:
            cpu: 200m
            memory: 512Mi
          requests:
            cpu: 100m
            memory: 256Mi
        volumeMounts:
        - mountPath: /usr/share/nginx/html/
          name: nginx-index-file
      initContainers:
      - command:
        - sh
        - -c
        - until nslookup myservice.$(cat /var/run/secrets/kubernetes.io/serviceaccount/namespace).svc.cluster.local;
          do echo waiting for myservice; sleep 2; done
        image: busybox:1.28
        name: init-myservice
      volumes:
      - configMap:
          name: index-html-configmap
        name: nginx-index-file

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/myapp-pod

skipped mutate policy add-safe-to-evict -> resource default/Deployment/myapp-pod
policy disallow-default-namespace -> resource default/Deployment/myapp-pod failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Deployment/myapp-pod failed:
1 - autogen-require-image-tag validation failure: validation error: An image tag is required. rule autogen-require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Deployment/myapp-pod failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/myapp-pod failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/myapp-pod failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/myapp-pod failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/initContainers/0/resources/

policy require-pod-probes -> resource default/Deployment/myapp-pod failed:
1 - autogen-validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Deployment/myapp-pod failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/myapp-pod failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/initContainers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmapenvdocker.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/sample-pod-env:
apiVersion: v1
kind: Pod
metadata:
  name: sample-pod-env
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - env
    env:
    - name: KEY_FROM_CONFIG
      valueFrom:
        configMapKeyRef:
          key: key.sample1
          name: env-sample
    image: k8s.gcr.io/busybox
    name: sample-env-container
  restartPolicy: Never

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/sample-pod-env

skipped mutate policy add-safe-to-evict -> resource default/Pod/sample-pod-env
policy disallow-default-namespace -> resource default/Pod/sample-pod-env failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/sample-pod-env failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/sample-pod-env failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/sample-pod-env failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/sample-pod-env failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/sample-pod-env failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/sample-pod-env failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/sample-pod-env failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/sample-pod-env failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configMapExample.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  APP_COLOR: blue
  APP_MODE: prod
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmapforvolumev7.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to application/ConfigMap/config-for-volume:
apiVersion: v1
data:
  LEVEL1: high
  LEVEL2: low
kind: ConfigMap
metadata:
  name: config-for-volume
  namespace: application

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMapKeyRef.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/env-pod:
apiVersion: v1
kind: Pod
metadata:
  name: env-pod
  namespace: default
spec:
  containers:
  - command:
    - sh
    - -c
    - 'echo configmap is: $CONFIGMAPVAR && sleep 3600'
    env:
    - name: CONFIGMAPVAR
      valueFrom:
        configMapKeyRef:
          key: name
          name: my-config
    image: busybox
    name: busybox

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/env-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/env-pod
policy disallow-default-namespace -> resource default/Pod/env-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/env-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/env-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/env-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/env-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/env-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/env-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/env-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/env-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configMapKeyRef1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/env-pod:
apiVersion: v1
kind: Pod
metadata:
  name: env-pod
  namespace: default
spec:
  containers:
  - command:
    - sh
    - -c
    - 'echo configmap is: $CONFIGMAPVAR && sleep 3600'
    env:
    - name: CONFIGMAPVAR
      valueFrom:
        configMapKeyRef:
          key: name
          name: my-config
    image: busybox
    name: busybox

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/env-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/env-pod
policy disallow-default-namespace -> resource default/Pod/env-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/env-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/env-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/env-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/env-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/env-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/env-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/env-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/env-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmapPOD.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to devproject/Pod/webapp:
apiVersion: v1
kind: Pod
metadata:
  name: webapp
  namespace: devproject
spec:
  containers:
  - env:
    - name: classname
      valueFrom:
        configMapKeyRef:
          key: class.name
          name: test-config
    - name: classday
      valueFrom:
        configMapKeyRef:
          key: class.day
          name: test-config
    image: sudarshanlnx/2022sundayweb:v1
    imagePullPolicy: Always
    name: webcon
    ports:
    - containerPort: 80
      name: apache
      protocol: TCP
    resources:
      limits:
        cpu: 400m
        memory: 300Mi
      requests:
        cpu: 200m
        memory: 200Mi

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource devproject/Pod/webapp

skipped mutate policy add-safe-to-evict -> resource devproject/Pod/webapp
policy drop-all-capabilities -> resource devproject/Pod/webapp failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource devproject/Pod/webapp failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource devproject/Pod/webapp failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-pod-probes -> resource devproject/Pod/webapp failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource devproject/Pod/webapp failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource devproject/Pod/webapp failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 6, warn: 0, error: 0, skip: 2 

##### FILE: configmapPod1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/configmappod:
apiVersion: v1
kind: Pod
metadata:
  name: configmappod
  namespace: default
spec:
  containers:
  - args:
    - -c
    - while true; do echo $(date) > /dev/stdout; sleep 10; done
    command:
    - /bin/sh
    image: busybox
    name: busyboxpod
    volumeMounts:
    - mountPath: /data/config
      name: app-config-volume
  volumes:
  - configMap:
      name: app-config
    name: app-config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/configmappod

skipped mutate policy add-safe-to-evict -> resource default/Pod/configmappod
policy disallow-default-namespace -> resource default/Pod/configmappod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/configmappod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/configmappod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/configmappod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/configmappod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/configmappod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/configmappod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/configmappod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/configmappod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configMapPod11.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/configamp-pod1:
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    run: configamp-pod1
  name: configamp-pod1
  namespace: default
spec:
  containers:
  - command:
    - sh
    - -c
    - echo "The app is running!" && tail -f /dev/null
    image: busybox
    name: configamp-pod1
    resources: {}
    volumeMounts:
    - mountPath: /etc/config
      name: configvol
  dnsPolicy: ClusterFirst
  restartPolicy: Always
  volumes:
  - configMap:
      items:
      - key: log_level
        path: log_level
      name: log-config
    name: configvol
status: {}

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/configamp-pod1

skipped mutate policy add-safe-to-evict -> resource default/Pod/configamp-pod1
policy disallow-default-namespace -> resource default/Pod/configamp-pod1 failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/configamp-pod1 failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/configamp-pod1 failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/configamp-pod1 failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/configamp-pod1 failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/configamp-pod1 failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/limits/

policy require-pod-probes -> resource default/Pod/configamp-pod1 failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/configamp-pod1 failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/configamp-pod1 failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmapPOD2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to devproject/Pod/webapp:
apiVersion: v1
kind: Pod
metadata:
  name: webapp
  namespace: devproject
spec:
  containers:
  - env:
    - name: classname
      valueFrom:
        configMapKeyRef:
          key: class.name
          name: test-config
    - name: classday
      valueFrom:
        configMapKeyRef:
          key: class.day
          name: test-config
    image: sudarshanlnx/2022sundayweb:v1
    imagePullPolicy: Always
    name: webcon
    ports:
    - containerPort: 80
      name: apache
      protocol: TCP
    resources:
      limits:
        cpu: 400m
        memory: 300Mi
      requests:
        cpu: 200m
        memory: 200Mi
    volumeMounts:
    - mountPath: /tmp
      name: test
  volumes:
  - configMap:
      name: game-config-2
    name: test

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource devproject/Pod/webapp

skipped mutate policy add-safe-to-evict -> resource devproject/Pod/webapp
policy drop-all-capabilities -> resource devproject/Pod/webapp failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource devproject/Pod/webapp failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource devproject/Pod/webapp failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-pod-probes -> resource devproject/Pod/webapp failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource devproject/Pod/webapp failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource devproject/Pod/webapp failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 6, warn: 0, error: 0, skip: 2 

##### FILE: configMapRef.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/configmap-demo-pod:
apiVersion: v1
kind: Pod
metadata:
  name: configmap-demo-pod
  namespace: default
spec:
  containers:
  - command:
    - sleep
    - "3600"
    envFrom:
    - configMapRef:
        name: my-config
    image: alpine
    name: demo

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/configmap-demo-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/configmap-demo-pod
policy disallow-default-namespace -> resource default/Pod/configmap-demo-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/configmap-demo-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/configmap-demo-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/configmap-demo-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/configmap-demo-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/configmap-demo-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/configmap-demo-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/configmap-demo-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/configmap-demo-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configMapRef1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/configmap-demo-pod:
apiVersion: v1
kind: Pod
metadata:
  name: configmap-demo-pod
  namespace: default
spec:
  containers:
  - command:
    - sleep
    - "3600"
    envFrom:
    - configMapRef:
        name: my-config
    image: alpine
    name: demo

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/configmap-demo-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/configmap-demo-pod
policy disallow-default-namespace -> resource default/Pod/configmap-demo-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/configmap-demo-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/configmap-demo-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/configmap-demo-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/configmap-demo-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/configmap-demo-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/configmap-demo-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/configmap-demo-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/configmap-demo-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmaps.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/argocd-cmd-params-cm:
apiVersion: v1
data:
  application.namespaces: core-apps, test-apps, simple-apps
  server.insecure: "true"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: argocd-cmd-params-cm
    app.kubernetes.io/part-of: argocd
  name: argocd-cmd-params-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/argocd-cm:
apiVersion: v1
data:
  accounts.wim: apiKey, login
  exec.enabled: "true"
  kustomize.buildOptions: --enable-helm
  statusbadge.enabled: "true"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: argocd-cm
    app.kubernetes.io/part-of: argocd
  name: argocd-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/argocd-rbac-cm:
apiVersion: v1
data:
  policy.csv: |
    p, role:test-role, applications, get, */*, allow
    p, role:test-role, projects, get, *, allow
    g, wim, role:test-role
  policy.default: ""
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: argocd-rbac-cm
    app.kubernetes.io/part-of: argocd
  name: argocd-rbac-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps-1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/nginx:
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    run: nginx
  name: nginx
  namespace: default
spec:
  containers:
  - env:
    - name: var5
      valueFrom:
        configMapKeyRef:
          key: var5
          name: options
    image: nginx
    name: nginx
    resources: {}
  dnsPolicy: ClusterFirst
  restartPolicy: Always
status: {}

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/nginx

skipped mutate policy add-safe-to-evict -> resource default/Pod/nginx
policy disallow-default-namespace -> resource default/Pod/nginx failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/nginx failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/nginx failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/nginx failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/nginx failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/nginx failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/limits/

policy require-pod-probes -> resource default/Pod/nginx failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/nginx failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/nginx failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmaps10.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/grafana-config:
apiVersion: v1
data:
  grafana.ini: |
    [users]
    allow_sign_up = false
    auto_assign_org = true
    auto_assign_org_role = Editor
    [auth.jwt]
    jwk_set_url = https://whitestar.cloudflareaccess.com/cdn-cgi/access/certs
    enabled = true
    header_name = Cf-Access-Jwt-Assertion
    username_claim = email
    email_claim = email
    auto_sign_up = true
kind: ConfigMap
metadata:
  name: grafana-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps10_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/grafana-datasources:
apiVersion: v1
data:
  datasources.yaml: |-
    apiVersion: 1
    datasources:
      - name: Kube Prometheus
        type: prometheus
        access: proxy
        url: http://prometheus.monitoring.svc:8080
        jsonData:
          manageAlerts: true
          prometheusType: Prometheus
          cacheLevel: 'Medium'
          incrementalQuerying: true
          incrementalQueryOverlapWindow: 2m
          disableRecordingRules: true
      - name: NAS Prometheus
        type: prometheus
        access: proxy
        isDefault: true
        url: http://woodlandpark.brickyard.whitestar.systems:9090
        jsonData:
          manageAlerts: false
          prometheusType: Prometheus
          cacheLevel: 'Medium'
          incrementalQuerying: true
          incrementalQueryOverlapWindow: 5m
          disableRecordingRules: true
      - name: AlertManager
        type: alertmanager
        access: proxy
        url: http://alertmanager.monitoring.svc:8080
        jsonData:
          implementation: prometheus
          handleGrafanaManagedAlerts: true
kind: ConfigMap
metadata:
  name: grafana-datasources
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps11.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to n8n/ConfigMap/n8n-configmap:
apiVersion: v1
data:
  GENERIC_TIMEZONE: America/Los_Angeles
  N8N_DIAGNOSTICS_ENABLED: "false"
  N8N_HIDE_USAGE_PAGE: "true"
  N8N_HIRING_BANNER_ENABLED: "false"
  N8N_METRICS: "true"
  N8N_PERSONALIZATION_ENABLED: "false"
  N8N_PROTOCOL: http
  N8N_SMTP_SENDER: N8N <n8n@whitestar.systems>
  N8N_VERSION_NOTIFICATIONS_ENABLED: "false"
  TZ: America/Los_Angeles
  WEBHOOK_TUNNEL_URL: https://n8n.brickyard.whitestar.systems/
kind: ConfigMap
metadata:
  labels:
    app: n8n
    component: configmap
  name: n8n-configmap
  namespace: n8n

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps12.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-name:
apiVersion: v1
data:
  ENV: VALUE
kind: ConfigMap
metadata:
  name: configmap-name
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps13.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-name:
apiVersion: v1
data:
  ENV: VALUE
kind: ConfigMap
metadata:
  name: configmap-name
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps14.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to rocketchat/ConfigMap/jitsi-envs:
apiVersion: v1
data:
  ETHERPAD_DEFAULT_PAD_TEXT: '"Welcome to Web Chat!\n\n"'
  ETHERPAD_SKIN_NAME: colibris
  ETHERPAD_SKIN_VARIANTS: '"super-light-toolbar super-light-editor light-background
    full-width-editor"'
  ETHERPAD_TITLE: Video Chat
  HTTP_PORT: "80"
  HTTPS_PORT: "443"
  JIBRI_RECORDER_PASSWORD: 57969777b35e6040791212b1aa26ff36
  JIBRI_XMPP_PASSWORD: 38f7da1f75c78e27f7cf93fe772a79c1
  JICOFO_AUTH_PASSWORD: fcd121582ec8322f5fc262a398fe7c8e
  JIGASI_XMPP_PASSWORD: b984fb9c2509d4831419a1fa7e477dec
  JVB_ADVERTISE_IPS: 188.213.199.91,188.213.199.100
  JVB_AUTH_PASSWORD: 6ea25fdc9611b6df32a0dfac49fa773f
  JVB_PORT: "30300"
  PUBLIC_URL: https://jitsi.nitamowj.ir
  TURN_CREDENTIALS: jr00QMMfECtfMCwKewZTPh23sdf3m3DeusUPkgQfFRTzUg1VC6KsBIiqiFFeP
  TURN_HOST: 188.213.199.91
  TURN_PORT: "3478"
  TZ: Europe/Budapest
  XMPP_BOSH_URL_BASE: http://127.0.0.1:5280
  XMPP_SERVER: localhost
kind: ConfigMap
metadata:
  name: jitsi-envs
  namespace: rocketchat

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps15.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-configmap:
apiVersion: v1
data:
  app-config: |
    exampleKey: exampleValue
kind: ConfigMap
metadata:
  name: my-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps16.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configurable-env:
apiVersion: v1
data:
  Configurable__Environment: uat
  Configurable__Release: 24.01.2
kind: ConfigMap
metadata:
  labels:
    app: configurable
    kubernetes.courselabs.co: secrets
  name: configurable-env
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps16_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configurable-override:
apiVersion: v1
data:
  override.json: |-
    {
      "Features" : {
        "Caching" : true
      }
    }
kind: ConfigMap
metadata:
  name: configurable-override
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMaps17.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  FILE_DESCRIPTOR: configured-file-descriptor
  LOGGING_LEVEL: INFO
  PERF_CONFIG_FILE: |
    config:
      thread: 1
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMaps17_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Secret/app-secrets:
apiVersion: v1
kind: Secret
metadata:
  name: app-secrets
  namespace: default
stringData:
  SECRET_KEY: |
    {
      "bank-api-secret-key": "kotek123"
    }
  USER_PASSWORD: admin12345

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMaps17_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/app-deployment:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: app-deployment
  name: app-deployment
  namespace: default
spec:
  replicas: 2
  selector:
    matchLabels:
      app: app-pod
  template:
    metadata:
      labels:
        app: app-pod
    spec:
      containers:
      - env:
        - name: LOGGING_LEVEL_APP
          valueFrom:
            configMapKeyRef:
              key: LOGGING_LEVEL
              name: app-config
        - name: USER_PASSWORD_APP
          valueFrom:
            secretKeyRef:
              key: USER_PASSWORD
              name: app-secrets
        envFrom:
        - configMapRef:
            name: app-config
        - secretRef:
            name: app-secrets
        image: app:1.0.0
        livenessProbe:
          httpGet:
            path: /health/liveness
            port: 5000
        name: app
        ports:
        - containerPort: 5000
          name: http
        readinessProbe:
          httpGet:
            path: /health/readiness
            port: 5000
        resources:
          limits:
            cpu: 500m
            memory: 256Mi
          requests:
            cpu: 100m
            memory: 64Mi
        volumeMounts:
        - mountPath: /etc/app/app-config
          name: app-config
        - mountPath: /etc/app/app-config-item
          name: app-config-item
        - mountPath: /etc/app/perf.conf
          name: app-config
          subPath: PERF_CONFIG_FILE
        - mountPath: /etc/app/app-secrets
          name: app-secrets
        - mountPath: /etc/app/app-secrets-item
          name: app-secrets-item
        - mountPath: /etc/app/secret.key
          name: app-secrets
          subPath: SECRET_KEY
      terminationGracePeriodSeconds: 0
      volumes:
      - configMap:
          name: app-config
        name: app-config
      - configMap:
          items:
          - key: PERF_CONFIG_FILE
            path: perf.conf
          name: app-config
        name: app-config-item
      - name: app-secrets
        secret:
          defaultMode: 256
          secretName: app-secrets
      - name: app-secrets-item
        secret:
          items:
          - key: SECRET_KEY
            path: secret.key
          secretName: app-secrets

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/app-deployment

skipped mutate policy add-safe-to-evict -> resource default/Deployment/app-deployment
policy disallow-default-namespace -> resource default/Deployment/app-deployment failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/app-deployment failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/app-deployment failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/app-deployment failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-ro-rootfs -> resource default/Deployment/app-deployment failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/app-deployment failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 9, fail: 6, warn: 0, error: 0, skip: 2 

##### FILE: configmaps18.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-name:
apiVersion: v1
data:
  ENV: VALUE
kind: ConfigMap
metadata:
  name: configmap-name
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/grafana-config:
apiVersion: v1
data:
  grafana.ini: |
    [users]
    allow_sign_up = false
    auto_assign_org = true
    auto_assign_org_role = Editor
    [auth.jwt]
    jwk_set_url = https://whitestar.cloudflareaccess.com/cdn-cgi/access/certs
    enabled = true
    header_name = Cf-Access-Jwt-Assertion
    username_claim = email
    email_claim = email
    auto_sign_up = true
kind: ConfigMap
metadata:
  name: grafana-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps-2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/anotherone:
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    run: anotherone
  name: anotherone
  namespace: default
spec:
  containers:
  - envFrom:
    - configMapRef:
        name: anotherone
    image: nginx
    name: anotherone
    resources: {}
  dnsPolicy: ClusterFirst
  restartPolicy: Always
status: {}

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/anotherone

skipped mutate policy add-safe-to-evict -> resource default/Pod/anotherone
policy disallow-default-namespace -> resource default/Pod/anotherone failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/anotherone failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/anotherone failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/anotherone failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/anotherone failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/anotherone failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/limits/

policy require-pod-probes -> resource default/Pod/anotherone failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/anotherone failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/anotherone failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmaps2_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/grafana-datasources:
apiVersion: v1
data:
  datasources.yaml: |-
    apiVersion: 1
    datasources:
      - name: Kube Prometheus
        type: prometheus
        access: proxy
        url: http://prometheus.monitoring.svc:8080
        jsonData:
          manageAlerts: true
          prometheusType: Prometheus
          cacheLevel: 'Medium'
          incrementalQuerying: true
          incrementalQueryOverlapWindow: 2m
          disableRecordingRules: true
      - name: NAS Prometheus
        type: prometheus
        access: proxy
        isDefault: true
        url: http://woodlandpark.brickyard.whitestar.systems:9090
        jsonData:
          manageAlerts: false
          prometheusType: Prometheus
          cacheLevel: 'Medium'
          incrementalQuerying: true
          incrementalQueryOverlapWindow: 5m
          disableRecordingRules: true
      - name: AlertManager
        type: alertmanager
        access: proxy
        url: http://alertmanager.monitoring.svc:8080
        jsonData:
          implementation: prometheus
          handleGrafanaManagedAlerts: true
kind: ConfigMap
metadata:
  name: grafana-datasources
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps21.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/producer-env:
apiVersion: v1
data:
  MONGODB_DATABASE: desafio
  MONGODB_HOST: mongodb
  MONGODB_PASSWORD: password
  MONGODB_PORT: "27017"
  MONGODB_USER: mongodb
  RABBITMQ_HOST: rabbitmq
  RABBITMQ_PASSWORD: password
  RABBITMQ_PORT: "5672"
  RABBITMQ_USERNAME: rabbitmq
kind: ConfigMap
metadata:
  name: producer-env
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps21_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/consumer-env:
apiVersion: v1
data:
  MONGODB_DATABASE: desafio
  MONGODB_HOST: mongodb
  MONGODB_PASSWORD: password
  MONGODB_PORT: "27017"
  MONGODB_USER: mongodb
  RABBITMQ_HOST: rabbitmq
  RABBITMQ_PASSWORD: password
  RABBITMQ_PORT: "5672"
  RABBITMQ_USERNAME: rabbitmq
kind: ConfigMap
metadata:
  name: consumer-env
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMaps22.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to test/ConfigMap/input-conf:
apiVersion: v1
data:
  inputs.yml: "n_estimators: \n  - 100\n  - 200\n  - 300\nmax_depth: \n  - 10\n  -
    20\n  - 30\nrandom_state: \n  - 17\n  - 19\n  - 47\n"
kind: ConfigMap
metadata:
  name: input-conf
  namespace: test

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMaps22_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to test/ConfigMap/train-conf:
apiVersion: v1
data:
  simple-training-app.cwl: "cwlVersion: v1.0\n$namespaces:\n  s: https://schema.org/\ns:softwareVersion:
    1.0.0\nschemas:\n  - http://schema.org/version/9.0/schemaorg-current-http.rdf\n$graph:\n
    \ - class: Workflow\n    id: main\n    label: Training a randomforest calssifier\n
    \   doc: Training a randomforest calssifier on callifornia data and track it using
    mlflow\n    requirements:\n      - class: ScatterFeatureRequirement\n    inputs:\n
    \     n_estimators:\n        label: number of estimator\n        doc: number of
    estimator\n        type: int[]\n      max_depth:\n        label: max_depth\n        doc:
    max_depth\n        type: int[]\n        default: [10]\n      random_state:\n        label:
    random_state\n        doc: random_state to avoid overfitting\n        type: int[]\n
    \       default: [100]\n      \n    outputs: \n      - id: feature_importances\n
    \       outputSource: \n          - train/feature_importances\n        type: File[]\n
    \   steps:\n      train:\n        run: \"#train\"\n        in:\n          n_estimators:
    n_estimators\n          max_depth: max_depth\n          random_state: random_state\n
    \       out: \n          - feature_importances\n        scatter: \n          -
    n_estimators\n          - max_depth\n          - random_state\n        scatterMethod:
    dotproduct\n\n\n\n  - class: CommandLineTool\n    id: train\n    requirements:\n
    \     InlineJavascriptRequirement: {}\n      EnvVarRequirement:\n        envDef:\n
    \         PATH: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n
    \         PYTHONPATH: /app\n          MLFLOW_TRACKING_URI: http://mlflow-service:5000\n
    \         MLFLOW_S3_ENDPOINT_URL: http://minio-service:9000\n          MLFLOW_BUCKET:
    mlflow\n          AWS_ACCESS_KEY_ID: minioadmin\n          AWS_SECRET_ACCESS_KEY:
    minioadmin\n          MLFLOW_VERSION: 2.6.0\n          artifacts-destination:
    s3://mlflow\n      ResourceRequirement:\n        coresMax: 1\n        ramMax:
    512\n    hints:\n      DockerRequirement:\n        dockerPull: training-container:0.1\n
    \   \n    baseCommand: [\"python\", \"-m\", \"script\"]\n    arguments: []\n    \n
    \   inputs:\n      n_estimators:\n        type: int\n        inputBinding:\n          prefix:
    --n_estimators\n      max_depth:\n        type: int\n        inputBinding:\n          prefix:
    --max_depth\n      random_state:\n        type: int\n        inputBinding:\n          prefix:
    --random_state\n      \n    outputs: \n      feature_importances:\n        outputBinding:\n
    \         glob: '*.csv'\n        type: File\n        \n  "
kind: ConfigMap
metadata:
  name: train-conf
  namespace: test

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps24.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to plone-project/ConfigMap/plone-conf:
apiVersion: v1
data:
  BASE_URL: plone.hostlocal
  DEBUG: superagent
  RAZZLE_API_PATH: http://plone.hostlocal
  RAZZLE_INTERNAL_API_PATH: http://backend:8080/Plone
  SITE: Plone
kind: ConfigMap
metadata:
  name: plone-conf
  namespace: plone-project

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps25.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/eazybank-configmap:
apiVersion: v1
data:
  ACCOUNTS_APPLICATION_NAME: accounts
  CARDS_APPLICATION_NAME: card
  CONFIGSERVER_APPLICATION_NAME: configserver
  EUREKA_APPLICATION_NAME: eurekaserver
  EUREKA_CLIENT_SERVICEURL_DEFAULTZONE: http://eurekaserver:8070/eureka/
  GATEWAY_APPLICATION_NAME: gatewayserver
  KEYCLOAK_ADMIN: admin
  KEYCLOAK_ADMIN_PASSWORD: admin
  LOANS_APPLICATION_NAME: loan
  SPRING_CONFIG_IMPORT: configserver:http://configserver:8071/
  SPRING_PROFILES_ACTIVE: prod
  SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_JWK-SET-URI: http://keycloak:7080/realms/master/protocol/openid-connect/certs
kind: ConfigMap
metadata:
  name: eazybank-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps26.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-name:
apiVersion: v1
data:
  ENV: VALUE
kind: ConfigMap
metadata:
  name: configmap-name
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps27.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/db-init-script:
apiVersion: v1
data:
  init.sql: |
    CREATE TABLE mytable (
      message VARCHAR(255)
    );

    INSERT INTO mytable (message)
    VALUES ('This is a sample message');
kind: ConfigMap
metadata:
  name: db-init-script
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps27_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/env-vars:
apiVersion: v1
data:
  DB_HOST: db-service
  POSTGRES_DB: mydb
kind: ConfigMap
metadata:
  name: env-vars
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to n8n/ConfigMap/n8n-configmap:
apiVersion: v1
data:
  GENERIC_TIMEZONE: America/Los_Angeles
  N8N_DIAGNOSTICS_ENABLED: "false"
  N8N_HIDE_USAGE_PAGE: "true"
  N8N_HIRING_BANNER_ENABLED: "false"
  N8N_METRICS: "true"
  N8N_PERSONALIZATION_ENABLED: "false"
  N8N_PROTOCOL: http
  N8N_SMTP_SENDER: N8N <n8n@whitestar.systems>
  N8N_VERSION_NOTIFICATIONS_ENABLED: "false"
  TZ: America/Los_Angeles
  WEBHOOK_TUNNEL_URL: https://n8n.brickyard.whitestar.systems/
kind: ConfigMap
metadata:
  labels:
    app: n8n
    component: configmap
  name: n8n-configmap
  namespace: n8n

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps-3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/cmvolume:
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    run: cmvolume
  name: cmvolume
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - ls /etc/lala
    image: nginx
    name: cmvolume
    resources: {}
    volumeMounts:
    - mountPath: /etc/lala
      name: cmvolume
  dnsPolicy: ClusterFirst
  restartPolicy: Never
  volumes:
  - configMap:
      name: cmvolume
    name: cmvolume
status: {}

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/cmvolume

skipped mutate policy add-safe-to-evict -> resource default/Pod/cmvolume
policy disallow-default-namespace -> resource default/Pod/cmvolume failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/cmvolume failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/cmvolume failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/cmvolume failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/cmvolume failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Pod/cmvolume failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/limits/

policy require-pod-probes -> resource default/Pod/cmvolume failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/cmvolume failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/cmvolume failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmaps30.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-name:
apiVersion: v1
data:
  ENV: VALUE
kind: ConfigMap
metadata:
  name: configmap-name
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps31.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  APP_COLOR: blue
  APP_MODE: prod
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps32.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/eazybank-configmap:
apiVersion: v1
data:
  ACCOUNTS_APPLICATION_NAME: accounts
  CARDS_APPLICATION_NAME: cards
  CONFIGSERVER_APPLICATION_NAME: configserver
  EUREKA_APPLICATION_NAME: eurekaserver
  EUREKA_CLIENT_SERVICEURL_DEFAULTZONE: http://eurekaserver:8070/eureka/
  GATEWAY_APPLICATION_NAME: gatewayserver
  KEYCLOAK_ADMIN: admin
  KEYCLOAK_ADMIN_PASSWORD: admin
  LOANS_APPLICATION_NAME: loans
  SPRING_CONFIG_IMPORT: configserver:http://configserver:8071/
  SPRING_PROFILES_ACTIVE: prod
  SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_JWK_SET_URI: http://keycloak:7080/realms/master/protocol/openid-connect/certs
kind: ConfigMap
metadata:
  name: eazybank-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps33.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-name:
apiVersion: v1
data:
  ENV: VALUE
kind: ConfigMap
metadata:
  name: configmap-name
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configMaps34.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/config-demo-test:
apiVersion: v1
data:
  level.properties: |
    level.types=easy,medium,hard
    level.maximum-level=13
  level_properties_file_name: config-demo.properties
  levels: "12"
kind: ConfigMap
metadata:
  name: config-demo-test
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps36.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/app-config:
apiVersion: v1
data:
  APP_COLOR: blue
  APP_MODE: prod
kind: ConfigMap
metadata:
  name: app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps38.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/eureka-cm:
apiVersion: v1
data:
  eureka-service-url: http://eureka-0.eureka:8761/eureka
kind: ConfigMap
metadata:
  name: eureka-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps38_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/config-cm:
apiVersion: v1
data:
  config-url: http://config-service-svc
kind: ConfigMap
metadata:
  name: config-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps38_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-cm:
apiVersion: v1
data:
  hostname: mysql-0.mysql
kind: ConfigMap
metadata:
  name: mysql-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps39.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-name:
apiVersion: v1
data:
  ENV: VALUE
kind: ConfigMap
metadata:
  name: configmap-name
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-name:
apiVersion: v1
data:
  ENV: VALUE
kind: ConfigMap
metadata:
  name: configmap-name
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: ConfigMaps40.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/currency-conversion-config-map:
apiVersion: v1
data:
  CURRENCY_EXCHANGE_SERVICE_HOST: http://currency-exchange
kind: ConfigMap
metadata:
  name: currency-conversion-config-map
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps43.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-name:
apiVersion: v1
data:
  ENV: VALUE
kind: ConfigMap
metadata:
  name: configmap-name
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps44.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/myconfig:
apiVersion: v1
data:
  MQ_ROUTING_KEY: test
kind: ConfigMap
metadata:
  name: myconfig
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configmap-name:
apiVersion: v1
data:
  ENV: VALUE
kind: ConfigMap
metadata:
  name: configmap-name
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps6.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to rocketchat/ConfigMap/jitsi-envs:
apiVersion: v1
data:
  ETHERPAD_DEFAULT_PAD_TEXT: '"Welcome to Web Chat!\n\n"'
  ETHERPAD_SKIN_NAME: colibris
  ETHERPAD_SKIN_VARIANTS: '"super-light-toolbar super-light-editor light-background
    full-width-editor"'
  ETHERPAD_TITLE: Video Chat
  HTTP_PORT: "80"
  HTTPS_PORT: "443"
  JIBRI_RECORDER_PASSWORD: 57969777b35e6040791212b1aa26ff36
  JIBRI_XMPP_PASSWORD: 38f7da1f75c78e27f7cf93fe772a79c1
  JICOFO_AUTH_PASSWORD: fcd121582ec8322f5fc262a398fe7c8e
  JIGASI_XMPP_PASSWORD: b984fb9c2509d4831419a1fa7e477dec
  JVB_ADVERTISE_IPS: 188.213.199.91,188.213.199.100
  JVB_AUTH_PASSWORD: 6ea25fdc9611b6df32a0dfac49fa773f
  JVB_PORT: "30300"
  PUBLIC_URL: https://jitsi.nitamowj.ir
  TURN_CREDENTIALS: jr00QMMfECtfMCwKewZTPh23sdf3m3DeusUPkgQfFRTzUg1VC6KsBIiqiFFeP
  TURN_HOST: 188.213.199.91
  TURN_PORT: "3478"
  TZ: Europe/Budapest
  XMPP_BOSH_URL_BASE: http://127.0.0.1:5280
  XMPP_SERVER: localhost
kind: ConfigMap
metadata:
  name: jitsi-envs
  namespace: rocketchat

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps7.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/my-configmap:
apiVersion: v1
data:
  app-config: |
    exampleKey: exampleValue
kind: ConfigMap
metadata:
  name: my-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps8.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/argocd-cmd-params-cm:
apiVersion: v1
data:
  application.namespaces: core-apps, test-apps, simple-apps
  server.insecure: "true"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: argocd-cmd-params-cm
    app.kubernetes.io/part-of: argocd
  name: argocd-cmd-params-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps8_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/argocd-cm:
apiVersion: v1
data:
  accounts.wim: apiKey, login
  exec.enabled: "true"
  kustomize.buildOptions: --enable-helm
  statusbadge.enabled: "true"
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: argocd-cm
    app.kubernetes.io/part-of: argocd
  name: argocd-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps8_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/argocd-rbac-cm:
apiVersion: v1
data:
  policy.csv: |
    p, role:test-role, applications, get, */*, allow
    p, role:test-role, projects, get, *, allow
    g, wim, role:test-role
  policy.default: ""
kind: ConfigMap
metadata:
  labels:
    app.kubernetes.io/name: argocd-rbac-cm
    app.kubernetes.io/part-of: argocd
  name: argocd-rbac-cm
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps-datasources1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to monitoring/ConfigMap/kube-prometheus-stack-plutono-datasource:
apiVersion: v1
data:
  datasource.yaml: |-
    apiVersion: 1
    datasources:
    - name: Prometheus
      type: prometheus
      uid: prometheus
      url: http://kube-prometheus-stack-prometheus.monitoring:9090/
      access: proxy
      isDefault: true
      jsonData:
        httpMethod: POST
        timeInterval: 30s
    - name: Alertmanager
      type: alertmanager
      uid: alertmanager
      url: http://kube-prometheus-stack-alertmanager.monitoring:9093/
      access: proxy
      jsonData:
        handleGrafanaManagedAlerts: false
        implementation: prometheus
kind: ConfigMap
metadata:
  labels:
    app: kube-prometheus-stack-plutono
    app.kubernetes.io/instance: kube-prometheus-stack
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/part-of: kube-prometheus-stack
    app.kubernetes.io/version: 47.1.0
    chart: kube-prometheus-stack-47.1.0
    grafana_datasource: "1"
    heritage: Helm
    release: kube-prometheus-stack
  name: kube-prometheus-stack-plutono-datasource
  namespace: monitoring

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps-datasources5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to monitoring/ConfigMap/kube-prometheus-stack-plutono-datasource:
apiVersion: v1
data:
  datasource.yaml: |-
    apiVersion: 1
    datasources:
    - name: Prometheus
      type: prometheus
      uid: prometheus
      url: http://kube-prometheus-stack-prometheus.monitoring:9090/
      access: proxy
      isDefault: true
      jsonData:
        httpMethod: POST
        timeInterval: 30s
    - name: Alertmanager
      type: alertmanager
      uid: alertmanager
      url: http://kube-prometheus-stack-alertmanager.monitoring:9093/
      access: proxy
      jsonData:
        handleGrafanaManagedAlerts: false
        implementation: prometheus
kind: ConfigMap
metadata:
  labels:
    app: kube-prometheus-stack-plutono
    app.kubernetes.io/instance: kube-prometheus-stack
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/part-of: kube-prometheus-stack
    app.kubernetes.io/version: 47.1.0
    chart: kube-prometheus-stack-47.1.0
    grafana_datasource: "1"
    heritage: Helm
    release: kube-prometheus-stack
  name: kube-prometheus-stack-plutono-datasource
  namespace: monitoring

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configmaps-pod.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/web:
apiVersion: v1
kind: Pod
metadata:
  name: web
  namespace: default
spec:
  containers:
  - envFrom:
    - configMapRef:
        name: rds-configmap
    image: httpd:latest
    name: web

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/web

skipped mutate policy add-safe-to-evict -> resource default/Pod/web
policy disallow-default-namespace -> resource default/Pod/web failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/web failed:
1 - validate-image-tag validation failure: validation error: Using a mutable image tag e.g. 'latest' is not allowed. rule validate-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/web failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/web failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/web failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/web failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/web failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/web failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/web failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmaps-pod1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/web:
apiVersion: v1
kind: Pod
metadata:
  name: web
  namespace: default
spec:
  containers:
  - envFrom:
    - configMapRef:
        name: rds-configmap
    image: httpd:latest
    name: web

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/web

skipped mutate policy add-safe-to-evict -> resource default/Pod/web
policy disallow-default-namespace -> resource default/Pod/web failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/web failed:
1 - validate-image-tag validation failure: validation error: Using a mutable image tag e.g. 'latest' is not allowed. rule validate-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/web failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/web failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/web failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/web failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/web failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/web failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/web failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmaps-pod2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/web:
apiVersion: v1
kind: Pod
metadata:
  name: web
  namespace: default
spec:
  containers:
  - envFrom:
    - configMapRef:
        name: rds-configmap
    image: httpd:latest
    name: web

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/web

skipped mutate policy add-safe-to-evict -> resource default/Pod/web
policy disallow-default-namespace -> resource default/Pod/web failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/web failed:
1 - validate-image-tag validation failure: validation error: Using a mutable image tag e.g. 'latest' is not allowed. rule validate-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/web failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/web failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/web failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/web failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/web failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/web failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/web failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configmapwebserver.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to frontend/ConfigMap/webserver-cm:
apiVersion: v1
data:
  DB_HOSTNAME: db-svc.backend
  DB_USER: formacion
kind: ConfigMap
metadata:
  name: webserver-cm
  namespace: frontend

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-announcement-config:
apiVersion: v1
data:
  ANNOUNCE_WIDGET_URL: ""
  ANNOUNCEMENT_ENABLED: "false"
kind: ConfigMap
metadata:
  name: pl-announcement-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-ld-config:
apiVersion: v1
data:
  PL_LD_CLIENT_ID: ""
  PL_LD_SDK_KEY: ""
kind: ConfigMap
metadata:
  name: pl-ld-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-oauth-config:
apiVersion: v1
data:
  PL_AUTH_CLIENT_ID: auth-code-client
  PL_AUTH_EMAIL_PASSWORD_CONN: ""
  PL_AUTH_URI: /oauth/hydra
  PL_OAUTH_PROVIDER: hydra
kind: ConfigMap
metadata:
  name: pl-oauth-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/segment-config:
apiVersion: v1
data:
  cli-write-key: ""
  ui-write-key: ""
  write-key: ""
kind: ConfigMap
metadata:
  name: segment-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-sentry-dsn-config:
apiVersion: v1
data:
  PL_DEV_SENTRY: ""
  PL_OPERATOR_SENTRY: ""
  PL_PROD_SENTRY: ""
kind: ConfigMap
metadata:
  name: pl-sentry-dsn-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs_5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-auth-connector-config:
apiVersion: v1
data:
  PL_AUTH_CONNECTOR_CALLBACK_URL: ""
  PL_AUTH_CONNECTOR_NAME: ""
kind: ConfigMap
metadata:
  name: pl-auth-connector-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs_6.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-errors-config:
apiVersion: v1
data:
  PL_SENTRY_DSN: ""
kind: ConfigMap
metadata:
  name: pl-errors-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configs:
apiVersion: v1
data:
  INVENTORY_SERVICE_HOST: inventory-service-svc
  KAFKA_BROKER_URL: kafka-svc:9092
  NOTIFICATION_SERVICE_HOST: notification-service-svc
  ORDER_SERVICE_HOST: order-service-svc
  SPRING_PROFILES_ACTIVE: kubernetes
kind: ConfigMap
metadata:
  name: configs
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-announcement-config:
apiVersion: v1
data:
  ANNOUNCE_WIDGET_URL: ""
  ANNOUNCEMENT_ENABLED: "false"
kind: ConfigMap
metadata:
  name: pl-announcement-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs2_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-ld-config:
apiVersion: v1
data:
  PL_LD_CLIENT_ID: ""
  PL_LD_SDK_KEY: ""
kind: ConfigMap
metadata:
  name: pl-ld-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs2_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-oauth-config:
apiVersion: v1
data:
  PL_AUTH_CLIENT_ID: auth-code-client
  PL_AUTH_EMAIL_PASSWORD_CONN: ""
  PL_AUTH_URI: /oauth/hydra
  PL_OAUTH_PROVIDER: hydra
kind: ConfigMap
metadata:
  name: pl-oauth-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs2_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/segment-config:
apiVersion: v1
data:
  cli-write-key: ""
  ui-write-key: ""
  write-key: ""
kind: ConfigMap
metadata:
  name: segment-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs2_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-sentry-dsn-config:
apiVersion: v1
data:
  PL_DEV_SENTRY: ""
  PL_OPERATOR_SENTRY: ""
  PL_PROD_SENTRY: ""
kind: ConfigMap
metadata:
  name: pl-sentry-dsn-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs2_5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-auth-connector-config:
apiVersion: v1
data:
  PL_AUTH_CONNECTOR_CALLBACK_URL: ""
  PL_AUTH_CONNECTOR_NAME: ""
kind: ConfigMap
metadata:
  name: pl-auth-connector-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs2_6.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/pl-errors-config:
apiVersion: v1
data:
  PL_SENTRY_DSN: ""
kind: ConfigMap
metadata:
  name: pl-errors-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configs:
apiVersion: v1
data:
  INVENTORY_SERVICE_HOST: inventory-service-svc
  KAFKA_BROKER_URL: kafka-svc:9092
  NOTIFICATION_SERVICE_HOST: notification-service-svc
  ORDER_SERVICE_HOST: order-service-svc
  SPRING_PROFILES_ACTIVE: kubernetes
kind: ConfigMap
metadata:
  name: configs
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configs5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/post-app-config:
apiVersion: v1
data:
  mongodb_database: post-database
  mongodb_uri: mongodb://mongodb-service.default.svc.cluster.local:27017
  post_api_svc_host: http://post-api-service.default.svc.cluster.local:8090
kind: ConfigMap
metadata:
  name: post-app-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configserver.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/configserver-deployment:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: configserver
  name: configserver-deployment
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      app: configserver
  template:
    metadata:
      labels:
        app: configserver
    spec:
      containers:
      - image: eazybytes/configserver:s14
        name: configserver
        ports:
        - containerPort: 8071

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/configserver-deployment

skipped mutate policy add-safe-to-evict -> resource default/Deployment/configserver-deployment
policy disallow-default-namespace -> resource default/Deployment/configserver-deployment failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/configserver-deployment failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/configserver-deployment failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/configserver-deployment failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/configserver-deployment failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-pod-probes -> resource default/Deployment/configserver-deployment failed:
1 - autogen-validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Deployment/configserver-deployment failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/configserver-deployment failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 7, fail: 8, warn: 0, error: 0, skip: 2 

##### FILE: configserver_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/configserver:
apiVersion: v1
kind: Service
metadata:
  name: configserver
  namespace: default
spec:
  ports:
  - port: 8071
    protocol: TCP
    targetPort: 8071
  selector:
    app: configserver
  type: LoadBalancer

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configurable-http.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to configurable/Ingress/configurable:
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: configurable
  namespace: configurable
spec:
  rules:
  - host: configurable.local
    http:
      paths:
      - backend:
          service:
            name: configurable-web
            port:
              name: config-app
        path: /
        pathType: Prefix

---


Mutation:
Mutation has been applied successfully.
pass: 1, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configuration20.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/home-assistant-configmap:
apiVersion: v1
data:
  automations.yaml: ""
  configuration.yaml: |-
    default_config:
    frontend:
      themes: !include_dir_merge_named themes
    automation: !include automations.yaml
    http:
      use_x_forwarded_for: true
      trusted_proxies:
        - 10.0.0.0/8
        - 192.168.1.0/24
    influxdb:
      api_version: 2
      ssl: true
      host: hassinfluxdb.labjoel.com
      port: 443
      token: d4InMfj9fzQujamPxmJX8LDhQe_uSejNl69RKt5lprMIJ-Fzvnq8av1zaztE3GtPea6VeHJbQ6a7xO7gd28w-g==
      organization: eacd969295c79dc9
      bucket: default
      tags:
        source: HA
      tags_attributes:
        - friendly_name
      default_measurement: units
  known_devices.yaml: ""
kind: ConfigMap
metadata:
  name: home-assistant-configmap
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configuration21.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/bluepill:
apiVersion: v1
data:
  BLUEPILL_ENFORCEMENT_ENFORCE: "true"
  BLUEPILL_ENFORCEMENT_WHITELIST_FILE: /config/whitelist.txt
  BLUEPILL_HTTP_CERTIFICATE_FILE: /secrets/cert.pem
  BLUEPILL_HTTP_KEY_FILE: /secrets/key.pem
  BLUEPILL_HTTP_PORT: "8443"
kind: ConfigMap
metadata:
  name: bluepill
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configuration23.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/postgres:
apiVersion: v1
data:
  POSTGRES_DB: postgres
  POSTGRES_PASSWORD: api-service-password
  POSTGRES_USER: api-service-user
kind: ConfigMap
metadata:
  labels:
    app: postgres
  name: postgres
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configuration24.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/configuration:
apiVersion: v1
data: {}
kind: ConfigMap
metadata:
  name: configuration
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configuration25.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to observability/ConfigMap/opentelemetry-collector-conf:
apiVersion: v1
data:
  opentelemetry-collector-config: |
    receivers:
        opencensus:
            endpoint: 0.0.0.0:55678
        otlp:
            protocols:
                grpc:
                http:
    processors:
        batch:
    exporters:
        zipkin:
            # Export to zipkin for easy querying
            endpoint: http://zipkin.istio-system.svc:9411/api/v2/spans
        logging:
            loglevel: debug
        jaeger:
            endpoint: jaeger-collector.istio-system.svc.cluster.local:14250
            tls:
                insecure: true
            sending_queue:
                enabled: true
            retry_on_failure:
                enabled: true
    extensions:
        health_check:
            port: 13133
    service:
        extensions:
            - health_check
        pipelines:
            logs:
                receivers: [ otlp ]
                processors: [ batch ]
                exporters: [ logging ]
            metrics:
                receivers: [ otlp ]
                exporters: [ logging ]
            traces:
                receivers:
                    - otlp
                    - opencensus
                exporters:
                    - zipkin
                    - logging
                    - jaeger
kind: ConfigMap
metadata:
  labels:
    app: opentelemetry-collector
  name: opentelemetry-collector-conf
  namespace: observability

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configuration25_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to observability/Service/opentelemetry-collector:
apiVersion: v1
kind: Service
metadata:
  labels:
    app: opentelemetry-collector
  name: opentelemetry-collector
  namespace: observability
spec:
  ports:
  - name: grpc-opencensus
    port: 55678
    protocol: TCP
    targetPort: 55678
  - name: grpc-otlp
    port: 4317
    protocol: TCP
    targetPort: 4317
  - name: http-otlp
    port: 4318
    protocol: TCP
    targetPort: 4318
  selector:
    app: opentelemetry-collector

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configuration25_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to observability/Deployment/opentelemetry-collector:
apiVersion: apps/v1
kind: Deployment
metadata:
  name: opentelemetry-collector
  namespace: observability
spec:
  selector:
    matchLabels:
      app: opentelemetry-collector
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: opentelemetry-collector
        sidecar.istio.io/inject: "false"
    spec:
      containers:
      - command:
        - /otelcol
        - --config=/conf/opentelemetry-collector-config.yaml
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        image: otel/opentelemetry-collector:0.54.0
        imagePullPolicy: IfNotPresent
        name: opentelemetry-collector
        ports:
        - containerPort: 4317
          protocol: TCP
        - containerPort: 4318
          protocol: TCP
        - containerPort: 55678
          name: grpc-opencensus
          protocol: TCP
        resources:
          limits:
            cpu: "2"
            memory: 4Gi
          requests:
            cpu: 200m
            memory: 400Mi
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /conf
          name: opentelemetry-collector-config-vol
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      terminationGracePeriodSeconds: 30
      volumes:
      - configMap:
          defaultMode: 420
          items:
          - key: opentelemetry-collector-config
            path: opentelemetry-collector-config.yaml
          name: opentelemetry-collector-conf
        name: opentelemetry-collector-config-vol

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource observability/Deployment/opentelemetry-collector

skipped mutate policy add-safe-to-evict -> resource observability/Deployment/opentelemetry-collector
policy drop-all-capabilities -> resource observability/Deployment/opentelemetry-collector failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource observability/Deployment/opentelemetry-collector failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource observability/Deployment/opentelemetry-collector failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-pod-probes -> resource observability/Deployment/opentelemetry-collector failed:
1 - autogen-validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource observability/Deployment/opentelemetry-collector failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource observability/Deployment/opentelemetry-collector failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 9, fail: 6, warn: 0, error: 0, skip: 2 

##### FILE: configuration28.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/redis-configuration:
apiVersion: v1
data:
  redis-config: |
    loglevel debug
kind: ConfigMap
metadata:
  name: redis-configuration
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configuration-configmap-filelike.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/web-configuration-configmap-filelike:
apiVersion: v1
data:
  web-app.properties: |
    user.name=Peter
    user.lastname=Novac
    user.birthdate=10.05.1980
    user.family=Anna,Tom
kind: ConfigMap
metadata:
  name: web-configuration-configmap-filelike
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configuration-configmap-propertylike.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/web-configuration-configmap-propertylike:
apiVersion: v1
data:
  birthdate: 10.05.1980
  lastname: Novac
  name: Peter
kind: ConfigMap
metadata:
  name: web-configuration-configmap-propertylike
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configuration-secret.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Secret/web-secret:
apiVersion: v1
data:
  password: c29tZV9wYXNzd29yZA==
  username: c29tZV91c2VybmFtZQ==
kind: Secret
metadata:
  name: web-secret
  namespace: default
type: Opaque

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: configure-pod.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/configmap-demo-pod:
apiVersion: v1
kind: Pod
metadata:
  name: configmap-demo-pod
  namespace: default
spec:
  containers:
  - command:
    - sleep
    - "3600"
    env:
    - name: PLAYER_INITIAL_LIVES
      valueFrom:
        configMapKeyRef:
          key: player_initial_lives
          name: game-demo
    - name: UI_PROPERTIES_FILE_NAME
      valueFrom:
        configMapKeyRef:
          key: ui_properties_file_name
          name: game-demo
    image: alpine
    name: demo
    volumeMounts:
    - mountPath: /config
      name: config
      readOnly: true
  volumes:
  - configMap:
      items:
      - key: game.properties
        path: game.properties
      - key: user-interface.properties
        path: user-interface.properties
      name: game-demo
    name: config

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/configmap-demo-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/configmap-demo-pod
policy disallow-default-namespace -> resource default/Pod/configmap-demo-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/configmap-demo-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/configmap-demo-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/configmap-demo-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/configmap-demo-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/configmap-demo-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/configmap-demo-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/configmap-demo-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/configmap-demo-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configvolume.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/test-pod:
apiVersion: v1
kind: Pod
metadata:
  name: test-pod
  namespace: default
spec:
  containers:
  - command:
    - /bin/sh
    - -c
    - ls /etc/config/
    image: k8s.gcr.io/busybox
    name: container-with-volume
    volumeMounts:
    - mountPath: /etc/config
      name: config-volume
  restartPolicy: Never
  volumes:
  - configMap:
      name: config-for-volume
    name: config-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/test-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/test-pod
policy disallow-default-namespace -> resource default/Pod/test-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Pod/test-pod failed:
1 - require-image-tag validation failure: validation error: An image tag is required. rule require-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Pod/test-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/test-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/test-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/test-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource default/Pod/test-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/test-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/test-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: configVolume1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Pod/configmap-pod:
apiVersion: v1
kind: Pod
metadata:
  name: configmap-pod
  namespace: default
spec:
  containers:
  - command:
    - sh
    - -c
    - echo "The app is running!" && tail -f /dev/null
    image: busybox:1.28
    name: test
    resources:
      limits:
        cpu: 500m
        memory: 128Mi
    volumeMounts:
    - mountPath: /etc/config
      name: config-vol
  volumes:
  - configMap:
      items:
      - key: log_level
        path: log_level
      name: log-config
    name: config-vol

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Pod/configmap-pod

skipped mutate policy add-safe-to-evict -> resource default/Pod/configmap-pod
policy disallow-default-namespace -> resource default/Pod/configmap-pod failed:
1 - validate-namespace validation error: Using 'default' namespace is not allowed. rule validate-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Pod/configmap-pod failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Pod/configmap-pod failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Pod/configmap-pod failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource default/Pod/configmap-pod failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/requests/

policy require-pod-probes -> resource default/Pod/configmap-pod failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Pod/configmap-pod failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Pod/configmap-pod failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 7, fail: 8, warn: 0, error: 0, skip: 2 

##### FILE: confined.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to seccomp-demo/Pod/hello-python:
apiVersion: v1
kind: Pod
metadata:
  labels:
    app: hello-python
  name: hello-python
  namespace: seccomp-demo
spec:
  containers:
  - image: tiangolo/uwsgi-nginx-flask:latest
    imagePullPolicy: Always
    name: hello-python
    ports:
    - containerPort: 80
    volumeMounts:
    - mountPath: /app/
      name: app-script
  securityContext:
    seccompProfile:
      localhostProfile: operator/gadget/hello-python.json
      type: Localhost
  volumes:
  - configMap:
      name: app-script
    name: app-script

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource seccomp-demo/Pod/hello-python

skipped mutate policy add-safe-to-evict -> resource seccomp-demo/Pod/hello-python
policy disallow-latest-tag -> resource seccomp-demo/Pod/hello-python failed:
1 - validate-image-tag validation failure: validation error: Using a mutable image tag e.g. 'latest' is not allowed. rule validate-image-tag failed at path /image/

policy drop-all-capabilities -> resource seccomp-demo/Pod/hello-python failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource seccomp-demo/Pod/hello-python failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource seccomp-demo/Pod/hello-python failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource seccomp-demo/Pod/hello-python failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource seccomp-demo/Pod/hello-python failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource seccomp-demo/Pod/hello-python failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource seccomp-demo/Pod/hello-python failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 7, fail: 8, warn: 0, error: 0, skip: 2 

##### FILE: conformance-e2e.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e1_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e1_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e1_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e1_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e10.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e10_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e10_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e10_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e10_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e11.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e11_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e11_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e11_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e11_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e13.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e13_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e13_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e13_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e13_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: k8s.gcr.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e14.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e14_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e14_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e14_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e14_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e15.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e15_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e15_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e15_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e15_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e17.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e17_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e17_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e17_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e17_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e18.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e18_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e18_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e18_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e18_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e19.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e19_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e19_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e19_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e19_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e2_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e2_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e2_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e2_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e3_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e3_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e3_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e3_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e4_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e4_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e4_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e4_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: k8s.gcr.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e5_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e5_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e5_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e5_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: k8s.gcr.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e6.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e6_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e6_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e6_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e6_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e7.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e7_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e7_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e7_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e7_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: registry.k8s.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e8.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e8_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e8_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e8_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e8_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: k8s.gcr.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: conformance-e2e9.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Namespace/conformance:
apiVersion: v1
kind: Namespace
metadata:
  name: conformance
  namespace: default

---


Mutation:
Mutation has been applied successfully.
policy add-networkpolicy applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: default-deny
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-deny
  namespace: conformance
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---


Generate:
Generation completed successfully.
policy add-networkpolicy-dns applied to default/Namespace/conformance:
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-networkpolicy-dns
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: add-netpol-dns
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: allow-dns
  namespace: conformance
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  podSelector:
    matchLabels: {}
  policyTypes:
  - Egress

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: ResourceQuota
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-resourcequota
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-resourcequota
  namespace: conformance
spec:
  hard:
    limits.cpu: "4"
    limits.memory: 16Gi
    requests.cpu: "4"
    requests.memory: 16Gi

---


Generate:
Generation completed successfully.
policy add-ns-quota applied to default/Namespace/conformance:
apiVersion: v1
kind: LimitRange
metadata:
  labels:
    app.kubernetes.io/managed-by: kyverno
    generate.kyverno.io/policy-name: add-ns-quota
    generate.kyverno.io/policy-namespace: ""
    generate.kyverno.io/rule-name: generate-limitrange
    generate.kyverno.io/trigger-group: ""
    generate.kyverno.io/trigger-kind: Namespace
    generate.kyverno.io/trigger-namespace: default
    generate.kyverno.io/trigger-uid: ""
    generate.kyverno.io/trigger-version: v1
  name: default-limitrange
  namespace: conformance
spec:
  limits:
  - default:
      cpu: 500m
      memory: 1Gi
    defaultRequest:
      cpu: 200m
      memory: 256Mi
    type: Container

---


Generate:
Generation completed successfully.
pass: 5, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e9_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/ServiceAccount/conformance-serviceaccount:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e9_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/conformance-serviceaccount-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount-role
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: conformance-serviceaccount
subjects:
- kind: ServiceAccount
  name: conformance-serviceaccount
  namespace: conformance

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e9_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conformance-serviceaccount:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    component: conformance
  name: conformance-serviceaccount
  namespace: default
rules:
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - '*'
- nonResourceURLs:
  - /metrics
  - /logs
  - /logs/*
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conformance-e2e9_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to conformance/Pod/e2e-conformance-test:
apiVersion: v1
kind: Pod
metadata:
  annotations:
    cluster-autoscaler.kubernetes.io/safe-to-evict: "true"
  name: e2e-conformance-test
  namespace: conformance
spec:
  containers:
  - env:
    - name: E2E_FOCUS
      value: \[Conformance\]
    - name: E2E_SKIP
      value: ""
    - name: E2E_PROVIDER
      value: skeleton
    - name: E2E_PARALLEL
      value: "false"
    - name: E2E_VERBOSITY
      value: "4"
    image: k8s.gcr.io/conformance-amd64:v1.14
    imagePullPolicy: IfNotPresent
    name: conformance-container
    volumeMounts:
    - mountPath: /tmp/results
      name: output-volume
  restartPolicy: Never
  serviceAccountName: conformance-serviceaccount
  volumes:
  - hostPath:
      path: /tmp/results
    name: output-volume

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource conformance/Pod/e2e-conformance-test
policy drop-all-capabilities -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource conformance/Pod/e2e-conformance-test failed:
1 - require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource conformance/Pod/e2e-conformance-test failed:
1 - check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule check-for-labels failed at path /metadata/labels/

policy require-requests-limits -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule validate-resources failed at path /spec/containers/0/resources/

policy require-pod-probes -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule validate-readOnlyRootFilesystem failed at path /spec/containers/0/securityContext/

policy restrict-image-registries -> resource conformance/Pod/e2e-conformance-test failed:
1 - validate-registries validation error: Unknown image registry. rule validate-registries failed at path /spec/containers/0/image/


pass: 9, fail: 7, warn: 0, error: 0, skip: 1 

##### FILE: congifM.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mongo-config:
apiVersion: v1
data:
  mongo-url: MongoDB-Service
kind: ConfigMap
metadata:
  name: mongo-config
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conigmap.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ConfigMap/mysql-creds:
apiVersion: v1
data:
  DB_HOST: 192.168.0.11
  DB_NAME: studentapp
  DB_PASSWORD: redhat123
  DB_USER: linux
kind: ConfigMap
metadata:
  name: mysql-creds
  namespace: default

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conjur_editor_role.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conjur-editor-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/component: rbac
    app.kubernetes.io/created-by: conjur-operator
    app.kubernetes.io/instance: conjur-editor-role
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: clusterrole
    app.kubernetes.io/part-of: conjur-operator
  name: conjur-editor-role
  namespace: default
rules:
- apiGroups:
  - api.0jk6.github.io
  resources:
  - conjurs
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - api.0jk6.github.io
  resources:
  - conjurs/status
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: conjur_viewer_role.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/conjur-viewer-role:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/component: rbac
    app.kubernetes.io/created-by: conjur-operator
    app.kubernetes.io/instance: conjur-viewer-role
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: clusterrole
    app.kubernetes.io/part-of: conjur-operator
  name: conjur-viewer-role
  namespace: default
rules:
- apiGroups:
  - api.0jk6.github.io
  resources:
  - conjurs
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - api.0jk6.github.io
  resources:
  - conjurs/status
  verbs:
  - get

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connect1_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to confluent/ConfigMap/connect-worker-config:
apiVersion: v1
data:
  connect-worker.properties: replication.factor=1
kind: ConfigMap
metadata:
  name: connect-worker-config
  namespace: confluent

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connect2_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to confluent/ConfigMap/connect-worker-config:
apiVersion: v1
data:
  connect-worker.properties: replication.factor=1
kind: ConfigMap
metadata:
  name: connect-worker-config
  namespace: confluent

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connect3_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to confluent/ConfigMap/connect-worker-config:
apiVersion: v1
data:
  connect-worker.properties: replication.factor=1
kind: ConfigMap
metadata:
  name: connect-worker-config
  namespace: confluent

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connect4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/jackal-connect-longhorn-ui:
apiVersion: v1
kind: Service
metadata:
  annotations:
    jackal.dev/connect-description: Connect to the Longhorn User Interface
  labels:
    jackal.dev/connect-name: longhorn-ui
  name: jackal-connect-longhorn-ui
  namespace: default
spec:
  ports:
  - name: http
    port: 8000
    protocol: TCP
    targetPort: 8000
  selector:
    app: longhorn-ui

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connect5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/jackal-connect-git:
apiVersion: v1
kind: Service
metadata:
  annotations:
    jackal.dev/connect-description: Internal Jackal Git Server (Gitea)
  labels:
    jackal.dev/connect-name: git
  name: jackal-connect-git
  namespace: default
spec:
  ports:
  - port: 3000

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connect6.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/jackal-connect-registry:
apiVersion: v1
kind: Service
metadata:
  annotations:
    jackal.dev/connect-description: Internal Jackal Registry (run jackal tools registry
      login to authenticate)
    jackal.dev/connect-url: /v2/_catalog
  labels:
    jackal.dev/connect-name: registry
  name: jackal-connect-registry
  namespace: default
spec:
  ports:
  - port: 5000

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connect7.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/jackal-connect-logging:
apiVersion: v1
kind: Service
metadata:
  annotations:
    jackal.dev/connect-description: Jackal Cluster Logging Service (Grafana)
  labels:
    jackal.dev/connect-name: logging
  name: jackal-connect-logging
  namespace: default
spec:
  ports:
  - port: 3000

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connect-deployment.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/connect:
apiVersion: apps/v1
kind: Deployment
metadata:
  name: connect
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      app: connect
  template:
    metadata:
      labels:
        app: connect
    spec:
      containers:
      - env:
        - name: CONNECT_BOOTSTRAP_SERVERS
          value: broker:29092
        - name: CONNECT_REST_ADVERTISED_HOST_NAME
          value: connect
        - name: CONNECT_GROUP_ID
          value: compose-connect-group
        - name: CONNECT_CONFIG_STORAGE_TOPIC
          value: docker-connect-configs
        - name: CONNECT_CONFIG_STORAGE_REPLICATION_FACTOR
          value: "1"
        - name: CONNECT_OFFSET_FLUSH_INTERVAL_MS
          value: "10000"
        - name: CONNECT_OFFSET_STORAGE_TOPIC
          value: docker-connect-offsets
        - name: CONNECT_OFFSET_STORAGE_REPLICATION_FACTOR
          value: "1"
        - name: CONNECT_STATUS_STORAGE_TOPIC
          value: docker-connect-status
        - name: CONNECT_STATUS_STORAGE_REPLICATION_FACTOR
          value: "1"
        - name: CONNECT_KEY_CONVERTER
          value: org.apache.kafka.connect.storage.StringConverter
        - name: CONNECT_VALUE_CONVERTER
          value: org.apache.kafka.connect.json.JsonConverter
        - name: CONNECT_VALUE_CONVERTER_SCHEMAS_ENABLE
          value: "false"
        - name: CLASSPATH
          value: /usr/share/java/monitoring-interceptors/monitoring-interceptors-7.6.1.jar
        - name: CONNECT_PRODUCER_INTERCEPTOR_CLASSES
          value: io.confluent.monitoring.clients.interceptor.MonitoringProducerInterceptor
        - name: CONNECT_CONSUMER_INTERCEPTOR_CLASSES
          value: io.confluent.monitoring.clients.interceptor.MonitoringConsumerInterceptor
        - name: CONNECT_PLUGIN_PATH
          value: /usr/share/java,/usr/share/confluent-hub-components
        - name: CONNECT_LOG4J_LOGGERS
          value: org.apache.zookeeper=INFO,org.I0Itec.zkclient=INFO,org.reflections=INFO
        image: us-central1-docker.pkg.dev/thesis-416800/uoc/mysql-kafka-connector:latest
        name: connect
        ports:
        - containerPort: 8083
      hostname: connect

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/connect

skipped mutate policy add-safe-to-evict -> resource default/Deployment/connect
policy disallow-default-namespace -> resource default/Deployment/connect failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy disallow-latest-tag -> resource default/Deployment/connect failed:
1 - autogen-validate-image-tag validation failure: validation error: Using a mutable image tag e.g. 'latest' is not allowed. rule autogen-validate-image-tag failed at path /image/

policy drop-all-capabilities -> resource default/Deployment/connect failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/connect failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/connect failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/connect failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-pod-probes -> resource default/Deployment/connect failed:
1 - autogen-validate-probes validation failure: Liveness, readiness, or startup probes are required for all containers.

policy require-ro-rootfs -> resource default/Deployment/connect failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/connect failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 6, fail: 9, warn: 0, error: 0, skip: 2 

##### FILE: connection.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRole/k8s-full-secrets-abilities-with-labels:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: k8s-full-secrets-abilities-with-labels
  namespace: default
rules:
- apiGroups:
  - ""
  resources:
  - namespaces
  verbs:
  - get
- apiGroups:
  - ""
  resources:
  - serviceaccounts
  - serviceaccounts/token
  verbs:
  - create
  - update
  - delete
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - rolebindings
  - clusterrolebindings
  verbs:
  - create
  - update
  - delete
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - roles
  - clusterroles
  verbs:
  - bind
  - escalate
  - create
  - update
  - delete

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connection_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/ClusterRoleBinding/vault-token-creator-binding:
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: vault-token-creator-binding
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: k8s-full-secrets-abilities-with-labels
subjects:
- kind: ServiceAccount
  name: vault
  namespace: vault

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connection-checker.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/__ignored__:
apiVersion: apps/v1
kind: Deployment
metadata:
  name: __ignored__
  namespace: default
spec:
  template:
    spec:
      initContainers:
      - command:
        - sh
        - -c
        - |
          echo "Waiting for $SVC_HOST to become ready..."

          until printf "." && nc -z -w 2 $(SVC_HOST) $(SVC_PORT); do
              sleep $SVC_WAIT_INTERVAL;
          done;

          echo "$SVC_HOST:$SVC_PORT connection OK "
        env:
        - name: SVC_HOST
          valueFrom:
            configMapKeyRef:
              key: SVC_HOST
              name: svcchecker
        - name: SVC_PORT
          valueFrom:
            configMapKeyRef:
              key: SVC_PORT
              name: svcchecker
        - name: SVC_WAIT_INTERVAL
          valueFrom:
            configMapKeyRef:
              key: SVC_WAIT_INTERVAL
              name: svcchecker
        image: docker.io/busybox:1.36
        imagePullPolicy: IfNotPresent
        name: svcchecker
        resources:
          limits:
            cpu: 20m
            memory: 32Mi
          requests:
            cpu: 20m
            memory: 32Mi
        securityContext:
          allowPrivilegeEscalation: false
          runAsGroup: 1000
          runAsNonRoot: true
          runAsUser: 1000
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/__ignored__

skipped mutate policy add-safe-to-evict -> resource default/Deployment/__ignored__
policy disallow-default-namespace -> resource default/Deployment/__ignored__ failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/__ignored__ failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/__ignored__ failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/__ignored__ failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/

policy require-requests-limits -> resource default/Deployment/__ignored__ failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/

policy require-ro-rootfs -> resource default/Deployment/__ignored__ failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/

policy restrict-image-registries -> resource default/Deployment/__ignored__ failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/initContainers/0/image/


pass: 7, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/echo-a:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: network-check
    name: echo-a
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-a
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: echo-a
  template:
    metadata:
      labels:
        name: echo-a
    spec:
      containers:
      - env:
        - name: PORT
          value: "8080"
        image: quay.io/cilium/json-mock:v1.3.2@sha256:bc6c46c74efadb135bc996c2467cece6989302371ef4e3f068361460abaf39be
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:8080
          timeoutSeconds: 7
        name: echo-a-container
        ports:
        - containerPort: 8080
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:8080
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-a

skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-a
policy disallow-default-namespace -> resource default/Deployment/echo-a failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/echo-a failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/echo-a failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/echo-a failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/echo-a failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/echo-a failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/echo-a failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/echo-b:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: echo-b
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-b
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: echo-b
  template:
    metadata:
      labels:
        name: echo-b
    spec:
      containers:
      - env:
        - name: PORT
          value: "8080"
        image: quay.io/cilium/json-mock:v1.3.2@sha256:bc6c46c74efadb135bc996c2467cece6989302371ef4e3f068361460abaf39be
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:8080
          timeoutSeconds: 7
        name: echo-b-container
        ports:
        - containerPort: 8080
          hostPort: 40000
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:8080
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-b

skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-b
policy disallow-default-namespace -> resource default/Deployment/echo-b failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/echo-b failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/echo-b failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/echo-b failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/echo-b failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/echo-b failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/echo-b failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_10.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-a-intra-node-proxy-egress-policy:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: proxy-check
    name: pod-to-a-intra-node-proxy-egress-policy
    quarantine: "false"
    topology: intra-node
    traffic: internal
    type: autocheck
  name: pod-to-a-intra-node-proxy-egress-policy
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-a-intra-node-proxy-egress-policy
  template:
    metadata:
      labels:
        name: pod-to-a-intra-node-proxy-egress-policy
    spec:
      affinity:
        podAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-a
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
        name: pod-to-a-intra-node-proxy-egress-policy-allow-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
        terminationMessagePolicy: FallbackToLogsOnError
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - ash
            - -c
            - '! curl -s --fail --connect-timeout 5 -o /dev/null echo-a:8080/private'
          timeoutSeconds: 7
        name: pod-to-a-intra-node-proxy-egress-policy-reject-container
        ports: []
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-intra-node-proxy-egress-policy

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-intra-node-proxy-egress-policy
policy disallow-default-namespace -> resource default/Deployment/pod-to-a-intra-node-proxy-egress-policy failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-a-intra-node-proxy-egress-policy failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-a-intra-node-proxy-egress-policy failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-a-intra-node-proxy-egress-policy failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-a-intra-node-proxy-egress-policy failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-a-intra-node-proxy-egress-policy failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-a-intra-node-proxy-egress-policy failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_11.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-a-multi-node-proxy-egress-policy:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: proxy-check
    name: pod-to-a-multi-node-proxy-egress-policy
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-a-multi-node-proxy-egress-policy
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-a-multi-node-proxy-egress-policy
  template:
    metadata:
      labels:
        name: pod-to-a-multi-node-proxy-egress-policy
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-a
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
        name: pod-to-a-multi-node-proxy-egress-policy-allow-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
        terminationMessagePolicy: FallbackToLogsOnError
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - ash
            - -c
            - '! curl -s --fail --connect-timeout 5 -o /dev/null echo-a:8080/private'
          timeoutSeconds: 7
        name: pod-to-a-multi-node-proxy-egress-policy-reject-container
        ports: []
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-multi-node-proxy-egress-policy

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-multi-node-proxy-egress-policy
policy disallow-default-namespace -> resource default/Deployment/pod-to-a-multi-node-proxy-egress-policy failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-a-multi-node-proxy-egress-policy failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-a-multi-node-proxy-egress-policy failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-a-multi-node-proxy-egress-policy failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-a-multi-node-proxy-egress-policy failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-a-multi-node-proxy-egress-policy failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-a-multi-node-proxy-egress-policy failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_12.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-c-intra-node-proxy-ingress-policy:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: proxy-check
    name: pod-to-c-intra-node-proxy-ingress-policy
    quarantine: "false"
    topology: intra-node
    traffic: internal
    type: autocheck
  name: pod-to-c-intra-node-proxy-ingress-policy
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-c-intra-node-proxy-ingress-policy
  template:
    metadata:
      labels:
        name: pod-to-c-intra-node-proxy-ingress-policy
    spec:
      affinity:
        podAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-c
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-c:8080/public
        name: pod-to-c-intra-node-proxy-ingress-policy-allow-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-c:8080/public
        terminationMessagePolicy: FallbackToLogsOnError
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - ash
            - -c
            - '! curl -s --fail --connect-timeout 5 -o /dev/null echo-c:8080/private'
          timeoutSeconds: 7
        name: pod-to-c-intra-node-proxy-ingress-policy-reject-container
        ports: []
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-c-intra-node-proxy-ingress-policy

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-c-intra-node-proxy-ingress-policy
policy disallow-default-namespace -> resource default/Deployment/pod-to-c-intra-node-proxy-ingress-policy failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-c-intra-node-proxy-ingress-policy failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-c-intra-node-proxy-ingress-policy failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-c-intra-node-proxy-ingress-policy failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-c-intra-node-proxy-ingress-policy failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-c-intra-node-proxy-ingress-policy failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-c-intra-node-proxy-ingress-policy failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_13.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-c-multi-node-proxy-ingress-policy:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: proxy-check
    name: pod-to-c-multi-node-proxy-ingress-policy
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-c-multi-node-proxy-ingress-policy
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-c-multi-node-proxy-ingress-policy
  template:
    metadata:
      labels:
        name: pod-to-c-multi-node-proxy-ingress-policy
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-c
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-c:8080/public
        name: pod-to-c-multi-node-proxy-ingress-policy-allow-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-c:8080/public
        terminationMessagePolicy: FallbackToLogsOnError
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - ash
            - -c
            - '! curl -s --fail --connect-timeout 5 -o /dev/null echo-c:8080/private'
          timeoutSeconds: 7
        name: pod-to-c-multi-node-proxy-ingress-policy-reject-container
        ports: []
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-c-multi-node-proxy-ingress-policy

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-c-multi-node-proxy-ingress-policy
policy disallow-default-namespace -> resource default/Deployment/pod-to-c-multi-node-proxy-ingress-policy failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-c-multi-node-proxy-ingress-policy failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-c-multi-node-proxy-ingress-policy failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-c-multi-node-proxy-ingress-policy failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-c-multi-node-proxy-ingress-policy failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-c-multi-node-proxy-ingress-policy failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-c-multi-node-proxy-ingress-policy failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_14.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-c-intra-node-proxy-to-proxy-policy:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: proxy-check
    name: pod-to-c-intra-node-proxy-to-proxy-policy
    quarantine: "false"
    topology: intra-node
    traffic: internal
    type: autocheck
  name: pod-to-c-intra-node-proxy-to-proxy-policy
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-c-intra-node-proxy-to-proxy-policy
  template:
    metadata:
      labels:
        name: pod-to-c-intra-node-proxy-to-proxy-policy
    spec:
      affinity:
        podAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-c
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-c:8080/public
        name: pod-to-c-intra-node-proxy-to-proxy-policy-allow-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-c:8080/public
        terminationMessagePolicy: FallbackToLogsOnError
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - ash
            - -c
            - '! curl -s --fail --connect-timeout 5 -o /dev/null echo-c:8080/private'
          timeoutSeconds: 7
        name: pod-to-c-intra-node-proxy-to-proxy-policy-reject-container
        ports: []
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-c-intra-node-proxy-to-proxy-policy

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-c-intra-node-proxy-to-proxy-policy
policy disallow-default-namespace -> resource default/Deployment/pod-to-c-intra-node-proxy-to-proxy-policy failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-c-intra-node-proxy-to-proxy-policy failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-c-intra-node-proxy-to-proxy-policy failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-c-intra-node-proxy-to-proxy-policy failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-c-intra-node-proxy-to-proxy-policy failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-c-intra-node-proxy-to-proxy-policy failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-c-intra-node-proxy-to-proxy-policy failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_15.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-c-multi-node-proxy-to-proxy-policy:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: proxy-check
    name: pod-to-c-multi-node-proxy-to-proxy-policy
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-c-multi-node-proxy-to-proxy-policy
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-c-multi-node-proxy-to-proxy-policy
  template:
    metadata:
      labels:
        name: pod-to-c-multi-node-proxy-to-proxy-policy
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-c
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-c:8080/public
        name: pod-to-c-multi-node-proxy-to-proxy-policy-allow-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-c:8080/public
        terminationMessagePolicy: FallbackToLogsOnError
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - ash
            - -c
            - '! curl -s --fail --connect-timeout 5 -o /dev/null echo-c:8080/private'
          timeoutSeconds: 7
        name: pod-to-c-multi-node-proxy-to-proxy-policy-reject-container
        ports: []
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-c-multi-node-proxy-to-proxy-policy

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-c-multi-node-proxy-to-proxy-policy
policy disallow-default-namespace -> resource default/Deployment/pod-to-c-multi-node-proxy-to-proxy-policy failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-c-multi-node-proxy-to-proxy-policy failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-c-multi-node-proxy-to-proxy-policy failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-c-multi-node-proxy-to-proxy-policy failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-c-multi-node-proxy-to-proxy-policy failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-c-multi-node-proxy-to-proxy-policy failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-c-multi-node-proxy-to-proxy-policy failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_16.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-b-multi-node-clusterip:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: pod-to-b-multi-node-clusterip
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-b-multi-node-clusterip
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-b-multi-node-clusterip
  template:
    metadata:
      labels:
        name: pod-to-b-multi-node-clusterip
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b:8080/public
          timeoutSeconds: 7
        name: pod-to-b-multi-node-clusterip-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-clusterip

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-clusterip
policy disallow-default-namespace -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_17.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-b-multi-node-headless:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: pod-to-b-multi-node-headless
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-b-multi-node-headless
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-b-multi-node-headless
  template:
    metadata:
      labels:
        name: pod-to-b-multi-node-headless
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-headless:8080/public
          timeoutSeconds: 7
        name: pod-to-b-multi-node-headless-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-headless:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-headless

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-headless
policy disallow-default-namespace -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_18.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/host-to-b-multi-node-clusterip:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: host-to-b-multi-node-clusterip
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: host-to-b-multi-node-clusterip
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: host-to-b-multi-node-clusterip
  template:
    metadata:
      labels:
        name: host-to-b-multi-node-clusterip
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b:8080/public
          timeoutSeconds: 7
        name: host-to-b-multi-node-clusterip-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      dnsPolicy: ClusterFirstWithHostNet
      hostNetwork: true

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/host-to-b-multi-node-clusterip

skipped mutate policy add-safe-to-evict -> resource default/Deployment/host-to-b-multi-node-clusterip
policy disallow-default-namespace -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_19.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/host-to-b-multi-node-headless:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: host-to-b-multi-node-headless
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: host-to-b-multi-node-headless
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: host-to-b-multi-node-headless
  template:
    metadata:
      labels:
        name: host-to-b-multi-node-headless
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-headless:8080/public
          timeoutSeconds: 7
        name: host-to-b-multi-node-headless-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-headless:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      dnsPolicy: ClusterFirstWithHostNet
      hostNetwork: true

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/host-to-b-multi-node-headless

skipped mutate policy add-safe-to-evict -> resource default/Deployment/host-to-b-multi-node-headless
policy disallow-default-namespace -> resource default/Deployment/host-to-b-multi-node-headless failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/host-to-b-multi-node-headless failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/host-to-b-multi-node-headless failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/host-to-b-multi-node-headless failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/host-to-b-multi-node-headless failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/host-to-b-multi-node-headless failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/host-to-b-multi-node-headless failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/echo-b-host:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: echo-b-host
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-b-host
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: echo-b-host
  template:
    metadata:
      labels:
        name: echo-b-host
    spec:
      affinity:
        podAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - env:
        - name: PORT
          value: "21000"
        image: quay.io/cilium/json-mock:v1.3.2@sha256:bc6c46c74efadb135bc996c2467cece6989302371ef4e3f068361460abaf39be
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:21000
          timeoutSeconds: 7
        name: echo-b-host-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:21000
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: true

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-b-host

skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-b-host
policy disallow-default-namespace -> resource default/Deployment/echo-b-host failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/echo-b-host failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/echo-b-host failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/echo-b-host failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/echo-b-host failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/echo-b-host failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/echo-b-host failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_20.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-b-multi-node-hostport:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: hostport-check
    name: pod-to-b-multi-node-hostport
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-b-multi-node-hostport
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-b-multi-node-hostport
  template:
    metadata:
      labels:
        name: pod-to-b-multi-node-hostport
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:40000/public
          timeoutSeconds: 7
        name: pod-to-b-multi-node-hostport-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:40000/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-hostport

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-hostport
policy disallow-default-namespace -> resource default/Deployment/pod-to-b-multi-node-hostport failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-b-multi-node-hostport failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-b-multi-node-hostport failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-b-multi-node-hostport failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-b-multi-node-hostport failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-b-multi-node-hostport failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-b-multi-node-hostport failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_21.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-b-intra-node-hostport:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: hostport-check
    name: pod-to-b-intra-node-hostport
    quarantine: "false"
    topology: intra-node
    traffic: internal
    type: autocheck
  name: pod-to-b-intra-node-hostport
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-b-intra-node-hostport
  template:
    metadata:
      labels:
        name: pod-to-b-intra-node-hostport
    spec:
      affinity:
        podAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:40000/public
          timeoutSeconds: 7
        name: pod-to-b-intra-node-hostport-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:40000/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-intra-node-hostport

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-intra-node-hostport
policy disallow-default-namespace -> resource default/Deployment/pod-to-b-intra-node-hostport failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-b-intra-node-hostport failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-b-intra-node-hostport failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-b-intra-node-hostport failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-b-intra-node-hostport failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-b-intra-node-hostport failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-b-intra-node-hostport failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_22.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-b-multi-node-nodeport:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: nodeport-check
    name: pod-to-b-multi-node-nodeport
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-b-multi-node-nodeport
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-b-multi-node-nodeport
  template:
    metadata:
      labels:
        name: pod-to-b-multi-node-nodeport
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:31414/public
          timeoutSeconds: 7
        name: pod-to-b-multi-node-nodeport-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:31414/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-nodeport

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-nodeport
policy disallow-default-namespace -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_23.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-b-intra-node-nodeport:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: nodeport-check
    name: pod-to-b-intra-node-nodeport
    quarantine: "false"
    topology: intra-node
    traffic: internal
    type: autocheck
  name: pod-to-b-intra-node-nodeport
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-b-intra-node-nodeport
  template:
    metadata:
      labels:
        name: pod-to-b-intra-node-nodeport
    spec:
      affinity:
        podAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:31414/public
          timeoutSeconds: 7
        name: pod-to-b-intra-node-nodeport-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:31414/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-intra-node-nodeport

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-intra-node-nodeport
policy disallow-default-namespace -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_24.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-a:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: network-check
    name: echo-a
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-a
  namespace: default
spec:
  ports:
  - name: http
    port: 8080
  selector:
    name: echo-a
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_25.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-b:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: services-check
    name: echo-b
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-b
  namespace: default
spec:
  ports:
  - name: http
    nodePort: 31414
    port: 8080
  selector:
    name: echo-b
  type: NodePort

---


Mutation:
Mutation has been applied successfully.policy restrict-nodeport -> resource default/Service/echo-b failed:
1 - validate-nodeport validation error: Services of type NodePort are not allowed. rule validate-nodeport failed at path /spec/type/


pass: 1, fail: 1, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_26.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-c:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: proxy-check
    name: echo-c
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-c
  namespace: default
spec:
  ports:
  - name: http
    port: 8080
  selector:
    name: echo-c
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_27.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-b-headless:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: services-check
    name: echo-b-headless
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-b-headless
  namespace: default
spec:
  clusterIP: None
  ports:
  - name: http
    port: 8080
  selector:
    name: echo-b
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_28.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-b-host-headless:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: services-check
    name: echo-b-host-headless
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-b-host-headless
  namespace: default
spec:
  clusterIP: None
  ports: []
  selector:
    name: echo-b-host
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_29.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-c-headless:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: proxy-check
    name: echo-c-headless
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-c-headless
  namespace: default
spec:
  clusterIP: None
  ports:
  - name: http
    port: 8080
  selector:
    name: echo-c
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/echo-c:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: proxy-check
    name: echo-c
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-c
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: echo-c
  template:
    metadata:
      labels:
        name: echo-c
    spec:
      containers:
      - env:
        - name: PORT
          value: "8080"
        image: quay.io/cilium/json-mock:v1.3.2@sha256:bc6c46c74efadb135bc996c2467cece6989302371ef4e3f068361460abaf39be
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:8080
          timeoutSeconds: 7
        name: echo-c-container
        ports:
        - containerPort: 8080
          hostPort: 40001
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:8080
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-c

skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-c
policy disallow-default-namespace -> resource default/Deployment/echo-c failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/echo-c failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/echo-c failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/echo-c failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/echo-c failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/echo-c failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/echo-c failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_30.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-c-host-headless:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: proxy-check
    name: echo-c-host-headless
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-c-host-headless
  namespace: default
spec:
  clusterIP: None
  ports: []
  selector:
    name: echo-c-host
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_31.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/CiliumNetworkPolicy/pod-to-a-denied-cnp:
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  labels:
    component: policy-check
    name: pod-to-a-denied-cnp
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: pod-to-a-denied-cnp
  namespace: default
spec:
  egress:
  - toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: kube-dns
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: node-local-dns
    toPorts:
    - ports:
      - port: "53"
        protocol: ANY
  - toEndpoints:
    - matchLabels:
        k8s:dns.operator.openshift.io/daemonset-dns: default
        k8s:io.kubernetes.pod.namespace: openshift-dns
    toPorts:
    - ports:
      - port: "5353"
        protocol: UDP
  endpointSelector:
    matchLabels:
      name: pod-to-a-denied-cnp

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_32.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/CiliumNetworkPolicy/pod-to-a-allowed-cnp:
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  labels:
    component: policy-check
    name: pod-to-a-allowed-cnp
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: pod-to-a-allowed-cnp
  namespace: default
spec:
  egress:
  - toEndpoints:
    - matchLabels:
        name: echo-a
    toPorts:
    - ports:
      - port: "8080"
        protocol: TCP
  - toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: kube-dns
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: node-local-dns
    toPorts:
    - ports:
      - port: "53"
        protocol: ANY
  - toEndpoints:
    - matchLabels:
        k8s:dns.operator.openshift.io/daemonset-dns: default
        k8s:io.kubernetes.pod.namespace: openshift-dns
    toPorts:
    - ports:
      - port: "5353"
        protocol: UDP
  endpointSelector:
    matchLabels:
      name: pod-to-a-allowed-cnp

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_33.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/CiliumNetworkPolicy/pod-to-external-fqdn-allow-google-cnp:
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  labels:
    component: policy-check
    name: pod-to-external-fqdn-allow-google-cnp
    quarantine: "false"
    topology: any
    traffic: external
    type: autocheck
  name: pod-to-external-fqdn-allow-google-cnp
  namespace: default
spec:
  egress:
  - toFQDNs:
    - matchPattern: '*.google.com'
  - toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: kube-dns
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: node-local-dns
    toPorts:
    - ports:
      - port: "53"
        protocol: ANY
      rules:
        dns:
        - matchPattern: '*'
  - toEndpoints:
    - matchLabels:
        k8s:dns.operator.openshift.io/daemonset-dns: default
        k8s:io.kubernetes.pod.namespace: openshift-dns
    toPorts:
    - ports:
      - port: "5353"
        protocol: UDP
      rules:
        dns:
        - matchPattern: '*'
  endpointSelector:
    matchLabels:
      name: pod-to-external-fqdn-allow-google-cnp

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_34.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/CiliumNetworkPolicy/pod-to-a-intra-node-proxy-egress-policy:
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  labels:
    component: proxy-check
    name: pod-to-a-intra-node-proxy-egress-policy
    quarantine: "false"
    topology: intra-node
    traffic: internal
    type: autocheck
  name: pod-to-a-intra-node-proxy-egress-policy
  namespace: default
spec:
  egress:
  - toEndpoints:
    - matchLabels:
        name: echo-a
    toPorts:
    - ports:
      - port: "8080"
        protocol: TCP
      rules:
        http:
        - method: GET
          path: /public$
  - toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: kube-dns
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: node-local-dns
    toPorts:
    - ports:
      - port: "53"
        protocol: ANY
  - toEndpoints:
    - matchLabels:
        k8s:dns.operator.openshift.io/daemonset-dns: default
        k8s:io.kubernetes.pod.namespace: openshift-dns
    toPorts:
    - ports:
      - port: "5353"
        protocol: UDP
  endpointSelector:
    matchLabels:
      name: pod-to-a-intra-node-proxy-egress-policy

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_35.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/CiliumNetworkPolicy/pod-to-a-multi-node-proxy-egress-policy:
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  labels:
    component: proxy-check
    name: pod-to-a-multi-node-proxy-egress-policy
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-a-multi-node-proxy-egress-policy
  namespace: default
spec:
  egress:
  - toEndpoints:
    - matchLabels:
        name: echo-a
    toPorts:
    - ports:
      - port: "8080"
        protocol: TCP
      rules:
        http:
        - method: GET
          path: /public$
  - toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: kube-dns
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: node-local-dns
    toPorts:
    - ports:
      - port: "53"
        protocol: ANY
  - toEndpoints:
    - matchLabels:
        k8s:dns.operator.openshift.io/daemonset-dns: default
        k8s:io.kubernetes.pod.namespace: openshift-dns
    toPorts:
    - ports:
      - port: "5353"
        protocol: UDP
  endpointSelector:
    matchLabels:
      name: pod-to-a-multi-node-proxy-egress-policy

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_36.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/CiliumNetworkPolicy/pod-to-c-intra-node-proxy-to-proxy-policy:
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  labels:
    component: proxy-check
    name: pod-to-c-intra-node-proxy-to-proxy-policy
    quarantine: "false"
    topology: intra-node
    traffic: internal
    type: autocheck
  name: pod-to-c-intra-node-proxy-to-proxy-policy
  namespace: default
spec:
  egress:
  - toEndpoints:
    - matchLabels:
        name: echo-c
    toPorts:
    - ports:
      - port: "8080"
        protocol: TCP
      rules:
        http:
        - method: GET
          path: /public$
  - toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: kube-dns
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: node-local-dns
    toPorts:
    - ports:
      - port: "53"
        protocol: ANY
  - toEndpoints:
    - matchLabels:
        k8s:dns.operator.openshift.io/daemonset-dns: default
        k8s:io.kubernetes.pod.namespace: openshift-dns
    toPorts:
    - ports:
      - port: "5353"
        protocol: UDP
  endpointSelector:
    matchLabels:
      name: pod-to-c-intra-node-proxy-to-proxy-policy

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_37.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/CiliumNetworkPolicy/pod-to-c-multi-node-proxy-to-proxy-policy:
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  labels:
    component: proxy-check
    name: pod-to-c-multi-node-proxy-to-proxy-policy
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-c-multi-node-proxy-to-proxy-policy
  namespace: default
spec:
  egress:
  - toEndpoints:
    - matchLabels:
        name: echo-c
    toPorts:
    - ports:
      - port: "8080"
        protocol: TCP
      rules:
        http:
        - method: GET
          path: /public$
  - toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: kube-dns
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: node-local-dns
    toPorts:
    - ports:
      - port: "53"
        protocol: ANY
  - toEndpoints:
    - matchLabels:
        k8s:dns.operator.openshift.io/daemonset-dns: default
        k8s:io.kubernetes.pod.namespace: openshift-dns
    toPorts:
    - ports:
      - port: "5353"
        protocol: UDP
  endpointSelector:
    matchLabels:
      name: pod-to-c-multi-node-proxy-to-proxy-policy

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_38.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/CiliumNetworkPolicy/echo-c:
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  labels:
    component: proxy-check
    name: echo-c
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-c
  namespace: default
spec:
  endpointSelector:
    matchLabels:
      name: echo-c
  ingress:
  - toPorts:
    - ports:
      - port: "8080"
        protocol: TCP
      rules:
        http:
        - method: GET
          path: /public$

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-hostport_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/echo-c-host:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: proxy-check
    name: echo-c-host
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-c-host
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: echo-c-host
  template:
    metadata:
      labels:
        name: echo-c-host
    spec:
      affinity:
        podAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-c
            topologyKey: kubernetes.io/hostname
      containers:
      - env:
        - name: PORT
          value: "21002"
        image: quay.io/cilium/json-mock:v1.3.2@sha256:bc6c46c74efadb135bc996c2467cece6989302371ef4e3f068361460abaf39be
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:21002
          timeoutSeconds: 7
        name: echo-c-host-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:21002
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: true

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-c-host

skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-c-host
policy disallow-default-namespace -> resource default/Deployment/echo-c-host failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/echo-c-host failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/echo-c-host failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/echo-c-host failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/echo-c-host failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/echo-c-host failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/echo-c-host failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-a:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: network-check
    name: pod-to-a
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: pod-to-a
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-a
  template:
    metadata:
      labels:
        name: pod-to-a
    spec:
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
          timeoutSeconds: 7
        name: pod-to-a-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a
policy disallow-default-namespace -> resource default/Deployment/pod-to-a failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-a failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-a failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-a failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-a failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-a failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-a failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_6.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-external-1111:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: network-check
    name: pod-to-external-1111
    quarantine: "false"
    topology: any
    traffic: external
    type: autocheck
  name: pod-to-external-1111
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-external-1111
  template:
    metadata:
      labels:
        name: pod-to-external-1111
    spec:
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - https://1.1.1.1
          timeoutSeconds: 7
        name: pod-to-external-1111-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - https://1.1.1.1
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-external-1111

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-external-1111
policy disallow-default-namespace -> resource default/Deployment/pod-to-external-1111 failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-external-1111 failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-external-1111 failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-external-1111 failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-external-1111 failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-external-1111 failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-external-1111 failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_7.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-a-denied-cnp:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: policy-check
    name: pod-to-a-denied-cnp
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: pod-to-a-denied-cnp
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-a-denied-cnp
  template:
    metadata:
      labels:
        name: pod-to-a-denied-cnp
    spec:
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - ash
            - -c
            - '! curl -s --fail --connect-timeout 5 -o /dev/null echo-a:8080/private'
          timeoutSeconds: 7
        name: pod-to-a-denied-cnp-container
        ports: []
        readinessProbe:
          exec:
            command:
            - ash
            - -c
            - '! curl -s --fail --connect-timeout 5 -o /dev/null echo-a:8080/private'
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-denied-cnp

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-denied-cnp
policy disallow-default-namespace -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_8.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-a-allowed-cnp:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: policy-check
    name: pod-to-a-allowed-cnp
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: pod-to-a-allowed-cnp
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-a-allowed-cnp
  template:
    metadata:
      labels:
        name: pod-to-a-allowed-cnp
    spec:
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
          timeoutSeconds: 7
        name: pod-to-a-allowed-cnp-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-allowed-cnp

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-allowed-cnp
policy disallow-default-namespace -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-hostport_9.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-external-fqdn-allow-google-cnp:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: policy-check
    name: pod-to-external-fqdn-allow-google-cnp
    quarantine: "false"
    topology: any
    traffic: external
    type: autocheck
  name: pod-to-external-fqdn-allow-google-cnp
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-external-fqdn-allow-google-cnp
  template:
    metadata:
      labels:
        name: pod-to-external-fqdn-allow-google-cnp
    spec:
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - www.google.com
          timeoutSeconds: 7
        name: pod-to-external-fqdn-allow-google-cnp-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - www.google.com
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-external-fqdn-allow-google-cnp

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-external-fqdn-allow-google-cnp
policy disallow-default-namespace -> resource default/Deployment/pod-to-external-fqdn-allow-google-cnp failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-external-fqdn-allow-google-cnp failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-external-fqdn-allow-google-cnp failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-external-fqdn-allow-google-cnp failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-external-fqdn-allow-google-cnp failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-external-fqdn-allow-google-cnp failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-external-fqdn-allow-google-cnp failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/echo-a:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: network-check
    name: echo-a
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-a
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: echo-a
  template:
    metadata:
      labels:
        name: echo-a
    spec:
      containers:
      - env:
        - name: PORT
          value: "8080"
        image: quay.io/cilium/json-mock:v1.3.2@sha256:bc6c46c74efadb135bc996c2467cece6989302371ef4e3f068361460abaf39be
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:8080
          timeoutSeconds: 7
        name: echo-a-container
        ports:
        - containerPort: 8080
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:8080
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-a

skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-a
policy disallow-default-namespace -> resource default/Deployment/echo-a failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/echo-a failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/echo-a failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/echo-a failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/echo-a failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/echo-a failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/echo-a failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/echo-b:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: echo-b
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-b
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: echo-b
  template:
    metadata:
      labels:
        name: echo-b
    spec:
      containers:
      - env:
        - name: PORT
          value: "8080"
        image: quay.io/cilium/json-mock:v1.3.2@sha256:bc6c46c74efadb135bc996c2467cece6989302371ef4e3f068361460abaf39be
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:8080
          timeoutSeconds: 7
        name: echo-b-container
        ports:
        - containerPort: 8080
          hostPort: 40000
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:8080
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-b

skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-b
policy disallow-default-namespace -> resource default/Deployment/echo-b failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/echo-b failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/echo-b failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/echo-b failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/echo-b failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/echo-b failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/echo-b failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal_10.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-b-multi-node-nodeport:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: nodeport-check
    name: pod-to-b-multi-node-nodeport
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-b-multi-node-nodeport
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-b-multi-node-nodeport
  template:
    metadata:
      labels:
        name: pod-to-b-multi-node-nodeport
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:31414/public
          timeoutSeconds: 7
        name: pod-to-b-multi-node-nodeport-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:31414/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-nodeport

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-nodeport
policy disallow-default-namespace -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-b-multi-node-nodeport failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal_11.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-b-intra-node-nodeport:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: nodeport-check
    name: pod-to-b-intra-node-nodeport
    quarantine: "false"
    topology: intra-node
    traffic: internal
    type: autocheck
  name: pod-to-b-intra-node-nodeport
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-b-intra-node-nodeport
  template:
    metadata:
      labels:
        name: pod-to-b-intra-node-nodeport
    spec:
      affinity:
        podAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:31414/public
          timeoutSeconds: 7
        name: pod-to-b-intra-node-nodeport-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-host-headless:31414/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-intra-node-nodeport

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-intra-node-nodeport
policy disallow-default-namespace -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-b-intra-node-nodeport failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal_12.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-a:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: network-check
    name: echo-a
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-a
  namespace: default
spec:
  ports:
  - name: http
    port: 8080
  selector:
    name: echo-a
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-internal_13.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-b:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: services-check
    name: echo-b
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-b
  namespace: default
spec:
  ports:
  - name: http
    nodePort: 31414
    port: 8080
  selector:
    name: echo-b
  type: NodePort

---


Mutation:
Mutation has been applied successfully.policy restrict-nodeport -> resource default/Service/echo-b failed:
1 - validate-nodeport validation error: Services of type NodePort are not allowed. rule validate-nodeport failed at path /spec/type/


pass: 1, fail: 1, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-internal_14.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-b-headless:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: services-check
    name: echo-b-headless
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-b-headless
  namespace: default
spec:
  clusterIP: None
  ports:
  - name: http
    port: 8080
  selector:
    name: echo-b
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-internal_15.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/echo-b-host-headless:
apiVersion: v1
kind: Service
metadata:
  labels:
    component: services-check
    name: echo-b-host-headless
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-b-host-headless
  namespace: default
spec:
  clusterIP: None
  ports: []
  selector:
    name: echo-b-host
  type: ClusterIP

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-internal_16.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/CiliumNetworkPolicy/pod-to-a-denied-cnp:
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  labels:
    component: policy-check
    name: pod-to-a-denied-cnp
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: pod-to-a-denied-cnp
  namespace: default
spec:
  egress:
  - toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: kube-dns
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: node-local-dns
    toPorts:
    - ports:
      - port: "53"
        protocol: ANY
  - toEndpoints:
    - matchLabels:
        k8s:dns.operator.openshift.io/daemonset-dns: default
        k8s:io.kubernetes.pod.namespace: openshift-dns
    toPorts:
    - ports:
      - port: "5353"
        protocol: UDP
  endpointSelector:
    matchLabels:
      name: pod-to-a-denied-cnp

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-internal_17.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/CiliumNetworkPolicy/pod-to-a-allowed-cnp:
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  labels:
    component: policy-check
    name: pod-to-a-allowed-cnp
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: pod-to-a-allowed-cnp
  namespace: default
spec:
  egress:
  - toEndpoints:
    - matchLabels:
        name: echo-a
    toPorts:
    - ports:
      - port: "8080"
        protocol: TCP
  - toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: kube-dns
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: node-local-dns
    toPorts:
    - ports:
      - port: "53"
        protocol: ANY
  - toEndpoints:
    - matchLabels:
        k8s:dns.operator.openshift.io/daemonset-dns: default
        k8s:io.kubernetes.pod.namespace: openshift-dns
    toPorts:
    - ports:
      - port: "5353"
        protocol: UDP
  endpointSelector:
    matchLabels:
      name: pod-to-a-allowed-cnp

---


Mutation:
Mutation has been applied successfully.
pass: 0, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connectivity-check-internal_2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/echo-b-host:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: echo-b-host
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: echo-b-host
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: echo-b-host
  template:
    metadata:
      labels:
        name: echo-b-host
    spec:
      affinity:
        podAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - env:
        - name: PORT
          value: "21000"
        image: quay.io/cilium/json-mock:v1.3.2@sha256:bc6c46c74efadb135bc996c2467cece6989302371ef4e3f068361460abaf39be
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:21000
          timeoutSeconds: 7
        name: echo-b-host-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - localhost:21000
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: true

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-b-host

skipped mutate policy add-safe-to-evict -> resource default/Deployment/echo-b-host
policy disallow-default-namespace -> resource default/Deployment/echo-b-host failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/echo-b-host failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/echo-b-host failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/echo-b-host failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/echo-b-host failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/echo-b-host failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/echo-b-host failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal_3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-a:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: network-check
    name: pod-to-a
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: pod-to-a
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-a
  template:
    metadata:
      labels:
        name: pod-to-a
    spec:
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
          timeoutSeconds: 7
        name: pod-to-a-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a
policy disallow-default-namespace -> resource default/Deployment/pod-to-a failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-a failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-a failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-a failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-a failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-a failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-a failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal_4.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-a-denied-cnp:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: policy-check
    name: pod-to-a-denied-cnp
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: pod-to-a-denied-cnp
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-a-denied-cnp
  template:
    metadata:
      labels:
        name: pod-to-a-denied-cnp
    spec:
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - ash
            - -c
            - '! curl -s --fail --connect-timeout 5 -o /dev/null echo-a:8080/private'
          timeoutSeconds: 7
        name: pod-to-a-denied-cnp-container
        ports: []
        readinessProbe:
          exec:
            command:
            - ash
            - -c
            - '! curl -s --fail --connect-timeout 5 -o /dev/null echo-a:8080/private'
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-denied-cnp

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-denied-cnp
policy disallow-default-namespace -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-a-denied-cnp failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal_5.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-a-allowed-cnp:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: policy-check
    name: pod-to-a-allowed-cnp
    quarantine: "false"
    topology: any
    traffic: internal
    type: autocheck
  name: pod-to-a-allowed-cnp
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-a-allowed-cnp
  template:
    metadata:
      labels:
        name: pod-to-a-allowed-cnp
    spec:
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
          timeoutSeconds: 7
        name: pod-to-a-allowed-cnp-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-a:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-allowed-cnp

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-a-allowed-cnp
policy disallow-default-namespace -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-a-allowed-cnp failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal_6.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-b-multi-node-clusterip:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: pod-to-b-multi-node-clusterip
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-b-multi-node-clusterip
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-b-multi-node-clusterip
  template:
    metadata:
      labels:
        name: pod-to-b-multi-node-clusterip
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b:8080/public
          timeoutSeconds: 7
        name: pod-to-b-multi-node-clusterip-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-clusterip

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-clusterip
policy disallow-default-namespace -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-b-multi-node-clusterip failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal_7.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/pod-to-b-multi-node-headless:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: pod-to-b-multi-node-headless
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: pod-to-b-multi-node-headless
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: pod-to-b-multi-node-headless
  template:
    metadata:
      labels:
        name: pod-to-b-multi-node-headless
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-headless:8080/public
          timeoutSeconds: 7
        name: pod-to-b-multi-node-headless-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b-headless:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      hostNetwork: false

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-headless

skipped mutate policy add-safe-to-evict -> resource default/Deployment/pod-to-b-multi-node-headless
policy disallow-default-namespace -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/pod-to-b-multi-node-headless failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connectivity-check-internal_8.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Deployment/host-to-b-multi-node-clusterip:
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: services-check
    name: host-to-b-multi-node-clusterip
    quarantine: "false"
    topology: multi-node
    traffic: internal
    type: autocheck
  name: host-to-b-multi-node-clusterip
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      name: host-to-b-multi-node-clusterip
  template:
    metadata:
      labels:
        name: host-to-b-multi-node-clusterip
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: name
                operator: In
                values:
                - echo-b
            topologyKey: kubernetes.io/hostname
      containers:
      - command:
        - /bin/ash
        - -c
        - sleep 1000000000
        image: quay.io/cilium/alpine-curl:v1.5.0@sha256:7b286939730d8af1149ef88dba15739d8330bb83d7d9853a23e5ab4043e2d33c
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b:8080/public
          timeoutSeconds: 7
        name: host-to-b-multi-node-clusterip-container
        ports: []
        readinessProbe:
          exec:
            command:
            - curl
            - -sS
            - --fail
            - --connect-timeout
            - "5"
            - -o
            - /dev/null
            - echo-b:8080/public
          timeoutSeconds: 7
        terminationMessagePolicy: FallbackToLogsOnError
      dnsPolicy: ClusterFirstWithHostNet
      hostNetwork: true

---


Mutation:
Mutation has been applied successfully.
skipped mutate policy add-safe-to-evict -> resource default/Deployment/host-to-b-multi-node-clusterip

skipped mutate policy add-safe-to-evict -> resource default/Deployment/host-to-b-multi-node-clusterip
policy disallow-default-namespace -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - validate-podcontroller-namespace validation error: Using 'default' namespace is not allowed for pod controllers. rule validate-podcontroller-namespace failed at path /metadata/namespace/

policy drop-all-capabilities -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-require-drop-all validation failure: Containers must drop `ALL` capabilities.

policy drop-cap-net-raw -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-require-drop-cap-net-raw validation failure: Containers must drop the `CAP_NET_RAW` capability.

policy require-labels -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-check-for-labels validation error: The label `app.kubernetes.io/name` is required. rule autogen-check-for-labels failed at path /spec/template/metadata/labels/app.kubernetes.io/name/

policy require-requests-limits -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-validate-resources validation error: CPU and memory resource requests and memory limits are required for containers. rule autogen-validate-resources failed at path /spec/template/spec/containers/0/resources/

policy require-ro-rootfs -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-validate-readOnlyRootFilesystem validation error: Root filesystem must be read-only. rule autogen-validate-readOnlyRootFilesystem failed at path /spec/template/spec/containers/0/securityContext/

policy restrict-image-registries -> resource default/Deployment/host-to-b-multi-node-clusterip failed:
1 - autogen-validate-registries validation error: Unknown image registry. rule autogen-validate-registries failed at path /spec/template/spec/containers/0/image/


pass: 8, fail: 7, warn: 0, error: 0, skip: 2 

##### FILE: connect-server-service.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to sparglim/Service/sparglim-server-service:
apiVersion: v1
kind: Service
metadata:
  name: sparglim-server-service
  namespace: sparglim
spec:
  ports:
  - name: connect-server
    nodePort: 30052
    port: 15002
    protocol: TCP
    targetPort: 15002
  - name: spark-ui
    nodePort: 30040
    port: 4040
    protocol: TCP
    targetPort: 4040
  selector:
    app: sparglim-server
  type: NodePort

---


Mutation:
Mutation has been applied successfully.policy restrict-nodeport -> resource sparglim/Service/sparglim-server-service failed:
1 - validate-nodeport validation error: Services of type NodePort are not allowed. rule validate-nodeport failed at path /spec/type/


pass: 1, fail: 1, warn: 0, error: 0, skip: 0 

##### FILE: connect-server-service1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to sparglim/Service/sparglim-server-service:
apiVersion: v1
kind: Service
metadata:
  name: sparglim-server-service
  namespace: sparglim
spec:
  ports:
  - name: connect-server
    nodePort: 30052
    port: 15002
    protocol: TCP
    targetPort: 15002
  - name: spark-ui
    nodePort: 30040
    port: 4040
    protocol: TCP
    targetPort: 4040
  selector:
    app: sparglim-server
  type: NodePort

---


Mutation:
Mutation has been applied successfully.policy restrict-nodeport -> resource sparglim/Service/sparglim-server-service failed:
1 - validate-nodeport validation error: Services of type NodePort are not allowed. rule validate-nodeport failed at path /spec/type/


pass: 1, fail: 1, warn: 0, error: 0, skip: 0 

##### FILE: connect-server-service2.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to sparglim/Service/sparglim-server-service:
apiVersion: v1
kind: Service
metadata:
  name: sparglim-server-service
  namespace: sparglim
spec:
  ports:
  - name: connect-server
    nodePort: 30052
    port: 15002
    protocol: TCP
    targetPort: 15002
  - name: spark-ui
    nodePort: 30040
    port: 4040
    protocol: TCP
    targetPort: 4040
  selector:
    app: sparglim-server
  type: NodePort

---


Mutation:
Mutation has been applied successfully.policy restrict-nodeport -> resource sparglim/Service/sparglim-server-service failed:
1 - validate-nodeport validation error: Services of type NodePort are not allowed. rule validate-nodeport failed at path /spec/type/


pass: 1, fail: 1, warn: 0, error: 0, skip: 0 

##### FILE: connect-server-service3.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to sparglim/Service/sparglim-server-service:
apiVersion: v1
kind: Service
metadata:
  name: sparglim-server-service
  namespace: sparglim
spec:
  ports:
  - name: connect-server
    nodePort: 30052
    port: 15002
    protocol: TCP
    targetPort: 15002
  - name: spark-ui
    nodePort: 30040
    port: 4040
    protocol: TCP
    targetPort: 4040
  selector:
    app: sparglim-server
  type: NodePort

---


Mutation:
Mutation has been applied successfully.policy restrict-nodeport -> resource sparglim/Service/sparglim-server-service failed:
1 - validate-nodeport validation error: Services of type NodePort are not allowed. rule validate-nodeport failed at path /spec/type/


pass: 1, fail: 1, warn: 0, error: 0, skip: 0 

##### FILE: connect-services.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/wordpress-connect-blog:
apiVersion: v1
kind: Service
metadata:
  annotations:
    jackal.dev/connect-description: The public facing WordPress blog site
  labels:
    jackal.dev/connect-name: wordpress-blog
  name: wordpress-connect-blog
  namespace: default
spec:
  ports:
  - name: http
    port: 8080
    protocol: TCP
    targetPort: 8080
  selector:
    app.kubernetes.io/instance: wordpress
    app.kubernetes.io/name: wordpress

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connect-services_1.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/wordpress-connect-admin:
apiVersion: v1
kind: Service
metadata:
  annotations:
    jackal.dev/connect-description: The login page for the WordPress admin panel
    jackal.dev/connect-url: /wp-admin
  labels:
    jackal.dev/connect-name: wordpress-admin
  name: wordpress-connect-admin
  namespace: default
spec:
  ports:
  - name: http
    port: 8080
    protocol: TCP
    targetPort: 8080
  selector:
    app.kubernetes.io/instance: wordpress
    app.kubernetes.io/name: wordpress

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

##### FILE: connect-svc.yaml #####

Applying 61 policy rule(s) to 1 resource(s)...

policy add-safe-to-evict applied to default/Service/connect:
apiVersion: v1
kind: Service
metadata:
  name: connect
  namespace: default
spec:
  ports:
  - port: 8083
    protocol: TCP
    targetPort: 8083
  selector:
    app: connect

---


Mutation:
Mutation has been applied successfully.
pass: 2, fail: 0, warn: 0, error: 0, skip: 0 

